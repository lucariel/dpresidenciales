---
title: "Resultados Diputado Nacional"
output: html_notebook
---



### 2007 

#### CABA



```{sql cabagral2007, connection=Arg07,  output.var="cabagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0005",	
"0009",	
"0014",	
"0020",	 	
"0023",			
"0036",			
"0037",			
"0038",			
"0050",
"0051",		
"0060",	
"0131",	
"0134",	
"0135",	 	
"0136",			
"0137",			
"0138",			
"0139",			
"0140",
"0141",		
"0142",	
"0143",	
"0144",	
"0145",	 	
"0146",			
"0147",			
"0188",			
"0252",			
"0332")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0009"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0139"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0140"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0141"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0142"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0143"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0144"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0145"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0146"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0147"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0252"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0332"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '01'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0005") AS "0005", 
              sum("0009") AS "0009", 
              sum("0014") AS "0014",
              sum("0020") AS "0020", 
              sum("0023") AS "0023",
              sum("0036") AS "0036", 
              sum("0037") AS "0037", 
              sum("0038") AS "0038", 
              sum("0050") AS "0050",
              sum("0051") AS "0051", 
              sum("0060") AS "0060", 
              sum("0131") AS "0131", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0136") AS "0136",
              sum("0137") AS "0137", 
              sum("0138") AS "0138", 
              sum("0139") AS "0139", 
              sum("0140") AS "0140",
              sum("0141") AS "0141", 
              sum("0142") AS "0142", 
              sum("0143") AS "0143", 
              sum("0144") AS "0144",
              sum("0145") AS "0145", 
              sum("0146") AS "0146",
              sum("0147") AS "0147", 
              sum("0188") AS "0188", 
              sum("0252") AS "0252", 
              sum("0332") AS "0332"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cabagral2007, "../1.CABA/caba_dip_gral2007.csv")

```


#### PBA



```{sql pbagral2007, connection=Arg07,  output.var="pbagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0030",	
"0038",	
"0048",		
"0051",	
"0060",	
"0132",	
"0133",	 	
"0134",			
"0135",			
"0141",			
"0144",			
"0250",
"0260",		
"0269",	
"0273",	
"0275",	
"0311",	 	
"0312",			
"0313",			
"0314",			
"0315",			
"0316",
"0317")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0141"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0144"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0250"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0260"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0269"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0273"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0275"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0311"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0312"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0313"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0314"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0315"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0316"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0317"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0030") AS "0030", 
              sum("0038") AS "0038",
              sum("0048") AS "0048", 
              sum("0051") AS "0051",
              sum("0060") AS "0060", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0141") AS "0141", 
              sum("0144") AS "0144", 
              sum("0250") AS "0250",
              sum("0260") AS "0260", 
              sum("0269") AS "0269",
              sum("0273") AS "0273", 
              sum("0275") AS "0275", 
              sum("0311") AS "0311", 
              sum("0312") AS "0312",
              sum("0313") AS "0313", 
              sum("0314") AS "0314", 
              sum("0315") AS "0315", 
              sum("0316") AS "0316",
              sum("0317") AS "0317"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pbagral2007, "../2.PBA/sfe_dip_gral2007.csv")

```


#### CATAMARCA



```{sql catamarcagral2007, connection=Arg07,  output.var="catamarcagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0036",	
"0038",	
"0047",	
"0148",		
"0149",	
"0150",	
"0187",	
"0188",	 	
"0330",			
"0332")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0148"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0149"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0150"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0330"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0332"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0036") AS "0036", 
              sum("0038") AS "0038", 
              sum("0047") AS "0047",
              sum("0148") AS "0148", 
              sum("0149") AS "0149",
              sum("0150") AS "0150", 
              sum("0187") AS "0187", 
              sum("0188") AS "0188", 
              sum("0330") AS "0330",
              sum("0332") AS "0332"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarcagral2007, "../3.CATAMARCA/catamarca_dip_gral2007.csv")

```



#### CORDOBA



```{sql cordobagral2007, connection=Arg07,  output.var="cordobagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0003",	
"0014",	
"0020",	
"0038",		
"0041",	
"0043",	
"0047",	
"0056",	
"0057",	 	
"0132",			
"0134",			
"0135",			
"0151",			
"0152",
"0153",		
"0154",	
"0155",	
"0157",	
"0158",	 	
"0159",			
"0160",			
"0161")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0041"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0043"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0057"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0151"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0152"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0155"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0157"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0158"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0159"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0160"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0161"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0020") AS "0020",
              sum("0038") AS "0038", 
              sum("0041") AS "0041",
              sum("0043") AS "0043", 
              sum("0047") AS "0047", 
              sum("0056") AS "0056", 
              sum("0057") AS "0057",
              sum("0132") AS "0132", 
              sum("0134") AS "0134", 
              sum("0135") AS "0135", 
              sum("0151") AS "0151",
              sum("0152") AS "0152", 
              sum("0153") AS "0153",
              sum("0154") AS "0154", 
              sum("0155") AS "0155", 
              sum("0157") AS "0157", 
              sum("0158") AS "0158",
              sum("0159") AS "0159", 
              sum("0160") AS "0160", 
              sum("0161") AS "0161"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordobagral2007, "../4.CORDOBA/cordoba_dip_gral2007.csv")

```



#### CORRIENTES


```{sql corrientesgral2007, connection=Arg07,  output.var="corrientesgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0002",	
"0003",	
"0005",	
"0008",		
"0009",	
"0012",	
"0019",	
"0020",	 	
"0023",			
"0033",			
"0036",			
"0044",			
"0047",			
"0048",
"0050",		
"0055",	
"0056",	
"0059",	
"0134",	 	
"0163",			
"0182",			
"0284",			
"0285",			
"0286",
"0287",			
"0288")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0009"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0019"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0055"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0059"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0163"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0182"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0284"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0285"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0286"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0287"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0288"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0005") AS "0005",
              sum("0008") AS "0008", 
              sum("0009") AS "0009",
              sum("0012") AS "0012", 
              sum("0019") AS "0019", 
              sum("0020") AS "0020", 
              sum("0023") AS "0023",
              sum("0033") AS "0033", 
              sum("0036") AS "0036", 
              sum("0044") AS "0044", 
              sum("0047") AS "0047",
              sum("0048") AS "0048", 
              sum("0050") AS "0050",
              sum("0055") AS "0055", 
              sum("0056") AS "0056", 
              sum("0059") AS "0059", 
              sum("0134") AS "0134",
              sum("0163") AS "0163", 
              sum("0182") AS "0182", 
              sum("0284") AS "0284", 
              sum("0285") AS "0285",
              sum("0286") AS "0286", 
              sum("0287") AS "0287",
              sum("0288") AS "0288"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(corrientesgral2007, "../5.CORRIENTES/corrientes_dip_gral2007.csv")

```
#### CHACO


```{sql chacogral2007, connection=Arg07,  output.var="chacogral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0047",	
"0060",	
"0163",	
"0168",		
"0169",	
"0170",	
"0171")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0163"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0168"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0169"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0170"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0171"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0047") AS "0047", 
              sum("0060") AS "0060", 
              sum("0163") AS "0163",
              sum("0168") AS "0168", 
              sum("0169") AS "0169",
              sum("0170") AS "0170", 
              sum("0171") AS "0171"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chacogral2007, "../6.CHACO/chaco_dip_gral2007.csv")

```
#### CHUBUT


```{sql chubutgral2007, connection=Arg07,  output.var="chubutgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0022",	
"0038",	
"0047",		
"0173",	
"0174",	
"0251")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0173"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0251"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0022") AS "0022", 
              sum("0038") AS "0038",
              sum("0047") AS "0047", 
              sum("0173") AS "0173",
              sum("0174") AS "0174", 
              sum("0251") AS "0251"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubutgral2007, "../7.CHUBUT/chubut_dip_gral2007.csv")

```
#### ENTRE RIOS


```{sql eriosgral2007, connection=Arg07,  output.var="eriosgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0038",	
"0044",	
"0048",	
"0051",		
"0059",	
"0131",	
"0132",	
"0133",	
"0134",	 	
"0154",			
"0309")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0059"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0309"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0038") AS "0038", 
              sum("0044") AS "0044", 
              sum("0048") AS "0048",
              sum("0051") AS "0051", 
              sum("0059") AS "0059",
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133", 
              sum("0134") AS "0134",
              sum("0154") AS "0154", 
              sum("0309") AS "0309"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(eriosgral2007, "../8.ENTRE_RIOS/erios_dip_gral2007.csv")

```
#### FORMOSA


```{sql formosagral2007, connection=Arg07,  output.var="formosagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0022",		
"0047",	
"0051",	
"0289",	
"0290",		
"0291",	
"0292",	
"0293",	
"0294")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0289"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0290"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0291"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0292"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0293"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0294"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '09'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0022") AS "0022", 
              sum("0047") AS "0047", 
              sum("0051") AS "0051", 
              sum("0289") AS "0289",
              sum("0290") AS "0290", 
              sum("0291") AS "0291",
              sum("0292") AS "0292", 
              sum("0293") AS "0293", 
              sum("0294") AS "0294"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosagral2007, "../9.FORMOSA/formosa_dip_gral2007.csv")

```
#### JUJUY


```{sql jujuygral2007, connection=Arg07,  output.var="jujuygral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0014",	
"0038",	
"0045",	
"0187",		
"0188",	
"0243",	
"0325",	
"0326",	 	
"0327",			
"0328",			
"0329")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0243"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0325"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0326"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0327"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0328"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0329"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0045") AS "0045",
              sum("0187") AS "0187", 
              sum("0188") AS "0188",
              sum("0243") AS "0243", 
              sum("0325") AS "0325", 
              sum("0326") AS "0326", 
              sum("0327") AS "0327",
              sum("0328") AS "0328", 
              sum("0329") AS "0329"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuygral2007, "../10.JUJUY/jujuy_dip_gral2007.csv")

```
#### LA PAMPA


```{sql pampagral2007, connection=Arg07,  output.var="pampagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0022",	
"0030",	
"0048",	
"0197",		
"0198",	
"0199",	
"0200",	
"0201",	 	
"0252")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0197"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0198"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0199"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0200"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0201"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0252"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0022") AS "0022", 
              sum("0030") AS "0030", 
              sum("0048") AS "0048",
              sum("0197") AS "0197", 
              sum("0198") AS "0198",
              sum("0199") AS "0199", 
              sum("0200") AS "0200", 
              sum("0201") AS "0201", 
              sum("0252") AS "0252"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampagral2007, "../11.LA_PAMPA/pampa_dip_gral2007.csv")

```
#### LA RIOJA


```{sql riojagral2007, connection=Arg07,  output.var="riojagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0149",	
"0214",	
"0215",	
"0216",		
"0300")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0149"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0214"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0215"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0216"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0300"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '12'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0149") AS "0149", 
              sum("0214") AS "0214", 
              sum("0215") AS "0215",
              sum("0216") AS "0216", 
              sum("0300") AS "0300"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(riojagral2007, "../12.LA_RIOJA/rioja_dip_gral2007.csv")

```
#### MENDOZA


```{sql mendozagral2007, connection=Arg07,  output.var="mendozagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0005",	
"0006",
"0008",	
"0014",		
"0023",	
"0038",	
"0045",	
"0048",	 	
"0052",			
"0056",			
"0132",			
"0253",			
"0256",
"0257",		
"0259",	
"0260",	
"0261",	
"0262",	 	
"0263",			
"0264",			
"0265",			
"0266",			
"0267",
"0268")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0052"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0253"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0256"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0257"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0259"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0260"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0261"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0262"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0263"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0264"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0265"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0266"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0267"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0268"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0005") AS "0005", 
              sum("0006") AS "0006",
              sum("0008") AS "0008", 
              sum("0014") AS "0014",
              sum("0023") AS "0023", 
              sum("0038") AS "0038", 
              sum("0045") AS "0045", 
              sum("0048") AS "0048",
              sum("0052") AS "0052", 
              sum("0056") AS "0056", 
              sum("0132") AS "0132", 
              sum("0253") AS "0253",
              sum("0256") AS "0256", 
              sum("0257") AS "0257",
              sum("0259") AS "0259", 
              sum("0260") AS "0260", 
              sum("0261") AS "0261", 
              sum("0262") AS "0262",
              sum("0263") AS "0263", 
              sum("0264") AS "0264", 
              sum("0265") AS "0265", 
              sum("0266") AS "0266",
              sum("0267") AS "0267",
              sum("0268") AS "0268"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendozagral2007, "../13.MENDOZA/mendoza_dip_gral2007.csv")

```
#### MISIONES


```{sql misionesgral2007, connection=Arg07,  output.var="misionesgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0012",		
"0014",	
"0020",	
"0050",	
"0229",		
"0230",	
"0231",	
"0232",	
"0233",	 	
"0270")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0229"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0230"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0231"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0232"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0233"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0270"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '14'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0012") AS "0012", 
              sum("0014") AS "0014", 
              sum("0020") AS "0020", 
              sum("0050") AS "0050",
              sum("0229") AS "0229", 
              sum("0230") AS "0230",
              sum("0231") AS "0231", 
              sum("0232") AS "0232", 
              sum("0233") AS "0233", 
              sum("0270") AS "0270"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misionesgral2007, "../14.MISIONES/misiones_dip_gral2007.csv")

```
#### NEUQUEN


```{sql neuquengral2007, connection=Arg07,  output.var="neuquengral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0006",	
"0045",			
"0048",	
"0178",	
"0179",		
"0180",	
"0181",	
"0187",	
"0440",	 	
"0441")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0178"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0179"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0180"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0181"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0440"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0441"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0006") AS "0006", 
              sum("0045") AS "0045", 
              sum("0048") AS "0048",
              sum("0178") AS "0178", 
              sum("0179") AS "0179",
              sum("0180") AS "0180", 
              sum("0181") AS "0181", 
              sum("0187") AS "0187", 
              sum("0440") AS "0440",
              sum("0441") AS "0441"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquengral2007, "../15.NEUQUEN/neuquen_dip_gral2007.csv")

```
#### RIO NEGRO


```{sql rnegrogral2007, connection=Arg07,  output.var="rnegrogral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0276",		
"0277",	
"0278",	
"0279",	
"0280",		
"0281",	
"0282",	
"0283")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0276"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0277"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0278"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0279"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0280"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0281"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0282"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0283"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0276") AS "0276", 
              sum("0277") AS "0277", 
              sum("0278") AS "0278", 
              sum("0279") AS "0279",
              sum("0280") AS "0280", 
              sum("0281") AS "0281",
              sum("0282") AS "0282", 
              sum("0283") AS "0283"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegrogral2007, "../16.RIO_NEGRO/rnegro_dip_gral2007.csv")

```
#### SALTA


```{sql saltagral2007, connection=Arg07,  output.var="saltagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0014",	
"0038",	
"0048",	
"0056",		
"0060",	
"0132",	
"0302",	
"0303",	 	
"0304",			
"0305",			
"0306",			
"0307",			
"0308",
"0439")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0302"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0303"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0304"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0305"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0306"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0307"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0308"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0439"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0048") AS "0048",
              sum("0056") AS "0056", 
              sum("0060") AS "0060",
              sum("0132") AS "0132", 
              sum("0302") AS "0302", 
              sum("0303") AS "0303", 
              sum("0304") AS "0304",
              sum("0305") AS "0305", 
              sum("0306") AS "0306", 
              sum("0307") AS "0307", 
              sum("0308") AS "0308",
              sum("0439") AS "0439"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(saltagral2007, "../17.SALTA/salta_dip_gral2007.csv")

```
#### SAN JUAN


```{sql sjuangral2007, connection=Arg07,  output.var="sjuangral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0047",	
"0050",	
"0052",	
"0134",		
"0201",			
"0202",	
"0203",	
"0204",	
"0205",	 	
"0206",			
"0207",			
"0208")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0052"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0201"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0202"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0203"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0204"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0205"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0206"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0207"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0208"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050", 
              sum("0052") AS "0052",
              sum("0134") AS "0134", 
              sum("0201") AS "0201",
              sum("0202") AS "0202", 
              sum("0203") AS "0203", 
              sum("0204") AS "0204", 
              sum("0205") AS "0205",
              sum("0206") AS "0206", 
              sum("0207") AS "0207", 
              sum("0208") AS "0208"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuangral2007, "../18.SAN_JUAN/sjuan_dip_gral2007.csv")

```
#### SAN LUIS


```{sql sluisgral2007, connection=Arg07,  output.var="sluisgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0037",		
"0050",	
"0171",	
"0333",	
"0334",		
"0335",	
"0336")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0171"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0333"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0334"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0335"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0336"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0037") AS "0037", 
              sum("0050") AS "0050", 
              sum("0171") AS "0171", 
              sum("0333") AS "0333",
              sum("0334") AS "0334", 
              sum("0335") AS "0335",
              sum("0336") AS "0336"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluisgral2007, "../19.SAN_LUIS/sluis_dip_gral2007.csv")

```
#### SANTA CRUZ


```{sql scruzgral2007, connection=Arg07,  output.var="scruzgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0445",	
"0447",	
"0448")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0445"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0447"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0448"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0445") AS "0445", 
              sum("0447") AS "0447", 
              sum("0448") AS "0448"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruzgral2007, "../20.SANTA_CRUZ/scruz_dip_gral2007.csv")

```
#### SANTA FE


```{sql sfegral2007, connection=Arg07,  output.var="sfegral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0009",	
"0014",	
"0019",	
"0020",		
"0026",	
"0030",	
"0036",	
"0037",	 	
"0038",			
"0044",			
"0045",			
"0050",			
"0132",
"0134",		
"0136",	
"0154",	
"0189",	
"0190",	 	
"0191",			
"0192")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0009"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0019"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0026"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0189"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0190"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0191"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0192"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0009") AS "0009", 
              sum("0014") AS "0014", 
              sum("0019") AS "0019",
              sum("0020") AS "0020", 
              sum("0026") AS "0026",
              sum("0030") AS "0030", 
              sum("0036") AS "0036", 
              sum("0037") AS "0037", 
              sum("0038") AS "0038",
              sum("0044") AS "0044", 
              sum("0045") AS "0045", 
              sum("0050") AS "0050", 
              sum("0132") AS "0132",
              sum("0134") AS "0134", 
              sum("0136") AS "0136",
              sum("0154") AS "0154", 
              sum("0189") AS "0189", 
              sum("0190") AS "0190", 
              sum("0191") AS "0191",
              sum("0192") AS "0192"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfegral2007, "../21.SANTA_FE/sfe_dip_gral2007.csv")

```
#### SANTIAGO DEL ESTERO


```{sql sdegral2007, connection=Arg07,  output.var="sdegral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0005",	
"0012",	
"0014",	
"0017",		
"0038",	
"0050",	
"0056",	
"0057",	 	
"0060",			
"0175",			
"0187",			
"0209",			
"0210",
"0211",		
"0212",	
"0213",	
"0442")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0017"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0057"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0175"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0209"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0210"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0211"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0212"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0213"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0442"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0005") AS "0005", 
              sum("0012") AS "0012", 
              sum("0014") AS "0014",
              sum("0017") AS "0017", 
              sum("0038") AS "0038",
              sum("0050") AS "0050", 
              sum("0056") AS "0056", 
              sum("0057") AS "0057", 
              sum("0060") AS "0060",
              sum("0175") AS "0175", 
              sum("0187") AS "0187", 
              sum("0209") AS "0209", 
              sum("0210") AS "0210",
              sum("0211") AS "0211", 
              sum("0212") AS "0212",
              sum("0213") AS "0213", 
              sum("0442") AS "0442"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sdegral2007, "../22.SANTIAGO_DEL_ESTERO/sde_dip_gral2007.csv")

```
#### TUCUMAN


```{sql tucumangral2007, connection=Arg07,  output.var="tucumangral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0014",	
"0022",	
"0038",	
"0045",		
"0048",	
"0050",	
"0060",	
"0131",	 	
"0134",			
"0193",			
"0194",			
"0195",			
"0196")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0193"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0195"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0196"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0014") AS "0014", 
              sum("0022") AS "0022", 
              sum("0038") AS "0038",
              sum("0045") AS "0045", 
              sum("0048") AS "0048",
              sum("0050") AS "0050", 
              sum("0060") AS "0060", 
              sum("0131") AS "0131", 
              sum("0134") AS "0134",
              sum("0193") AS "0193", 
              sum("0194") AS "0194", 
              sum("0195") AS "0195", 
              sum("0196") AS "0196"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucumangral2007, "../23.TUCUMAN/tucuman_dip_gral2007.csv")

```
#### TIERRA DEL FUEGO



```{sql tdfgral2007, connection=Arg07,  output.var="tdfgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0005",	
"0022",	
"0047",	
"0050",		
"0052",	
"0055",	
"0187",	
"0245",	 	
"0249",			
"0250",			
"0436",			
"0437",			
"0438")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0052"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0055"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0245"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0249"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0250"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0436"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0437"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0438"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0005") AS "0005", 
              sum("0022") AS "0022", 
              sum("0047") AS "0047",
              sum("0050") AS "0050", 
              sum("0052") AS "0052",
              sum("0055") AS "0055", 
              sum("0187") AS "0187", 
              sum("0245") AS "0245", 
              sum("0249") AS "0249",
              sum("0250") AS "0250", 
              sum("0436") AS "0436", 
              sum("0437") AS "0437", 
              sum("0438") AS "0438"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdfgral2007, "../24.TIERRA_DEL_FUEGO/tdf_dip_gral2007.csv")

```







### 2009

#### CABA



```{sql cabagral2007, connection=Arg09,  output.var="cabagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0014",	
"0037",	
"0038",	
"0050",	 	
"0127",			
"0131",			
"0133",	 	
"0146",			
"0136",			
"0146",
"0149",		
"0150",	
"0151",	
"0152",	
"0153",	 	
"0154",			
"0156",			
"0157",			
"0158",			
"0507",
"0545",		
"0548",	
"0549",	
"0588",	
"0589")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0127"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0146"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0146"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0149"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0150"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0151"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0152"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0156"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0157"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0158"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0548"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0549"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0588"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0589"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '01'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0014") AS "0014", 
              sum("0037") AS "0037", 
              sum("0038") AS "0038",
              sum("0050") AS "0050", 
              sum("0127") AS "0127",
              sum("0131") AS "0131", 
              sum("0133") AS "0133", 
              sum("0146") AS "0146", 
              sum("0136") AS "0136",
              sum("0146") AS "0146", 
              sum("0149") AS "0149", 
              sum("0150") AS "0150", 
              sum("0151") AS "0151",
              sum("0152") AS "0152", 
              sum("0153") AS "0153",
              sum("0154") AS "0154", 
              sum("0156") AS "0156", 
              sum("0157") AS "0157", 
              sum("0158") AS "0158",
              sum("0507") AS "0507", 
              sum("0545") AS "0545", 
              sum("0548") AS "0548", 
              sum("0549") AS "0549",
              sum("0588") AS "0588", 
              sum("0589") AS "0589"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cabagral2009, "../1.CABA/caba_dip_gral2009.csv")

```


#### PBA



```{sql pbagral2009, connection=Arg09,  output.var="pbagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0037",	
"0051",	
"0100",	
"0148",		
"0185",	
"0186",	
"0187",	
"0188",	 	
"0189",			
"0190",			
"0191",			
"0192",			
"0241",
"0294",		
"0295",	
"0531",	
"0533",	
"0546",	 	
"0585")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0100"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0148"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0185"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0189"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0190"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0191"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0192"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0241"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0294"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0295"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0531"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0533"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0585"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0037") AS "0037", 
              sum("0051") AS "0051", 
              sum("0100") AS "0100",
              sum("0148") AS "0148", 
              sum("0185") AS "0185",
              sum("0186") AS "0186", 
              sum("0187") AS "0187", 
              sum("0188") AS "0188", 
              sum("0189") AS "0189",
              sum("0190") AS "0190", 
              sum("0191") AS "0191", 
              sum("0192") AS "0192", 
              sum("0241") AS "0241",
              sum("0294") AS "0294", 
              sum("0295") AS "0295",
              sum("0531") AS "0531", 
              sum("0533") AS "0533", 
              sum("0546") AS "0546", 
              sum("0585") AS "0585"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pbagral2009, "../2.PBA/sfe_dip_gral2009.csv")

```


#### CATAMARCA



```{sql catamarcagral2009, connection=Arg09,  output.var="catamarcagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0036",	
"0501",	
"0504",	
"0523",		
"0537")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0523"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0537"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0036") AS "0036", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0523") AS "0523", 
              sum("0537") AS "0537"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarcagral2009, "../3.CATAMARCA/catamarca_dip_gral2009.csv")

```



#### CORDOBA



```{sql cordobagral2009, connection=Arg09,  output.var="cordobagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0002",	
"0003",	
"0005",	
"0014",		
"0038",	
"0041",	
"0042",	
"0048",	
"0057",	 	
"0128",			
"0139",			
"0141",			
"0142",			
"0144",
"0145",		
"0147",	
"0148",	
"0161",	
"0507",	 	
"0564",			
"0565",			
"0566")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0041"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0042"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0057"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0128"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0139"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0141"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0142"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0144"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0145"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0147"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0148"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0161"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0564"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0565"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0566"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0005") AS "0005",
              sum("0014") AS "0014", 
              sum("0038") AS "0038",
              sum("0041") AS "0041", 
              sum("0042") AS "0042", 
              sum("0048") AS "0048", 
              sum("0057") AS "0057",
              sum("0128") AS "0128", 
              sum("0139") AS "0139", 
              sum("0141") AS "0141", 
              sum("0142") AS "0142",
              sum("0144") AS "0144", 
              sum("0145") AS "0145",
              sum("0147") AS "0147", 
              sum("0148") AS "0148", 
              sum("0161") AS "0161", 
              sum("0507") AS "0507",
              sum("0564") AS "0564", 
              sum("0565") AS "0565", 
              sum("0566") AS "0566"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordobagral2009, "../4.CORDOBA/cordoba_dip_gral2009.csv")

```



#### CORRIENTES


```{sql corrientesgral2009, connection=Arg09,  output.var="corrientesgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0002",	
"0003",	
"0005",	
"0006",		
"0008",	
"0009",	
"0012",	
"0019",	 	
"0020",			
"0033",			
"0036",			
"0040",			
"0044",			
"0047",
"0048",		
"0050",	
"0056",	
"0120",	
"0289",	 	
"0290",			
"0291",			
"0292",			
"0293",			
"0543",
"0545",			
"0586",			
"0587")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0009"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0019"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0120"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0289"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0290"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0291"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0292"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0293"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0543"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0586"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0587"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0005") AS "0005",
              sum("0006") AS "0006", 
              sum("0008") AS "0008",
              sum("0009") AS "0009", 
              sum("0012") AS "0012", 
              sum("0019") AS "0019", 
              sum("0020") AS "0020",
              sum("0033") AS "0033", 
              sum("0036") AS "0036", 
              sum("0040") AS "0040", 
              sum("0044") AS "0044",
              sum("0047") AS "0047", 
              sum("0048") AS "0048",
              sum("0050") AS "0050", 
              sum("0056") AS "0056", 
              sum("0120") AS "0120", 
              sum("0289") AS "0289",
              sum("0290") AS "0290", 
              sum("0291") AS "0291", 
              sum("0292") AS "0292", 
              sum("0293") AS "0293",
              sum("0543") AS "0543", 
              sum("0545") AS "0545",
              sum("0586") AS "0586",
              sum("0587") AS "0587"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(corrientesgral2009, "../5.CORRIENTES/corrientes_dip_gral2009.csv")

```
#### CHACO


```{sql chacogral2009, connection=Arg09,  output.var="chacogral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0047",	
"0060",	
"0163",	
"0168",		
"0169",	
"0170",	
"0171")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0163"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0168"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0169"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0170"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0171"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0047") AS "0047", 
              sum("0060") AS "0060", 
              sum("0163") AS "0163",
              sum("0168") AS "0168", 
              sum("0169") AS "0169",
              sum("0170") AS "0170", 
              sum("0171") AS "0171"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chacogral2009, "../6.CHACO/chaco_dip_gral2009.csv")

```
#### CHUBUT


```{sql chubutgral2009, connection=Arg09,  output.var="chubutgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0022",	
"0038",	
"0047",		
"0173",	
"0174",	
"0251")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0173"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0251"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0022") AS "0022", 
              sum("0038") AS "0038",
              sum("0047") AS "0047", 
              sum("0173") AS "0173",
              sum("0174") AS "0174", 
              sum("0251") AS "0251"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubutgral2009, "../7.CHUBUT/chubut_dip_gral2009.csv")

```
#### ENTRE RIOS


```{sql eriosgral2009, connection=Arg09,  output.var="eriosgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0038",	
"0044",	
"0048",	
"0051",		
"0059",	
"0131",	
"0132",	
"0133",	
"0134",	 	
"0154",			
"0309")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0059"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0309"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0038") AS "0038", 
              sum("0044") AS "0044", 
              sum("0048") AS "0048",
              sum("0051") AS "0051", 
              sum("0059") AS "0059",
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133", 
              sum("0134") AS "0134",
              sum("0154") AS "0154", 
              sum("0309") AS "0309"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(eriosgral2009, "../8.ENTRE_RIOS/erios_dip_gral2009.csv")

```
#### FORMOSA


```{sql formosagral2009, connection=Arg09,  output.var="formosagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0022",		
"0047",	
"0051",	
"0289",	
"0290",		
"0291",	
"0292",	
"0293",	
"0294")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0289"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0290"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0291"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0292"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0293"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0294"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '09'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0022") AS "0022", 
              sum("0047") AS "0047", 
              sum("0051") AS "0051", 
              sum("0289") AS "0289",
              sum("0290") AS "0290", 
              sum("0291") AS "0291",
              sum("0292") AS "0292", 
              sum("0293") AS "0293", 
              sum("0294") AS "0294"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosagral2009, "../9.FORMOSA/formosa_dip_gral2009.csv")

```
#### JUJUY


```{sql jujuygral2009, connection=Arg09,  output.var="jujuygral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0014",	
"0038",	
"0045",	
"0187",		
"0188",	
"0243",	
"0325",	
"0326",	 	
"0327",			
"0328",			
"0329")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0243"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0325"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0326"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0327"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0328"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0329"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0045") AS "0045",
              sum("0187") AS "0187", 
              sum("0188") AS "0188",
              sum("0243") AS "0243", 
              sum("0325") AS "0325", 
              sum("0326") AS "0326", 
              sum("0327") AS "0327",
              sum("0328") AS "0328", 
              sum("0329") AS "0329"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuygral2009, "../10.JUJUY/jujuy_dip_gral2009.csv")

```
#### LA PAMPA


```{sql pampagral2009, connection=Arg09,  output.var="pampagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0022",	
"0030",	
"0048",	
"0197",		
"0198",	
"0199",	
"0200",	
"0201",	 	
"0252")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0197"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0198"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0199"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0200"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0201"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0252"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0022") AS "0022", 
              sum("0030") AS "0030", 
              sum("0048") AS "0048",
              sum("0197") AS "0197", 
              sum("0198") AS "0198",
              sum("0199") AS "0199", 
              sum("0200") AS "0200", 
              sum("0201") AS "0201", 
              sum("0252") AS "0252"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampagral2009, "../11.LA_PAMPA/pampa_dip_gral2009.csv")

```
#### LA RIOJA


```{sql riojagral2009, connection=Arg09,  output.var="riojagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0149",	
"0214",	
"0215",	
"0216",		
"0300")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0149"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0214"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0215"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0216"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0300"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '12'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0149") AS "0149", 
              sum("0214") AS "0214", 
              sum("0215") AS "0215",
              sum("0216") AS "0216", 
              sum("0300") AS "0300"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(riojagral2009, "../12.LA_RIOJA/rioja_dip_gral2009.csv")

```
#### MENDOZA


```{sql mendozagral2009, connection=Arg09,  output.var="mendozagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0005",	
"0006",
"0008",	
"0014",		
"0023",	
"0038",	
"0045",	
"0048",	 	
"0052",			
"0056",			
"0132",			
"0253",			
"0256",
"0257",		
"0259",	
"0260",	
"0261",	
"0262",	 	
"0263",			
"0264",			
"0265",			
"0266",			
"0267",
"0268")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0052"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0253"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0256"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0257"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0259"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0260"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0261"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0262"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0263"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0264"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0265"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0266"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0267"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0268"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0005") AS "0005", 
              sum("0006") AS "0006",
              sum("0008") AS "0008", 
              sum("0014") AS "0014",
              sum("0023") AS "0023", 
              sum("0038") AS "0038", 
              sum("0045") AS "0045", 
              sum("0048") AS "0048",
              sum("0052") AS "0052", 
              sum("0056") AS "0056", 
              sum("0132") AS "0132", 
              sum("0253") AS "0253",
              sum("0256") AS "0256", 
              sum("0257") AS "0257",
              sum("0259") AS "0259", 
              sum("0260") AS "0260", 
              sum("0261") AS "0261", 
              sum("0262") AS "0262",
              sum("0263") AS "0263", 
              sum("0264") AS "0264", 
              sum("0265") AS "0265", 
              sum("0266") AS "0266",
              sum("0267") AS "0267",
              sum("0268") AS "0268"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendozagral2009, "../13.MENDOZA/mendoza_dip_gral2009.csv")

```
#### MISIONES


```{sql misionesgral2009, connection=Arg09,  output.var="misionesgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0012",		
"0014",	
"0020",	
"0050",	
"0229",		
"0230",	
"0231",	
"0232",	
"0233",	 	
"0270")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0229"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0230"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0231"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0232"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0233"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0270"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '14'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0012") AS "0012", 
              sum("0014") AS "0014", 
              sum("0020") AS "0020", 
              sum("0050") AS "0050",
              sum("0229") AS "0229", 
              sum("0230") AS "0230",
              sum("0231") AS "0231", 
              sum("0232") AS "0232", 
              sum("0233") AS "0233", 
              sum("0270") AS "0270"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misionesgral2009, "../14.MISIONES/misiones_dip_gral2009.csv")

```
#### NEUQUEN


```{sql neuquengral2009, connection=Arg09,  output.var="neuquengral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0006",	
"0045",			
"0048",	
"0178",	
"0179",		
"0180",	
"0181",	
"0187",	
"0440",	 	
"0441")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0178"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0179"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0180"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0181"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0440"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0441"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0006") AS "0006", 
              sum("0045") AS "0045", 
              sum("0048") AS "0048",
              sum("0178") AS "0178", 
              sum("0179") AS "0179",
              sum("0180") AS "0180", 
              sum("0181") AS "0181", 
              sum("0187") AS "0187", 
              sum("0440") AS "0440",
              sum("0441") AS "0441"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquengral2009, "../15.NEUQUEN/neuquen_dip_gral2009.csv")

```
#### RIO NEGRO


```{sql rnegrogral2009, connection=Arg09,  output.var="rnegrogral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0276",		
"0277",	
"0278",	
"0279",	
"0280",		
"0281",	
"0282",	
"0283")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0276"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0277"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0278"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0279"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0280"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0281"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0282"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0283"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0276") AS "0276", 
              sum("0277") AS "0277", 
              sum("0278") AS "0278", 
              sum("0279") AS "0279",
              sum("0280") AS "0280", 
              sum("0281") AS "0281",
              sum("0282") AS "0282", 
              sum("0283") AS "0283"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegrogral2009, "../16.RIO_NEGRO/rnegro_dip_gral2009.csv")

```
#### SALTA


```{sql saltagral2009, connection=Arg09,  output.var="saltagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0014",	
"0038",	
"0048",	
"0056",		
"0060",	
"0132",	
"0302",	
"0303",	 	
"0304",			
"0305",			
"0306",			
"0307",			
"0308",
"0439")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0302"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0303"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0304"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0305"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0306"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0307"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0308"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0439"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0048") AS "0048",
              sum("0056") AS "0056", 
              sum("0060") AS "0060",
              sum("0132") AS "0132", 
              sum("0302") AS "0302", 
              sum("0303") AS "0303", 
              sum("0304") AS "0304",
              sum("0305") AS "0305", 
              sum("0306") AS "0306", 
              sum("0307") AS "0307", 
              sum("0308") AS "0308",
              sum("0439") AS "0439"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(saltagral2009, "../17.SALTA/salta_dip_gral2009.csv")

```
#### SAN JUAN


```{sql sjuangral2009, connection=Arg09,  output.var="sjuangral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0047",	
"0050",	
"0052",	
"0134",		
"0201",			
"0202",	
"0203",	
"0204",	
"0205",	 	
"0206",			
"0207",			
"0208")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0052"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0201"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0202"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0203"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0204"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0205"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0206"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0207"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0208"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050", 
              sum("0052") AS "0052",
              sum("0134") AS "0134", 
              sum("0201") AS "0201",
              sum("0202") AS "0202", 
              sum("0203") AS "0203", 
              sum("0204") AS "0204", 
              sum("0205") AS "0205",
              sum("0206") AS "0206", 
              sum("0207") AS "0207", 
              sum("0208") AS "0208"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuangral2009, "../18.SAN_JUAN/sjuan_dip_gral2009.csv")

```
#### SAN LUIS


```{sql sluisgral2009, connection=Arg09,  output.var="sluisgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0037",		
"0050",	
"0171",	
"0333",	
"0334",		
"0335",	
"0336")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0171"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0333"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0334"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0335"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0336"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0037") AS "0037", 
              sum("0050") AS "0050", 
              sum("0171") AS "0171", 
              sum("0333") AS "0333",
              sum("0334") AS "0334", 
              sum("0335") AS "0335",
              sum("0336") AS "0336"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluisgral2009, "../19.SAN_LUIS/sluis_dip_gral2009.csv")

```
#### SANTA CRUZ


```{sql scruzgral2009, connection=Arg09,  output.var="scruzgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0445",	
"0447",	
"0448")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0445"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0447"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0448"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0445") AS "0445", 
              sum("0447") AS "0447", 
              sum("0448") AS "0448"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruzgral2009, "../20.SANTA_CRUZ/scruz_dip_gral2009.csv")

```
#### SANTA FE


```{sql sfegral2009, connection=Arg09,  output.var="sfegral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0009",	
"0014",	
"0019",	
"0020",		
"0026",	
"0030",	
"0036",	
"0037",	 	
"0038",			
"0044",			
"0045",			
"0050",			
"0132",
"0134",		
"0136",	
"0154",	
"0189",	
"0190",	 	
"0191",			
"0192")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0009"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0019"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0026"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0189"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0190"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0191"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0192"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0009") AS "0009", 
              sum("0014") AS "0014", 
              sum("0019") AS "0019",
              sum("0020") AS "0020", 
              sum("0026") AS "0026",
              sum("0030") AS "0030", 
              sum("0036") AS "0036", 
              sum("0037") AS "0037", 
              sum("0038") AS "0038",
              sum("0044") AS "0044", 
              sum("0045") AS "0045", 
              sum("0050") AS "0050", 
              sum("0132") AS "0132",
              sum("0134") AS "0134", 
              sum("0136") AS "0136",
              sum("0154") AS "0154", 
              sum("0189") AS "0189", 
              sum("0190") AS "0190", 
              sum("0191") AS "0191",
              sum("0192") AS "0192"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfegral2009, "../21.SANTA_FE/sfe_dip_gral2009.csv")

```
#### SANTIAGO DEL ESTERO


```{sql sdegral2009, connection=Arg09,  output.var="sdegral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0005",	
"0012",	
"0014",	
"0017",		
"0038",	
"0050",	
"0056",	
"0057",	 	
"0060",			
"0175",			
"0187",			
"0209",			
"0210",
"0211",		
"0212",	
"0213",	
"0442")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0017"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0057"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0175"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0209"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0210"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0211"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0212"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0213"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0442"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0005") AS "0005", 
              sum("0012") AS "0012", 
              sum("0014") AS "0014",
              sum("0017") AS "0017", 
              sum("0038") AS "0038",
              sum("0050") AS "0050", 
              sum("0056") AS "0056", 
              sum("0057") AS "0057", 
              sum("0060") AS "0060",
              sum("0175") AS "0175", 
              sum("0187") AS "0187", 
              sum("0209") AS "0209", 
              sum("0210") AS "0210",
              sum("0211") AS "0211", 
              sum("0212") AS "0212",
              sum("0213") AS "0213", 
              sum("0442") AS "0442"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sdegral2009, "../22.SANTIAGO_DEL_ESTERO/sde_dip_gral2009.csv")

```
#### TUCUMAN


```{sql tucumangral2009, connection=Arg09,  output.var="tucumangral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0014",	
"0022",	
"0038",	
"0045",		
"0048",	
"0050",	
"0060",	
"0131",	 	
"0134",			
"0193",			
"0194",			
"0195",			
"0196")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0193"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0195"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0196"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0014") AS "0014", 
              sum("0022") AS "0022", 
              sum("0038") AS "0038",
              sum("0045") AS "0045", 
              sum("0048") AS "0048",
              sum("0050") AS "0050", 
              sum("0060") AS "0060", 
              sum("0131") AS "0131", 
              sum("0134") AS "0134",
              sum("0193") AS "0193", 
              sum("0194") AS "0194", 
              sum("0195") AS "0195", 
              sum("0196") AS "0196"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucumangral2009, "../23.TUCUMAN/tucuman_dip_gral2009.csv")

```
#### TIERRA DEL FUEGO



```{sql tdfgral2009, connection=Arg09,  output.var="tdfgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0005",	
"0022",	
"0047",	
"0050",		
"0052",	
"0055",	
"0187",	
"0245",	 	
"0249",			
"0250",			
"0436",			
"0437",			
"0438")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0052"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0055"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0245"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0249"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0250"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0436"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0437"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0438"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0005") AS "0005", 
              sum("0022") AS "0022", 
              sum("0047") AS "0047",
              sum("0050") AS "0050", 
              sum("0052") AS "0052",
              sum("0055") AS "0055", 
              sum("0187") AS "0187", 
              sum("0245") AS "0245", 
              sum("0249") AS "0249",
              sum("0250") AS "0250", 
              sum("0436") AS "0436", 
              sum("0437") AS "0437", 
              sum("0438") AS "0438"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdfgral2009, "../24.TIERRA_DEL_FUEGO/tdf_dip_gral2009.csv")

```













### 2011


#### PASO

```{sql paso2011, connection=Arg11P,  output.var="paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0047",		
"0131",	
"0132",	
"0133",	
"0134",	 	
"0135",			
"0137")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasPresidente
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133",
              sum("0134") AS "0134", 
              sum("0135") AS "0135",
              sum("0137") AS "0137"
        FROM
        votos
           INNER JOIN MesasPresidente ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(paso2011, "../00.PRESIDENCIAL/presi_paso2011.csv")

```


#### GRAL

```{sql gral2011, connection=Arg11G,  output.var="gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0047",		
"0131",	
"0132",	
"0133",	
"0134",	 	
"0135",			
"0137")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasPresidente
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133",
              sum("0134") AS "0134", 
              sum("0135") AS "0135",
              sum("0137") AS "0137"
        FROM
        votos
           INNER JOIN MesasPresidente ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(gral2011, "../00.PRESIDENCIAL/presi_gral2011.csv")

```



### 2013


#### PASO

```{sql paso2013, connection=Arg13P,  output.var="paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0047",		
"0131",	
"0132",	
"0133",	
"0134",	 	
"0135",			
"0137")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasPresidente
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133",
              sum("0134") AS "0134", 
              sum("0135") AS "0135",
              sum("0137") AS "0137"
        FROM
        votos
           INNER JOIN MesasPresidente ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(paso2013, "../00.PRESIDENCIAL/presi_paso2013.csv")

```


#### GRAL

```{sql gral2013, connection=Arg13G,  output.var="gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0047",		
"0131",	
"0132",	
"0133",	
"0134",	 	
"0135",			
"0137")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasPresidente
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133",
              sum("0134") AS "0134", 
              sum("0135") AS "0135",
              sum("0137") AS "0137"
        FROM
        votos
           INNER JOIN MesasPresidente ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(gral2013, "../00.PRESIDENCIAL/presi_gral2013.csv")

```






### 2015


#### PASO

```{sql paso2015, connection=Arg15P,  output.var="paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0013",		
"0057",	
"0081",	
"0131",	
"0132",	 	
"0133",			
"0134",			
"0135",			
"0136",			
"0137",			
"0138")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0013"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0057"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0081"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaPresidente
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0013") AS "0013", 
              sum("0057") AS "0057", 
              sum("0081") AS "0081", 
              sum("0131") AS "0131",
              sum("0132") AS "0132", 
              sum("0133") AS "0133",
              sum("0134") AS "0134", 
              sum("0135") AS "0135", 
              sum("0136") AS "0136", 
              sum("0137") AS "0137",
              sum("0138") AS "0138"
        FROM
        votos
           INNER JOIN MesasPresidente ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(paso2015, "../00.PRESIDENCIAL/presi_paso2015.csv")

```


#### GRAL

```{sql gral2015, connection=Arg15G,  output.var="gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0132",	
"0133",	
"0135",	
"0137",	 	
"0138")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaPresidente
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133", 
              sum("0135") AS "0135",
              sum("0137") AS "0137", 
              sum("0138") AS "0138"
        FROM
        votos
           INNER JOIN MesasPresidente ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(gral2015, "../00.PRESIDENCIAL/presi_gral2015.csv")

```




### 2017


#### PASO

```{sql paso2017, connection=Arg17P,  output.var="paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0013",		
"0057",	
"0081",	
"0131",	
"0132",	 	
"0133",			
"0134",			
"0135",			
"0136",			
"0137",			
"0138")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0013"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0057"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0081"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaPresidente
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0013") AS "0013", 
              sum("0057") AS "0057", 
              sum("0081") AS "0081", 
              sum("0131") AS "0131",
              sum("0132") AS "0132", 
              sum("0133") AS "0133",
              sum("0134") AS "0134", 
              sum("0135") AS "0135", 
              sum("0136") AS "0136", 
              sum("0137") AS "0137",
              sum("0138") AS "0138"
        FROM
        votos
           INNER JOIN MesasPresidente ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(paso2017, "../00.PRESIDENCIAL/presi_paso2017.csv")

```


#### GRAL

```{sql gral2017, connection=Arg17G,  output.var="gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0132",	
"0133",	
"0135",	
"0137",	 	
"0138")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaPresidente
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133", 
              sum("0135") AS "0135",
              sum("0137") AS "0137", 
              sum("0138") AS "0138"
        FROM
        votos
           INNER JOIN MesasPresidente ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(gral2017, "../00.PRESIDENCIAL/presi_gral2017.csv")

```


