---
title: "Resultados Diputado Nacional"
output: html_notebook
---



### 2007 

#### CABA



```{sql cabagral2007, connection=Arg07,  output.var="cabagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0005",	
"0009",	
"0014",	
"0020",	 	
"0023",			
"0036",			
"0037",			
"0038",			
"0050",
"0051",		
"0060",	
"0131",	
"0134",	
"0135",	 	
"0136",			
"0137",			
"0138",			
"0139",			
"0140",
"0141",		
"0142",	
"0143",	
"0144",	
"0145",	 	
"0146",			
"0147",			
"0188",			
"0252",			
"0332")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0009"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0139"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0140"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0141"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0142"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0143"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0144"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0145"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0146"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0147"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0252"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0332"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0005") AS "0005", 
              sum("0009") AS "0009", 
              sum("0014") AS "0014",
              sum("0020") AS "0020", 
              sum("0023") AS "0023",
              sum("0036") AS "0036", 
              sum("0037") AS "0037", 
              sum("0038") AS "0038", 
              sum("0050") AS "0050",
              sum("0051") AS "0051", 
              sum("0060") AS "0060", 
              sum("0131") AS "0131", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0136") AS "0136",
              sum("0137") AS "0137", 
              sum("0138") AS "0138", 
              sum("0139") AS "0139", 
              sum("0140") AS "0140",
              sum("0141") AS "0141", 
              sum("0142") AS "0142", 
              sum("0143") AS "0143", 
              sum("0144") AS "0144",
              sum("0145") AS "0145", 
              sum("0146") AS "0146",
              sum("0147") AS "0147", 
              sum("0188") AS "0188", 
              sum("0252") AS "0252", 
              sum("0332") AS "0332"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cabagral2007, "../../data/01.CABA/caba_dip_gral2007.csv")

```


#### PBA



```{sql pbagral2007, connection=Arg07,  output.var="pbagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0030",	
"0038",	
"0048",		
"0051",	
"0060",	
"0132",	
"0133",	 	
"0134",			
"0135",			
"0141",			
"0144",			
"0250",
"0260",		
"0269",	
"0273",	
"0275",	
"0311",	 	
"0312",			
"0313",			
"0314",			
"0315",			
"0316",
"0317")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0141"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0144"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0250"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0260"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0269"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0273"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0275"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0311"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0312"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0313"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0314"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0315"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0316"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0317"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0030") AS "0030", 
              sum("0038") AS "0038",
              sum("0048") AS "0048", 
              sum("0051") AS "0051",
              sum("0060") AS "0060", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0141") AS "0141", 
              sum("0144") AS "0144", 
              sum("0250") AS "0250",
              sum("0260") AS "0260", 
              sum("0269") AS "0269",
              sum("0273") AS "0273", 
              sum("0275") AS "0275", 
              sum("0311") AS "0311", 
              sum("0312") AS "0312",
              sum("0313") AS "0313", 
              sum("0314") AS "0314", 
              sum("0315") AS "0315", 
              sum("0316") AS "0316",
              sum("0317") AS "0317"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pbagral2007, "../../data/02.PBA/pba_dip_gral2007.csv")

```


#### CATAMARCA



```{sql catamarcagral2007, connection=Arg07,  output.var="catamarcagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0036",	
"0038",	
"0047",	
"0148",		
"0149",	
"0150",	
"0187",	
"0188",	 	
"0330",			
"0332")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0148"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0149"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0150"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0330"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0332"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0036") AS "0036", 
              sum("0038") AS "0038", 
              sum("0047") AS "0047",
              sum("0148") AS "0148", 
              sum("0149") AS "0149",
              sum("0150") AS "0150", 
              sum("0187") AS "0187", 
              sum("0188") AS "0188", 
              sum("0330") AS "0330",
              sum("0332") AS "0332"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarcagral2007, "../../data/3.CATAMARCA/catamarca_dip_gral2007.csv")

```



#### CORDOBA



```{sql cordobagral2007, connection=Arg07,  output.var="cordobagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0003",	
"0014",	
"0020",	
"0038",		
"0041",	
"0043",	
"0047",	
"0056",	
"0057",	 	
"0132",			
"0134",			
"0135",			
"0151",			
"0152",
"0153",		
"0154",	
"0155",	
"0157",	
"0158",	 	
"0159",			
"0160",			
"0161")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0041"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0043"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0057"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0151"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0152"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0155"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0157"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0158"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0159"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0160"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0161"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0020") AS "0020",
              sum("0038") AS "0038", 
              sum("0041") AS "0041",
              sum("0043") AS "0043", 
              sum("0047") AS "0047", 
              sum("0056") AS "0056", 
              sum("0057") AS "0057",
              sum("0132") AS "0132", 
              sum("0134") AS "0134", 
              sum("0135") AS "0135", 
              sum("0151") AS "0151",
              sum("0152") AS "0152", 
              sum("0153") AS "0153",
              sum("0154") AS "0154", 
              sum("0155") AS "0155", 
              sum("0157") AS "0157", 
              sum("0158") AS "0158",
              sum("0159") AS "0159", 
              sum("0160") AS "0160", 
              sum("0161") AS "0161"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordobagral2007, "../../data/4.CORDOBA/cordoba_dip_gral2007.csv")

```



#### CORRIENTES


```{sql corrientesgral2007, connection=Arg07,  output.var="corrientesgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0002",	
"0003",	
"0005",	
"0008",		
"0009",	
"0012",	
"0019",	
"0020",	 	
"0023",			
"0033",			
"0036",			
"0044",			
"0047",			
"0048",
"0050",		
"0055",	
"0056",	
"0059",	
"0134",	 	
"0163",			
"0182",			
"0284",			
"0285",			
"0286",
"0287",			
"0288")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0009"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0019"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0055"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0059"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0163"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0182"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0284"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0285"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0286"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0287"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0288"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0005") AS "0005",
              sum("0008") AS "0008", 
              sum("0009") AS "0009",
              sum("0012") AS "0012", 
              sum("0019") AS "0019", 
              sum("0020") AS "0020", 
              sum("0023") AS "0023",
              sum("0033") AS "0033", 
              sum("0036") AS "0036", 
              sum("0044") AS "0044", 
              sum("0047") AS "0047",
              sum("0048") AS "0048", 
              sum("0050") AS "0050",
              sum("0055") AS "0055", 
              sum("0056") AS "0056", 
              sum("0059") AS "0059", 
              sum("0134") AS "0134",
              sum("0163") AS "0163", 
              sum("0182") AS "0182", 
              sum("0284") AS "0284", 
              sum("0285") AS "0285",
              sum("0286") AS "0286", 
              sum("0287") AS "0287",
              sum("0288") AS "0288"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(corrientesgral2007, "../../data/5.CORRIENTES/corrientes_dip_gral2007.csv")

```
#### CHACO


```{sql chacogral2007, connection=Arg07,  output.var="chacogral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0047",	
"0060",	
"0163",	
"0168",		
"0169",	
"0170",	
"0171")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0163"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0168"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0169"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0170"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0171"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0047") AS "0047", 
              sum("0060") AS "0060", 
              sum("0163") AS "0163",
              sum("0168") AS "0168", 
              sum("0169") AS "0169",
              sum("0170") AS "0170", 
              sum("0171") AS "0171"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chacogral2007, "../../data/6.CHACO/chaco_dip_gral2007.csv")

```
#### CHUBUT


```{sql chubutgral2007, connection=Arg07,  output.var="chubutgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0022",	
"0038",	
"0047",		
"0173",	
"0174",	
"0251")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0173"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0251"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0022") AS "0022", 
              sum("0038") AS "0038",
              sum("0047") AS "0047", 
              sum("0173") AS "0173",
              sum("0174") AS "0174", 
              sum("0251") AS "0251"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubutgral2007, "../../data/7.CHUBUT/chubut_dip_gral2007.csv")

```
#### ENTRE RIOS


```{sql eriosgral2007, connection=Arg07,  output.var="eriosgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0038",	
"0044",	
"0048",	
"0051",		
"0059",	
"0131",	
"0132",	
"0133",	
"0134",	 	
"0154",			
"0309")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0059"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0309"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0038") AS "0038", 
              sum("0044") AS "0044", 
              sum("0048") AS "0048",
              sum("0051") AS "0051", 
              sum("0059") AS "0059",
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133", 
              sum("0134") AS "0134",
              sum("0154") AS "0154", 
              sum("0309") AS "0309"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(eriosgral2007, "../../data/8.ENTRE_RIOS/erios_dip_gral2007.csv")

```
#### FORMOSA


```{sql formosagral2007, connection=Arg07,  output.var="formosagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0022",		
"0047",	
"0051",	
"0289",	
"0290",		
"0291",	
"0292",	
"0293",	
"0294")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0289"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0290"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0291"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0292"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0293"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0294"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '09'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0022") AS "0022", 
              sum("0047") AS "0047", 
              sum("0051") AS "0051", 
              sum("0289") AS "0289",
              sum("0290") AS "0290", 
              sum("0291") AS "0291",
              sum("0292") AS "0292", 
              sum("0293") AS "0293", 
              sum("0294") AS "0294"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosagral2007, "../../data/9.FORMOSA/formosa_dip_gral2007.csv")

```
#### JUJUY


```{sql jujuygral2007, connection=Arg07,  output.var="jujuygral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0014",	
"0038",	
"0045",	
"0187",		
"0188",	
"0243",	
"0325",	
"0326",	 	
"0327",			
"0328",			
"0329")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0243"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0325"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0326"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0327"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0328"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0329"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0045") AS "0045",
              sum("0187") AS "0187", 
              sum("0188") AS "0188",
              sum("0243") AS "0243", 
              sum("0325") AS "0325", 
              sum("0326") AS "0326", 
              sum("0327") AS "0327",
              sum("0328") AS "0328", 
              sum("0329") AS "0329"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuygral2007, "../../data/10.JUJUY/jujuy_dip_gral2007.csv")

```
#### LA PAMPA


```{sql pampagral2007, connection=Arg07,  output.var="pampagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0022",	
"0030",	
"0048",	
"0197",		
"0198",	
"0199",	
"0200",	
"0201",	 	
"0252")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0197"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0198"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0199"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0200"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0201"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0252"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0022") AS "0022", 
              sum("0030") AS "0030", 
              sum("0048") AS "0048",
              sum("0197") AS "0197", 
              sum("0198") AS "0198",
              sum("0199") AS "0199", 
              sum("0200") AS "0200", 
              sum("0201") AS "0201", 
              sum("0252") AS "0252"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampagral2007, "../../data/11.LA_PAMPA/pampa_dip_gral2007.csv")

```
#### LA RIOJA


```{sql riojagral2007, connection=Arg07,  output.var="riojagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0149",	
"0214",	
"0215",	
"0216",		
"0300")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0149"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0214"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0215"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0216"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0300"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '12'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0149") AS "0149", 
              sum("0214") AS "0214", 
              sum("0215") AS "0215",
              sum("0216") AS "0216", 
              sum("0300") AS "0300"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(riojagral2007, "../../data/12.LA_RIOJA/rioja_dip_gral2007.csv")

```
#### MENDOZA


```{sql mendozagral2007, connection=Arg07,  output.var="mendozagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0005",	
"0006",
"0008",	
"0014",		
"0023",	
"0038",	
"0045",	
"0048",	 	
"0052",			
"0056",			
"0132",			
"0253",			
"0256",
"0257",		
"0259",	
"0260",	
"0261",	
"0262",	 	
"0263",			
"0264",			
"0265",			
"0266",			
"0267",
"0268")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0052"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0253"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0256"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0257"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0259"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0260"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0261"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0262"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0263"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0264"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0265"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0266"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0267"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0268"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0005") AS "0005", 
              sum("0006") AS "0006",
              sum("0008") AS "0008", 
              sum("0014") AS "0014",
              sum("0023") AS "0023", 
              sum("0038") AS "0038", 
              sum("0045") AS "0045", 
              sum("0048") AS "0048",
              sum("0052") AS "0052", 
              sum("0056") AS "0056", 
              sum("0132") AS "0132", 
              sum("0253") AS "0253",
              sum("0256") AS "0256", 
              sum("0257") AS "0257",
              sum("0259") AS "0259", 
              sum("0260") AS "0260", 
              sum("0261") AS "0261", 
              sum("0262") AS "0262",
              sum("0263") AS "0263", 
              sum("0264") AS "0264", 
              sum("0265") AS "0265", 
              sum("0266") AS "0266",
              sum("0267") AS "0267",
              sum("0268") AS "0268"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendozagral2007, "../../data/13.MENDOZA/mendoza_dip_gral2007.csv")

```
#### MISIONES


```{sql misionesgral2007, connection=Arg07,  output.var="misionesgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0012",		
"0014",	
"0020",	
"0050",	
"0229",		
"0230",	
"0231",	
"0232",	
"0233",	 	
"0270")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0229"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0230"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0231"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0232"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0233"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0270"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '14'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0012") AS "0012", 
              sum("0014") AS "0014", 
              sum("0020") AS "0020", 
              sum("0050") AS "0050",
              sum("0229") AS "0229", 
              sum("0230") AS "0230",
              sum("0231") AS "0231", 
              sum("0232") AS "0232", 
              sum("0233") AS "0233", 
              sum("0270") AS "0270"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misionesgral2007, "../../data/14.MISIONES/misiones_dip_gral2007.csv")

```
#### NEUQUEN


```{sql neuquengral2007, connection=Arg07,  output.var="neuquengral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0006",	
"0045",			
"0048",	
"0178",	
"0179",		
"0180",	
"0181",	
"0187",	
"0440",	 	
"0441")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0178"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0179"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0180"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0181"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0440"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0441"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0006") AS "0006", 
              sum("0045") AS "0045", 
              sum("0048") AS "0048",
              sum("0178") AS "0178", 
              sum("0179") AS "0179",
              sum("0180") AS "0180", 
              sum("0181") AS "0181", 
              sum("0187") AS "0187", 
              sum("0440") AS "0440",
              sum("0441") AS "0441"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquengral2007, "../../data/15.NEUQUEN/neuquen_dip_gral2007.csv")

```
#### RIO NEGRO


```{sql rnegrogral2007, connection=Arg07,  output.var="rnegrogral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0276",		
"0277",	
"0278",	
"0279",	
"0280",		
"0281",	
"0282",	
"0283")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0276"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0277"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0278"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0279"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0280"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0281"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0282"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0283"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0276") AS "0276", 
              sum("0277") AS "0277", 
              sum("0278") AS "0278", 
              sum("0279") AS "0279",
              sum("0280") AS "0280", 
              sum("0281") AS "0281",
              sum("0282") AS "0282", 
              sum("0283") AS "0283"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegrogral2007, "../../data/16.RIO_NEGRO/rnegro_dip_gral2007.csv")

```
#### SALTA


```{sql saltagral2007, connection=Arg07,  output.var="saltagral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0014",	
"0038",	
"0048",	
"0056",		
"0060",	
"0132",	
"0302",	
"0303",	 	
"0304",			
"0305",			
"0306",			
"0307",			
"0308",
"0439")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0302"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0303"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0304"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0305"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0306"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0307"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0308"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0439"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0048") AS "0048",
              sum("0056") AS "0056", 
              sum("0060") AS "0060",
              sum("0132") AS "0132", 
              sum("0302") AS "0302", 
              sum("0303") AS "0303", 
              sum("0304") AS "0304",
              sum("0305") AS "0305", 
              sum("0306") AS "0306", 
              sum("0307") AS "0307", 
              sum("0308") AS "0308",
              sum("0439") AS "0439"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(saltagral2007, "../../data/17.SALTA/salta_dip_gral2007.csv")

```
#### SAN JUAN


```{sql sjuangral2007, connection=Arg07,  output.var="sjuangral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0047",	
"0050",	
"0052",	
"0134",		
"0201",			
"0202",	
"0203",	
"0204",	
"0205",	 	
"0206",			
"0207",			
"0208")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0052"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0201"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0202"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0203"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0204"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0205"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0206"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0207"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0208"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050", 
              sum("0052") AS "0052",
              sum("0134") AS "0134", 
              sum("0201") AS "0201",
              sum("0202") AS "0202", 
              sum("0203") AS "0203", 
              sum("0204") AS "0204", 
              sum("0205") AS "0205",
              sum("0206") AS "0206", 
              sum("0207") AS "0207", 
              sum("0208") AS "0208"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuangral2007, "../../data/18.SAN_JUAN/sjuan_dip_gral2007.csv")

```
#### SAN LUIS


```{sql sluisgral2007, connection=Arg07,  output.var="sluisgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0037",		
"0050",	
"0171",	
"0333",	
"0334",		
"0335",	
"0336")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0171"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0333"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0334"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0335"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0336"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0037") AS "0037", 
              sum("0050") AS "0050", 
              sum("0171") AS "0171", 
              sum("0333") AS "0333",
              sum("0334") AS "0334", 
              sum("0335") AS "0335",
              sum("0336") AS "0336"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluisgral2007, "../../data/19.SAN_LUIS/sluis_dip_gral2007.csv")

```
#### SANTA CRUZ


```{sql scruzgral2007, connection=Arg07,  output.var="scruzgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0445",	
"0447",	
"0448")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0445"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0447"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0448"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0445") AS "0445", 
              sum("0447") AS "0447", 
              sum("0448") AS "0448"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruzgral2007, "../../data/20.SANTA_CRUZ/scruz_dip_gral2007.csv")

```
#### SANTA FE


```{sql sfegral2007, connection=Arg07,  output.var="sfegral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0009",	
"0014",	
"0019",	
"0020",		
"0026",	
"0030",	
"0036",	
"0037",	 	
"0038",			
"0044",			
"0045",			
"0050",			
"0132",
"0134",		
"0136",	
"0154",	
"0189",	
"0190",	 	
"0191",			
"0192")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0009"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0019"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0026"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0189"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0190"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0191"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0192"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0009") AS "0009", 
              sum("0014") AS "0014", 
              sum("0019") AS "0019",
              sum("0020") AS "0020", 
              sum("0026") AS "0026",
              sum("0030") AS "0030", 
              sum("0036") AS "0036", 
              sum("0037") AS "0037", 
              sum("0038") AS "0038",
              sum("0044") AS "0044", 
              sum("0045") AS "0045", 
              sum("0050") AS "0050", 
              sum("0132") AS "0132",
              sum("0134") AS "0134", 
              sum("0136") AS "0136",
              sum("0154") AS "0154", 
              sum("0189") AS "0189", 
              sum("0190") AS "0190", 
              sum("0191") AS "0191",
              sum("0192") AS "0192"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfegral2007, "../../data/21.SANTA_FE/sfe_dip_gral2007.csv")

```
#### SANTIAGO DEL ESTERO


```{sql sdegral2007, connection=Arg07,  output.var="sdegral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0005",	
"0012",	
"0014",	
"0017",		
"0038",	
"0050",	
"0056",	
"0057",	 	
"0060",			
"0175",			
"0187",			
"0209",			
"0210",
"0211",		
"0212",	
"0213",	
"0442")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0017"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0057"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0175"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0209"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0210"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0211"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0212"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0213"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0442"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0005") AS "0005", 
              sum("0012") AS "0012", 
              sum("0014") AS "0014",
              sum("0017") AS "0017", 
              sum("0038") AS "0038",
              sum("0050") AS "0050", 
              sum("0056") AS "0056", 
              sum("0057") AS "0057", 
              sum("0060") AS "0060",
              sum("0175") AS "0175", 
              sum("0187") AS "0187", 
              sum("0209") AS "0209", 
              sum("0210") AS "0210",
              sum("0211") AS "0211", 
              sum("0212") AS "0212",
              sum("0213") AS "0213", 
              sum("0442") AS "0442"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sdegral2007, "../../data/22.SANTIAGO_DEL_ESTERO/santiago_dip_gral2007.csv")

```
#### TUCUMAN


```{sql tucumangral2007, connection=Arg07,  output.var="tucumangral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0014",	
"0022",	
"0038",	
"0045",		
"0048",	
"0050",	
"0060",	
"0131",	 	
"0134",			
"0193",			
"0194",			
"0195",			
"0196")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0193"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0195"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0196"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0014") AS "0014", 
              sum("0022") AS "0022", 
              sum("0038") AS "0038",
              sum("0045") AS "0045", 
              sum("0048") AS "0048",
              sum("0050") AS "0050", 
              sum("0060") AS "0060", 
              sum("0131") AS "0131", 
              sum("0134") AS "0134",
              sum("0193") AS "0193", 
              sum("0194") AS "0194", 
              sum("0195") AS "0195", 
              sum("0196") AS "0196"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucumangral2007, "../../data/23.TUCUMAN/tucuman_dip_gral2007.csv")

```
#### TIERRA DEL FUEGO



```{sql tdfgral2007, connection=Arg07,  output.var="tdfgral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0005",	
"0022",	
"0047",	
"0050",		
"0052",	
"0055",	
"0187",	
"0245",	 	
"0249",			
"0250",			
"0436",			
"0437",			
"0438")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0052"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0055"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0245"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0249"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0250"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0436"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0437"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0438"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0005") AS "0005", 
              sum("0022") AS "0022", 
              sum("0047") AS "0047",
              sum("0050") AS "0050", 
              sum("0052") AS "0052",
              sum("0055") AS "0055", 
              sum("0187") AS "0187", 
              sum("0245") AS "0245", 
              sum("0249") AS "0249",
              sum("0250") AS "0250", 
              sum("0436") AS "0436", 
              sum("0437") AS "0437", 
              sum("0438") AS "0438"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdfgral2007, "../../data/24.TIERRA_DEL_FUEGO/tdf_dip_gral2007.csv")

```










### 2009

#### CABA



```{sql cabagral2009, connection=Arg09,  output.var="cabagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0014",	
"0037",	
"0038",	
"0050",	 	
"0127",			
"0131",			
"0133",	 	
"0146",			
"0136",			
"0146",
"0149",		
"0150",	
"0151",	
"0152",	
"0153",	 	
"0154",			
"0156",			
"0157",			
"0158",			
"0507",
"0545",		
"0548",	
"0549",	
"0588",	
"0589")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0127"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0146"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0146"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0149"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0150"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0151"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0152"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0156"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0157"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0158"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0548"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0549"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0588"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0589"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0014") AS "0014", 
              sum("0037") AS "0037", 
              sum("0038") AS "0038",
              sum("0050") AS "0050", 
              sum("0127") AS "0127",
              sum("0131") AS "0131", 
              sum("0133") AS "0133", 
              sum("0146") AS "0146", 
              sum("0136") AS "0136",
              sum("0146") AS "0146", 
              sum("0149") AS "0149", 
              sum("0150") AS "0150", 
              sum("0151") AS "0151",
              sum("0152") AS "0152", 
              sum("0153") AS "0153",
              sum("0154") AS "0154", 
              sum("0156") AS "0156", 
              sum("0157") AS "0157", 
              sum("0158") AS "0158",
              sum("0507") AS "0507", 
              sum("0545") AS "0545", 
              sum("0548") AS "0548", 
              sum("0549") AS "0549",
              sum("0588") AS "0588", 
              sum("0589") AS "0589"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cabagral2009, "../../data/1.CABA/caba_dip_gral2009.csv")

```


#### PBA



```{sql pbagral2009, connection=Arg09,  output.var="pbagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0037",	
"0051",	
"0100",	
"0148",		
"0185",	
"0186",	
"0187",	
"0188",	 	
"0189",			
"0190",			
"0191",			
"0192",			
"0241",
"0294",		
"0295",	
"0531",	
"0533",	
"0546",	 	
"0585")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0100"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0148"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0185"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0189"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0190"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0191"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0192"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0241"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0294"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0295"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0531"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0533"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0585"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0037") AS "0037", 
              sum("0051") AS "0051", 
              sum("0100") AS "0100",
              sum("0148") AS "0148", 
              sum("0185") AS "0185",
              sum("0186") AS "0186", 
              sum("0187") AS "0187", 
              sum("0188") AS "0188", 
              sum("0189") AS "0189",
              sum("0190") AS "0190", 
              sum("0191") AS "0191", 
              sum("0192") AS "0192", 
              sum("0241") AS "0241",
              sum("0294") AS "0294", 
              sum("0295") AS "0295",
              sum("0531") AS "0531", 
              sum("0533") AS "0533", 
              sum("0546") AS "0546", 
              sum("0585") AS "0585"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pbagral2009, "../../data/../../data/data/02.PBA/pba_dip_gral2009.csv")

```


#### CATAMARCA



```{sql catamarcagral2009, connection=Arg09,  output.var="catamarcagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0036",	
"0501",	
"0504",	
"0523",		
"0537")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0523"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0537"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0036") AS "0036", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0523") AS "0523", 
              sum("0537") AS "0537"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarcagral2009, "../../data/3.CATAMARCA/catamarca_dip_gral2009.csv")

```



#### CORDOBA



```{sql cordobagral2009, connection=Arg09,  output.var="cordobagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0002",	
"0003",	
"0005",	
"0014",		
"0038",	
"0041",	
"0042",	
"0048",	
"0057",	 	
"0128",			
"0139",			
"0141",			
"0142",			
"0144",
"0145",		
"0147",	
"0148",	
"0161",	
"0507",	 	
"0564",			
"0565",			
"0566")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0041"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0042"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0057"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0128"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0139"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0141"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0142"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0144"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0145"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0147"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0148"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0161"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0564"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0565"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0566"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0005") AS "0005",
              sum("0014") AS "0014", 
              sum("0038") AS "0038",
              sum("0041") AS "0041", 
              sum("0042") AS "0042", 
              sum("0048") AS "0048", 
              sum("0057") AS "0057",
              sum("0128") AS "0128", 
              sum("0139") AS "0139", 
              sum("0141") AS "0141", 
              sum("0142") AS "0142",
              sum("0144") AS "0144", 
              sum("0145") AS "0145",
              sum("0147") AS "0147", 
              sum("0148") AS "0148", 
              sum("0161") AS "0161", 
              sum("0507") AS "0507",
              sum("0564") AS "0564", 
              sum("0565") AS "0565", 
              sum("0566") AS "0566"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordobagral2009, "../../data/4.CORDOBA/cordoba_dip_gral2009.csv")

```



#### CORRIENTES


```{sql corrientesgral2009, connection=Arg09,  output.var="corrientesgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0002",	
"0003",	
"0005",	
"0006",		
"0008",	
"0009",	
"0012",	
"0019",	 	
"0020",			
"0033",			
"0036",			
"0040",			
"0044",			
"0047",
"0048",		
"0050",	
"0056",	
"0120",	
"0289",	 	
"0290",			
"0291",			
"0292",			
"0293",			
"0543",
"0545",			
"0586",			
"0587")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0009"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0019"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0120"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0289"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0290"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0291"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0292"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0293"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0543"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0586"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0587"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0005") AS "0005",
              sum("0006") AS "0006", 
              sum("0008") AS "0008",
              sum("0009") AS "0009", 
              sum("0012") AS "0012", 
              sum("0019") AS "0019", 
              sum("0020") AS "0020",
              sum("0033") AS "0033", 
              sum("0036") AS "0036", 
              sum("0040") AS "0040", 
              sum("0044") AS "0044",
              sum("0047") AS "0047", 
              sum("0048") AS "0048",
              sum("0050") AS "0050", 
              sum("0056") AS "0056", 
              sum("0120") AS "0120", 
              sum("0289") AS "0289",
              sum("0290") AS "0290", 
              sum("0291") AS "0291", 
              sum("0292") AS "0292", 
              sum("0293") AS "0293",
              sum("0543") AS "0543", 
              sum("0545") AS "0545",
              sum("0586") AS "0586",
              sum("0587") AS "0587"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(corrientesgral2009, "../../data/05.CORRIENTES/corrientes_dip_gral2009.csv")

```
#### CHACO


```{sql chacogral2009, connection=Arg09,  output.var="chacogral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0012",		
"0014",	
"0051",	
"0118",	
"0506",		
"0511",	
"0522")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0118"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0506"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0511"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0012") AS "0012", 
              sum("0014") AS "0014", 
              sum("0051") AS "0051", 
              sum("0118") AS "0118",
              sum("0506") AS "0506", 
              sum("0511") AS "0511",
              sum("0522") AS "0522"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chacogral2009, "../../data/06.CHACO/chaco_dip_gral2009.csv")

```
#### CHUBUT


```{sql chubutgral2009, connection=Arg09,  output.var="chubutgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0038",	
"0047",	
"0105",	
"0109",		
"0513",	
"0529")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0105"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0109"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0513"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0529"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0038") AS "0038", 
              sum("0047") AS "0047", 
              sum("0105") AS "0105",
              sum("0109") AS "0109", 
              sum("0513") AS "0513",
              sum("0529") AS "0529"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubutgral2009, "../../data/07.CHUBUT/chubut_dip_gral2009.csv")

```
#### ENTRE RIOS


```{sql eriosgral2009, connection=Arg09,  output.var="eriosgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0050",	
"0051",	
"0116",	
"0121",		
"0508",	
"0536",	
"0539",	
"0555",	
"0560")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0116"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0121"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0508"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0536"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0539"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0555"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0560"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0050") AS "0050", 
              sum("0051") AS "0051", 
              sum("0116") AS "0116",
              sum("0121") AS "0121", 
              sum("0508") AS "0508",
              sum("0536") AS "0536", 
              sum("0539") AS "0539", 
              sum("0555") AS "0555", 
              sum("0560") AS "0560"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(eriosgral2009, "../../data/08.ENTRE_RIOS/erios_dip_gral2009.csv")

```
#### FORMOSA


```{sql formosagral2009, connection=Arg09,  output.var="formosagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0501",		
"0548")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0548"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '09'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0501") AS "0501", 
              sum("0548") AS "0548"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosagral2009, "../../data/09.FORMOSA/formosa_dip_gral2009.csv")

```
#### JUJUY


```{sql jujuygral2009, connection=Arg09,  output.var="jujuygral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0038",	
"0045",	
"0501",	
"0536",		
"0569",	
"0570",	
"0571")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0536"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0569"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0570"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0571"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0045") AS "0045", 
              sum("0501") AS "0501",
              sum("0536") AS "0536", 
              sum("0569") AS "0569",
              sum("0570") AS "0570", 
              sum("0571") AS "0571"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuygral2009, "../../data/10.JUJUY/jujuy_dip_gral2009.csv")

```
#### LA PAMPA


```{sql pampagral2009, connection=Arg09,  output.var="pampagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0101",	
"0126",	
"0135",	
"0507",		
"0521",	
"0538")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0101"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0126"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0521"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0538"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0101") AS "0101", 
              sum("0126") AS "0126", 
              sum("0135") AS "0135",
              sum("0507") AS "0507", 
              sum("0521") AS "0521",
              sum("0538") AS "0538"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampagral2009, "../../data/11.LA_PAMPA/pampa_dip_gral2009.csv")

```
#### LA RIOJA


```{sql riojagral2009, connection=Arg09,  output.var="riojagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0111",	
"0503",	
"0532",	
"0542",		
"0553",		
"0556")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0111"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0532"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0542"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0553"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0556"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '12'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0111") AS "0111", 
              sum("0503") AS "0503", 
              sum("0532") AS "0532",
              sum("0542") AS "0542", 
              sum("0553") AS "0553", 
              sum("0556") AS "0556"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(riojagral2009, "../../data/12.LA_RIOJA/rioja_dip_gral2009.csv")

```
#### MENDOZA


```{sql mendozagral2009, connection=Arg09,  output.var="mendozagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0006",	
"0008",	
"0014",
"0038",	
"0045",		
"0050",	
"0165",	
"0166",	
"0167",	 	
"0168",			
"0169",			
"0501",			
"0572",			
"0573",
"0574",		
"0575")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0165"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0166"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0167"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0168"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0169"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0572"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0573"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0574"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0575"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0006") AS "0006", 
              sum("0008") AS "0008", 
              sum("0014") AS "0014",
              sum("0038") AS "0038", 
              sum("0045") AS "0045",
              sum("0050") AS "0050", 
              sum("0165") AS "0165", 
              sum("0166") AS "0166", 
              sum("0167") AS "0167",
              sum("0168") AS "0168", 
              sum("0169") AS "0169", 
              sum("0501") AS "0501", 
              sum("0572") AS "0572",
              sum("0573") AS "0573", 
              sum("0574") AS "0574",
              sum("0575") AS "0575"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendozagral2009, "../../data/13.MENDOZA/mendoza_dip_gral2009.csv")

```
#### MISIONES


```{sql misionesgral2009, connection=Arg09,  output.var="misionesgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0012",	
"0020",	
"0050",	
"0107",		
"0505",	
"0525",	
"0540",	
"0550")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0107"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0525"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0540"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0550"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '14'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0012") AS "0012", 
              sum("0020") AS "0020", 
              sum("0050") AS "0050",
              sum("0107") AS "0107", 
              sum("0505") AS "0505",
              sum("0525") AS "0525", 
              sum("0540") AS "0540", 
              sum("0550") AS "0550"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misionesgral2009, "../../data/14.MISIONES/misiones_dip_gral2009.csv")

```
#### NEUQUEN


```{sql neuquengral2009, connection=Arg09,  output.var="neuquengral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0040",			
"0045",	
"0102",	
"0501",		
"0509",	
"0528",	
"0541",	
"0547")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0102"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0509"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0528"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0541"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0547"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0040") AS "0040", 
              sum("0045") AS "0045",
              sum("0102") AS "0102", 
              sum("0501") AS "0501",
              sum("0509") AS "0509", 
              sum("0528") AS "0528", 
              sum("0541") AS "0541", 
              sum("0547") AS "0547"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquengral2009, "../../data/15.NEUQUEN/neuquen_dip_gral2009.csv")

```
#### RIO NEGRO


```{sql rnegrogral2009, connection=Arg09,  output.var="rnegrogral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0012",	
"0014",	
"0022",	
"0047",		
"0050",	
"0502")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0012") AS "0012", 
              sum("0014") AS "0014", 
              sum("0022") AS "0022",
              sum("0047") AS "0047", 
              sum("0050") AS "0050",
              sum("0502") AS "0502"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegrogral2009, "../../data/16.RIO_NEGRO/rnegro_dip_gral2009.csv")

```
#### SALTA


```{sql saltagral2009, connection=Arg09,  output.var="saltagral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0005",	
"0040",	
"0041",	
"0104",		
"0138",	
"0140",	
"0143",	
"0501",	 	
"0514",			
"0520",			
"0548",			
"0552")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0041"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0104"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0140"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0143"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0520"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0548"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0552"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0005") AS "0005", 
              sum("0040") AS "0040", 
              sum("0041") AS "0041",
              sum("0104") AS "0104", 
              sum("0138") AS "0138",
              sum("0140") AS "0140", 
              sum("0143") AS "0143", 
              sum("0501") AS "0501", 
              sum("0514") AS "0514",
              sum("0520") AS "0520", 
              sum("0548") AS "0548", 
              sum("0552") AS "0552"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(saltagral2009, "../../data/17.SALTA/salta_dip_gral2009.csv")

```
#### SAN JUAN


```{sql sjuangral2009, connection=Arg09,  output.var="sjuangral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0115",	
"0117",	
"0501",	
"0526",		
"0535",			
"0548")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0115"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0117"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0526"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0535"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0548"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0115") AS "0115", 
              sum("0117") AS "0117", 
              sum("0501") AS "0501",
              sum("0526") AS "0526", 
              sum("0535") AS "0535",
              sum("0548") AS "0548"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuangral2009, "../../data/18.SAN_JUAN/sjuan_dip_gral2009.csv")

```
#### SAN LUIS


```{sql sluisgral2009, connection=Arg09,  output.var="sluisgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0516",	
"0530",	
"0544",	
"0548",		
"0554",	
"0557")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0516"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0530"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0544"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0548"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0554"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0557"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0516") AS "0516", 
              sum("0530") AS "0530", 
              sum("0544") AS "0544",
              sum("0548") AS "0548", 
              sum("0554") AS "0554",
              sum("0557") AS "0557"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluisgral2009, "../../data/19.SAN_LUIS/sluis_dip_gral2009.csv")

```
#### SANTA CRUZ


```{sql scruzgral2009, connection=Arg09,  output.var="scruzgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0106",	
"0113",	
"0515",	
"0534")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0106"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0113"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0515"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0534"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0106") AS "0106", 
              sum("0113") AS "0113", 
              sum("0515") AS "0515", 
              sum("0534") AS "0534"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruzgral2009, "../../data/20.SANTA_CRUZ/scruz_dip_gral2009.csv")

```
#### SANTA FE


```{sql sfegral2009, connection=Arg09,  output.var="sfegral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0030",	
"0033",	
"0036",	
"0037",		
"0038",	
"0042",	
"0045",	
"0122",	 	
"0123",			
"0127",			
"0512",			
"0524",			
"0534")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0042"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0122"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0123"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0127"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0512"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0524"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0534"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0030") AS "0030", 
              sum("0033") AS "0033", 
              sum("0036") AS "0036",
              sum("0037") AS "0037", 
              sum("0038") AS "0038",
              sum("0042") AS "0042", 
              sum("0045") AS "0045", 
              sum("0122") AS "0122", 
              sum("0123") AS "0123",
              sum("0127") AS "0127", 
              sum("0512") AS "0512", 
              sum("0524") AS "0524", 
              sum("0534") AS "0534"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfegral2009, "../../data/21.SANTA_FE/sfe_dip_gral2009.csv")

```
#### SANTIAGO DEL ESTERO


```{sql sdegral2009, connection=Arg09,  output.var="sdegral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0014",	
"0038",	
"0050",	
"0056",		
"0120",	
"0517",	
"0533",	
"0562",	 	
"0568")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0120"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0533"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0562"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0568"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0050") AS "0050",
              sum("0056") AS "0056", 
              sum("0120") AS "0120",
              sum("0517") AS "0517", 
              sum("0533") AS "0533", 
              sum("0562") AS "0562", 
              sum("0568") AS "0568"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sdegral2009, "../../data/22.SANTIAGO_DEL_ESTERO/santiago_dip_gral2009.csv")

```
#### TUCUMAN


```{sql tucumangral2009, connection=Arg09,  output.var="tucumangral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0014",	
"0022",	
"0040",			
"0045",	
"0112",		
"0119",	
"0124",	
"0130",	
"0501",	 	
"0527",			
"0536",			
"0563")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0112"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0119"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0124"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0130"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0527"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0536"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0563"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0014") AS "0014", 
              sum("0022") AS "0022", 
              sum("0040") AS "0040",
              sum("0045") AS "0045", 
              sum("0112") AS "0112",
              sum("0119") AS "0119", 
              sum("0124") AS "0124", 
              sum("0130") AS "0130", 
              sum("0501") AS "0501",
              sum("0527") AS "0527", 
              sum("0536") AS "0536", 
              sum("0563") AS "0563"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucumangral2009, "../../data/23.TUCUMAN/tucuman_dip_gral2009.csv")

```
#### TIERRA DEL FUEGO



```{sql tdfgral2009, connection=Arg09,  output.var="tdfgral2009"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0006",	
"0022",	
"0108",		
"0114",	
"0120",	
"0129",	
"0131",	 	
"0132",			
"0134",			
"0510")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0108"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0114"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0120"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0129"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0006") AS "0006", 
              sum("0022") AS "0022",
              sum("0108") AS "0108", 
              sum("0114") AS "0114",
              sum("0120") AS "0120", 
              sum("0129") AS "0129", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0134") AS "0134", 
              sum("0510") AS "0510"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdfgral2009, "../../data/24.TIERRA_DEL_FUEGO/tdf_dip_gral2009.csv")

```















### 2011


#### PASO

##### CABA 

```{sql caba_dip_paso2011, connection=Arg11P,  output.var="caba_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0036",	
"0179",	
"0302",	
"0501",	 	
"0504",			
"0508",		
"0509",	
"0510",	
"0517",	
"0518",	 	
"0536")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0179"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0302"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0508"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0509"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0518"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0536"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0036") AS "0036", 
              sum("0179") AS "0179", 
              sum("0302") AS "0302",
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0508") AS "0508", 
              sum("0509") AS "0509", 
              sum("0510") AS "0510", 
              sum("0517") AS "0517",
              sum("0518") AS "0518", 
              sum("0536") AS "0536"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(caba_dip_paso2011, "../../data/01.CABA/caba_dip_paso2011.csv")

```

-
##### PBA 

```{sql pba_dip_paso2011, connection=Arg11P,  output.var="pba_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0037",		
"0047",	
"0131",	
"0132",	
"0133",	 	
"0134",			
"0135",		
"0136",	
"0137",	
"0267",	
"0268",	 	
"0272",	 	
"0276")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0267"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0268"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0272"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0276"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0037") AS "0037", 
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0133") AS "0133", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0136") AS "0136", 
              sum("0137") AS "0137", 
              sum("0267") AS "0267",
              sum("0268") AS "0268", 
              sum("0272") AS "0272", 
              sum("0276") AS "0276"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_dip_paso2011, "../../data/02.PBA/pba_dip_paso2011.csv")

```

-
##### CATAMARCA 

```{sql catamarca_dip_paso2011, connection=Arg11P,  output.var="catamarca_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0014",	
"0038",	
"0047",	
"0501",	 	
"0502",			
"0535",		
"0537")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0535"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0537"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0047") AS "0047",
              sum("0501") AS "0501", 
              sum("0502") AS "0502",
              sum("0535") AS "0535", 
              sum("0537") AS "0537"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarca_dip_paso2011, "../../data/03.CATAMARCA/catamarca_dip_paso2011.csv")

```

-
##### CORDOBA 

```{sql cordoba_dip_paso2011, connection=Arg11P,  output.var="cordoba_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0022",	
"0037",	
"0047",	
"0057",	 	
"0501",			
"0503",		
"0506",	
"0507",	
"0511",	
"0517")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0057"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0506"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0511"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0022") AS "0022", 
              sum("0037") AS "0037", 
              sum("0047") AS "0047",
              sum("0057") AS "0057", 
              sum("0501") AS "0501",
              sum("0503") AS "0503", 
              sum("0506") AS "0506", 
              sum("0507") AS "0507", 
              sum("0511") AS "0511",
              sum("0517") AS "0517"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordoba_dip_paso2011, "../../data/04.CORDOBA/cordoba_dip_paso2011.csv")

```

-
##### CORRIENTES 

```{sql Corrientes_dip_paso2011, connection=Arg11P,  output.var="Corrientes_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0047",		
"0134",	
"0137",	
"0501",	
"0505",	 	
"0532")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0532"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0047") AS "0047", 
              sum("0134") AS "0134", 
              sum("0137") AS "0137", 
              sum("0501") AS "0501",
              sum("0505") AS "0505", 
              sum("0532") AS "0532"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(Corrientes_dip_paso2011, "../../data/05.CORRIENTES/corrientes_dip_paso2011.csv")

```


-
##### CHACO 

```{sql chaco_dip_paso2011, connection=Arg11P,  output.var="chaco_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0033",		
"0047",	
"0060",	
"0131",	
"0134",	 	
"0156",			
"0176",		
"0504")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0156"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0176"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0033") AS "0033", 
              sum("0047") AS "0047", 
              sum("0060") AS "0060", 
              sum("0131") AS "0131",
              sum("0134") AS "0134", 
              sum("0156") AS "0156",
              sum("0176") AS "0176", 
              sum("0504") AS "0504"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chaco_dip_paso2011, "../../data/06.CHACO/chaco_dip_paso2011.csv")

```

-
##### CHUBUT 

```{sql chubut_dip_paso2011, connection=Arg11P,  output.var="chubut_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0038",	
"0047",	
"0060",	
"0151",	 	
"0157",			
"0501")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0151"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0157"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0038") AS "0038", 
              sum("0047") AS "0047", 
              sum("0060") AS "0060",
              sum("0151") AS "0151", 
              sum("0157") AS "0157",
              sum("0501") AS "0501"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubut_dip_paso2011, "../../data/07.CHUBUT/chubut_dip_paso2011.csv")

```

-
##### ENTRE RIOS 

```{sql erios_dip_paso2011, connection=Arg11P,  output.var="erios_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0050",	
"0068",	
"0158",	
"0177",	 	
"0198",			
"0501",		
"0505")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0158"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0177"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0198"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0050") AS "0050", 
              sum("0068") AS "0068", 
              sum("0158") AS "0158",
              sum("0177") AS "0177", 
              sum("0198") AS "0198",
              sum("0501") AS "0501", 
              sum("0505") AS "0505"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(erios_dip_paso2011, "../../data/08.ENTRE_RIOS/erios_dip_paso2011.csv")

```

-
##### FORMOSA 

```{sql formosa_dip_paso2011, connection=Arg11P,  output.var="formosa_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0036",	
"0167",	
"0181",	 	
"0193",			
"0501")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0167"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0181"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0193"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0036") AS "0036", 
              sum("0167") AS "0167",
              sum("0181") AS "0181", 
              sum("0193") AS "0193",
              sum("0501") AS "0501"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_dip_paso2011, "../../data/09.FORMOSA/formosa_dip_paso2011.csv")

```

-
##### JUJUY 

```{sql jujuy_dip_paso2011, connection=Arg11P,  output.var="jujuy_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0063",	
"0068",	
"0501",	
"0504",	 	
"0510",			
"0517",		
"0525")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0525"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0063") AS "0063", 
              sum("0068") AS "0068", 
              sum("0501") AS "0501",
              sum("0504") AS "0504", 
              sum("0510") AS "0510",
              sum("0517") AS "0517", 
              sum("0525") AS "0525"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_dip_paso2011, "../../data/10.JUJUY/jujuy_dip_paso2011.csv")

```

-
##### LA PAMPA 

```{sql pampa_dip_paso2011, connection=Arg11P,  output.var="pampa_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0022",	
"0030",	
"0045",	
"0047",	 	
"0133",			
"0513")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0513"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0022") AS "0022", 
              sum("0030") AS "0030", 
              sum("0045") AS "0045",
              sum("0047") AS "0047", 
              sum("0133") AS "0133",
              sum("0513") AS "0513"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampa_dip_paso2011, "../../data/11.LA_PAMPA/pampa_dip_paso2011.csv")

```


-
##### LA RIOJA 

```{sql rioja_dip_paso2011, connection=Arg11P,  output.var="rioja_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0038",	
"0047",	
"0050",	
"0061",	 	
"0064",			
"0160",		
"0515",	
"0523")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0064"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0160"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0515"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0523"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0038") AS "0038", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050",
              sum("0061") AS "0061", 
              sum("0064") AS "0064",
              sum("0160") AS "0160", 
              sum("0515") AS "0515", 
              sum("0523") AS "0523"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_dip_paso2011, "../../data/12.LA_RIOJA/rioja_dip_paso2011.csv")

```

-
##### MENDOZA 

```{sql mendoza_dip_paso2011, connection=Arg11P,  output.var="mendoza_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0023",	
"0047",	
"0050",	
"0068",	 	
"0211",			
"0501",		
"0511",	
"0520")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0211"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0511"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0520"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0023") AS "0023", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050",
              sum("0068") AS "0068", 
              sum("0211") AS "0211",
              sum("0501") AS "0501", 
              sum("0511") AS "0511", 
              sum("0520") AS "0520"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendoza_dip_paso2011, "../../data/13.MENDOZA/mendoza_dip_paso2011.csv")

```

-
##### MISIONES 

```{sql misiones_dip_paso2011, connection=Arg11P,  output.var="misiones_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0050",	
"0166",	
"0501",	
"0509",	 	
"0530",			
"0533")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0166"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0509"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0530"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0533"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '14'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0050") AS "0050", 
              sum("0166") AS "0166", 
              sum("0501") AS "0501",
              sum("0509") AS "0509", 
              sum("0530") AS "0530",
              sum("0533") AS "0533"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_dip_paso2011, "../../data/14.MISIONES/misiones_dip_paso2011.csv")

```

-
##### NEUQUEN 

```{sql neuquen_dip_paso2011, connection=Arg11P,  output.var="neuquen_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0023",	
"0047",	
"0061",	
"0068",	 	
"0152",			
"0501",		
"0510")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0152"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0023") AS "0023", 
              sum("0047") AS "0047", 
              sum("0061") AS "0061",
              sum("0068") AS "0068", 
              sum("0152") AS "0152",
              sum("0501") AS "0501", 
              sum("0510") AS "0510"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquen_dip_paso2011, "../../data/15.NEUQUEN/neuquen_dip_paso2011.csv")

```


-
##### RIO NEGRO 

```{sql rnegro_dip_paso2011, connection=Arg11P,  output.var="rnegro_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0047",	
"0050",	
"0155",	 	
"0501")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0155"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050",
              sum("0155") AS "0155", 
              sum("0501") AS "0501"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegro_dip_paso2011, "../../data/16.RIO_NEGRO/rnegro_dip_paso2011.csv")

```

-
##### SALTA 

```{sql salta_dip_paso2011, connection=Arg11P,  output.var="salta_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0038",	
"0047",	
"0060",	
"0501",	 	
"0504",			
"0510",		
"0516")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0516"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0047") AS "0047", 
              sum("0060") AS "0060",
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0510") AS "0510", 
              sum("0516") AS "0516"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(salta_dip_paso2011, "../../data/17.SALTA/salta_dip_paso2011.csv")

```

-
##### SAN JUAN 

```{sql sjuan_dip_paso2011, connection=Arg11P,  output.var="sjuan_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0061",	
"0131",	
"0132",	
"0133",	 	
"0153",			
"0168")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0168"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0061") AS "0061", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0133") AS "0133", 
              sum("0153") AS "0153",
              sum("0168") AS "0168"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_dip_paso2011, "../../data/18.SAN_JUAN/sjuan_dip_paso2011.csv")

```

-
##### SAN LUIS 

```{sql sluis_dip_paso2011, connection=Arg11P,  output.var="sluis_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0038",	
"0050",	
"0183",	
"0501",	 	
"0509")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0183"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0509"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0038") AS "0038", 
              sum("0050") AS "0050", 
              sum("0183") AS "0183",
              sum("0501") AS "0501", 
              sum("0509") AS "0509"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_dip_paso2011, "../../data/19.SAN_LUIS/sluis_dip_paso2011.csv")

```



-
##### SANTA CRUZ 

```{sql scruz_dip_paso2011, connection=Arg11P,  output.var="scruz_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0047",	
"0050",	
"0522")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050",
              sum("0522") AS "0522"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_dip_paso2011, "../../data/20.SANTA_CRUZ/scruz_dip_paso2011.csv")

```

-
##### SANTA FE 

```{sql sfe_dip_paso2011, connection=Arg11P,  output.var="sfe_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0005",	
"0033",	
"0036",	
"0037",	 	
"0047",			
"0064",		
"0065",	
"0131",	 	
"0133",	
"0134",	
"0136",	 	
"0186",	
"0191",	
"0196")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0064"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0065"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0191"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0196"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0005") AS "0005", 
              sum("0033") AS "0033", 
              sum("0036") AS "0036",
              sum("0037") AS "0037", 
              sum("0047") AS "0047",
              sum("0064") AS "0064", 
              sum("0065") AS "0065", 
              sum("0131") AS "0131", 
              sum("0133") AS "0133",
              sum("0134") AS "0134", 
              sum("0136") AS "0136", 
              sum("0186") AS "0186",
              sum("0191") AS "0191", 
              sum("0196") AS "0196"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe_dip_paso2011, "../../data/21.SANTA_FE//sfe_dip_paso2011.csv")

```
-
##### SANTIAGO DEL ESTERO  

```{sql santiago_dip_paso2011, connection=Arg11P,  output.var="santiago_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0040",	
"0061",	
"0501",	
"0505",	 	
"0511",			
"0521")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0511"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0521"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0040") AS "0040", 
              sum("0061") AS "0061", 
              sum("0501") AS "0501",
              sum("0505") AS "0505", 
              sum("0511") AS "0511",
              sum("0521") AS "0521"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(santiago_dip_paso2011, "../../data/22.SANTIAGO_DEL_ESTERO/santiago_dip_paso2011.csv")

```

-
##### TUCUMAN 

```{sql tucuman_dip_paso2011, connection=Arg11P,  output.var="tucuman_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0060",	
"0136",	
"0184",	
"0185",	 	
"0190",			
"0192",		
"0194",	
"0501",	
"0510",	
"0517")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0184"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0185"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0190"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0192"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0060") AS "0060", 
              sum("0136") AS "0136", 
              sum("0184") AS "0184",
              sum("0185") AS "0185", 
              sum("0190") AS "0190",
              sum("0192") AS "0192", 
              sum("0194") AS "0194", 
              sum("0501") AS "0501", 
              sum("0510") AS "0510",
              sum("0517") AS "0517"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucuman_dip_paso2011, "../../data/23.TUCUMAN/tucuman_dip_paso2011.csv")

```

-
##### TIERRA DEL FUEGO 

```{sql tdf_dip_paso2011, connection=Arg11P,  output.var="tdf_dip_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0023",	
"0047",	
"0064",	 	
"0154",			
"0174",		
"0187",	
"0188",	
"0501")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0064"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0023") AS "0023", 
              sum("0047") AS "0047",
              sum("0064") AS "0064", 
              sum("0154") AS "0154",
              sum("0174") AS "0174", 
              sum("0187") AS "0187", 
              sum("0188") AS "0188", 
              sum("0501") AS "0501"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdf_dip_paso2011, "../../data/24.TIERRA_DEL_FUEGO/tdf_dip_paso2011.csv")

```










#### GENERAL

##### CABA 

```{sql caba_dip_gral2011, connection=Arg11G,  output.var="caba_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0036",	
"0302",	
"0601",	 	
"0603",			
"0608",		
"0616",	
"0617",	
"0622",	
"0623",	 	
"0625")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0302"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0601"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0603"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0608"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0616"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0617"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0622"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0623"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0625"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0036") AS "0036", 
              sum("0302") AS "0302", 
              sum("0601") AS "0601",
              sum("0603") AS "0603", 
              sum("0608") AS "0608",
              sum("0616") AS "0616", 
              sum("0617") AS "0617", 
              sum("0622") AS "0622", 
              sum("0623") AS "0623",
              sum("0625") AS "0625"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(caba_dip_gral2011, "../../data/01.CABA/caba_dip_gral2011.csv")

```

-
##### PBA 

```{sql pba_dip_gral2011, connection=Arg11G,  output.var="pba_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0047",		
"0131",	
"0132",	
"0133",	
"0134",	 	
"0135",			
"0137")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133",
              sum("0134") AS "0134", 
              sum("0135") AS "0135",
              sum("0137") AS "0137"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_dip_gral2011, "../../data/02.PBA/pba_dip_gral2011.csv")

```

-
##### CATAMARCA 

```{sql catamarca_dip_gral2011, connection=Arg11G,  output.var="catamarca_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0047",	
"0603",	
"0608",	
"0611")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0603"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0608"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0611"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0047") AS "0047", 
              sum("0603") AS "0603", 
              sum("0608") AS "0608",
              sum("0611") AS "0611"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarca_dip_gral2011, "../../data/03.CATAMARCA/catamarca_dip_gral2011.csv")

```

-
##### CORDOBA 

```{sql cordoba_dip_gral2011, connection=Arg11G,  output.var="cordoba_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0047",	
"0131",	
"0132",	
"0132",	 	
"0134",			
"0135")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0132") AS "0132", 
              sum("0134") AS "0134",
              sum("0135") AS "0135"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordoba_dip_gral2011, "../../data/04.CORDOBA/cordoba_dip_gral2011.csv")

```

-
##### CORRIENTES 

```{sql Corrientes_dip_gral2011, connection=Arg11G,  output.var="Corrientes_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0047",		
"0131",	
"0132",	
"0134",	
"0137",	 	
"0619")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0619"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0134") AS "0134",
              sum("0137") AS "0137", 
              sum("0619") AS "0619"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(Corrientes_dip_gral2011, "../../data/05.CORRIENTES/corrientes_dip_gral2011.csv")

```


-
##### CHACO 

```{sql chaco_dip_gral2011, connection=Arg11G,  output.var="chaco_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0047",		
"0131",	
"0134",	
"0137",	
"0176")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0176"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0134") AS "0134", 
              sum("0137") AS "0137",
              sum("0176") AS "0176"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chaco_dip_gral2011, "../../data/06.CHACO/chaco_dip_gral2011.csv")

```

-
##### CHUBUT 

```{sql chubut_dip_gral2011, connection=Arg11G,  output.var="chubut_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0038",	
"0047",	
"0060",	
"0151",	 	
"0603")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0151"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0603"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0038") AS "0038", 
              sum("0047") AS "0047", 
              sum("0060") AS "0060",
              sum("0151") AS "0151", 
              sum("0603") AS "0603"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubut_dip_gral2011, "../../data/07.CHUBUT/chubut_dip_gral2011.csv")

```

-
##### ENTRE RIOS 

```{sql erios_dip_gral2011, connection=Arg11G,  output.var="erios_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0050",	
"0069",	
"0158",	
"0176",	 	
"0186",			
"0626")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0069"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0158"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0176"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0626"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0050") AS "0050", 
              sum("0069") AS "0069", 
              sum("0158") AS "0158",
              sum("0176") AS "0176", 
              sum("0186") AS "0186",
              sum("0626") AS "0626"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(erios_dip_gral2011, "../../data/08.ENTRE_RIOS/erios_dip_gral2011.csv")

```

-
##### FORMOSA 

```{sql formosa_dip_gral2011, connection=Arg11G,  output.var="formosa_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0181",	
"0183",	
"0603")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0181"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0183"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0603"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '09'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0181") AS "0181", 
              sum("0183") AS "0183", 
              sum("0603") AS "0603"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_dip_gral2011, "../../data/09.FORMOSA/formosa_dip_gral2011.csv")

```

-
##### JUJUY 

```{sql jujuy_dip_gral2011, connection=Arg11G,  output.var="jujuy_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0063",	
"0131",	
"0134",	
"0135",	 	
"0137",			
"0614")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0614"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0063") AS "0063", 
              sum("0131") AS "0131", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0137") AS "0137",
              sum("0614") AS "0614"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_dip_gral2011, "../../data/10.JUJUY/jujuy_dip_gral2011.csv")

```

-
##### LA PAMPA 

```{sql pampa_dip_gral2011, connection=Arg11G,  output.var="pampa_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0022",	
"0047",	
"0133",	
"0602")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0602"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0022") AS "0022", 
              sum("0047") AS "0047", 
              sum("0133") AS "0133",
              sum("0602") AS "0602"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampa_dip_gral2011, "../../data/11.LA_PAMPA/pampa_dip_gral2011.csv")

```


-
##### LA RIOJA 

```{sql rioja_dip_gral2011, connection=Arg11G,  output.var="rioja_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0055",	
"0605",	
"0613")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0055"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0605"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0613"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '12'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0055") AS "0055", 
              sum("0605") AS "0605", 
              sum("0613") AS "0613"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_dip_gral2011, "../../data/12.LA_RIOJA/rioja_dip_gral2011.csv")

```

-
##### MENDOZA 

```{sql mendoza_dip_gral2011, connection=Arg11G,  output.var="mendoza_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0023",	
"0047",	
"0050",	
"0211",	 	
"0601",			
"0603",		
"0609")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0211"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0601"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0603"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0609"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0023") AS "0023", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050",
              sum("0211") AS "0211", 
              sum("0601") AS "0601",
              sum("0603") AS "0603", 
              sum("0609") AS "0609"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendoza_dip_gral2011, "../../data/13.MENDOZA/mendoza_dip_gral2011.csv")

```

-
##### MISIONES 

```{sql misiones_dip_gral2011, connection=Arg11G,  output.var="misiones_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0050",	
"0603",	
"0615",	
"0620",	 	
"0621")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0603"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0615"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0620"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0621"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0050") AS "0050", 
              sum("0603") AS "0603", 
              sum("0615") AS "0615",
              sum("0620") AS "0620", 
              sum("0621") AS "0621"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_dip_gral2011, "../../data/14.MISIONES/misiones_dip_gral2011.csv")

```

-
##### NEUQUEN 

```{sql neuquen_dip_gral2011, connection=Arg11G,  output.var="neuquen_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0023",
"0041",
"0061",	
"0068",	
"0131",	 	
"0134",			
"0150")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0041"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0150"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0023") AS "0023", 
              sum("0041") AS "0041", 
              sum("0061") AS "0061",
              sum("0068") AS "0068", 
              sum("0131") AS "0131",
              sum("0134") AS "0134", 
              sum("0150") AS "0150"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquen_dip_gral2011, "../../data/15.NEUQUEN/neuquen_dip_gral2011.csv")

```


-
##### RIO NEGRO 

```{sql rnegro_dip_gral2011, connection=Arg11G,  output.var="rnegro_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0047",	
"0050",	
"0131")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050",
              sum("0131") AS "0131"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegro_dip_gral2011, "../../data/16.RIO_NEGRO/rnegro_dip_gral2011.csv")

```

-
##### SALTA 

```{sql salta_dip_gral2011, connection=Arg11G,  output.var="salta_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0047",	
"0060",	
"0131",	
"0137",	 	
"0606",			
"0608")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0606"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0608"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0047") AS "0047", 
              sum("0060") AS "0060", 
              sum("0131") AS "0131",
              sum("0137") AS "0137", 
              sum("0606") AS "0606",
              sum("0608") AS "0608"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(salta_dip_gral2011, "../../data/17.SALTA/salta_dip_gral2011.csv")

```

-
##### SAN JUAN 

```{sql sjuan_dip_gral2011, connection=Arg11G,  output.var="sjuan_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0131",	
"0132",	
"0133",	
"0168")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0168"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133",
              sum("0168") AS "0168"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_dip_gral2011, "../../data/18.SAN_JUAN/sjuan_dip_gral2011.csv")

```

-
##### SAN LUIS 

```{sql sluis_dip_gral2011, connection=Arg11G,  output.var="sluis_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0131",	
"0133")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0131") AS "0131", 
              sum("0133") AS "0133"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_dip_gral2011, "../../data/19.SAN_LUIS/sluis_dip_gral2011.csv")

```



-
##### SANTA CRUZ 

```{sql scruz_dip_gral2011, connection=Arg11G,  output.var="scruz_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0047",	
"0050",	
"0131",	 	
"0612")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0612"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050",
              sum("0131") AS "0131", 
              sum("0612") AS "0612"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_dip_gral2011, "../../data/20.SANTA_CRUZ/scruz_dip_gral2011.csv")

```

-
##### SANTA FE 

```{sql sfe_dip_gral2011, connection=Arg11G,  output.var="sfe_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0005",	
"0036",	
"0047",	
"0055",	 	
"0131",			
"0133",		
"0134",	
"0178")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0055"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0178"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0005") AS "0005", 
              sum("0036") AS "0036", 
              sum("0047") AS "0047",
              sum("0055") AS "0055", 
              sum("0131") AS "0131",
              sum("0133") AS "0133", 
              sum("0134") AS "0134", 
              sum("0178") AS "0178"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe_dip_gral2011, "../../data/21.SANTA_FE//sfe_dip_gral2011.csv")

```
-
##### SANTIAGO DEL ESTERO  

```{sql santiago_dip_gral2011, connection=Arg11G,  output.var="santiago_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0040",	
"0603",	
"0604",	
"0610")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0603"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0604"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0610"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0040") AS "0040", 
              sum("0603") AS "0603", 
              sum("0604") AS "0604",
              sum("0610") AS "0610"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(santiago_dip_gral2011, "../../data/22.SANTIAGO_DEL_ESTERO/santiago_dip_gral2011.csv")

```

-
##### TUCUMAN 

```{sql tucuman_dip_gral2011, connection=Arg11G,  output.var="tucuman_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0060",	
"0131",	
"0134",	
"0135",	 	
"0177",			
"0185")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0177"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0185"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0060") AS "0060", 
              sum("0131") AS "0131", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0177") AS "0177",
              sum("0185") AS "0185"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucuman_dip_gral2011, "../../data/23.TUCUMAN/tucuman_dip_gral2011.csv")

```

-
##### TIERRA DEL FUEGO 

```{sql tdf_dip_gral2011, connection=Arg11G,  output.var="tdf_dip_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0023",	
"0047",	
"0154",	 	
"0174",			
"0187",		
"0188",	
"0603")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0603"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0023") AS "0023", 
              sum("0047") AS "0047",
              sum("0154") AS "0154", 
              sum("0174") AS "0174",
              sum("0187") AS "0187", 
              sum("0188") AS "0188", 
              sum("0603") AS "0603"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdf_dip_gral2011, "../../data/24.TIERRA_DEL_FUEGO/tdf_dip_gral2011.csv")

```














### 2013


#### PASO

##### CABA 

```{sql caba_dip_paso2013, connection=Arg13P,  output.var="caba_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0068",	
"0187",	
"0234",	
"0262",	 	
"0324",			
"0325",		
"0501",	
"0502",	
"0503",	
"0504",	 	
"0505",	 	
"0506")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0234"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0262"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0324"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0325"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0506"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0068") AS "0068", 
              sum("0187") AS "0187", 
              sum("0234") AS "0234",
              sum("0262") AS "0262", 
              sum("0324") AS "0324",
              sum("0325") AS "0325", 
              sum("0501") AS "0501", 
              sum("0502") AS "0502", 
              sum("0503") AS "0503",
              sum("0504") AS "0504", 
              sum("0505") AS "0505", 
              sum("0506") AS "0506"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(caba_dip_paso2013, "../../data/01.CABA/caba_dip_paso2013.csv")

```

-
##### PBA 

```{sql pba_dip_paso2013, connection=Arg13P,  output.var="pba_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0272",		
"0276",	
"0501",	
"0504",	
"0505",	 	
"0507",			
"0510",		
"0511",	
"0513",	
"0514")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0272"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0276"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0511"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0513"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0272") AS "0272", 
              sum("0276") AS "0276", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0505") AS "0505", 
              sum("0507") AS "0507",
              sum("0510") AS "0510", 
              sum("0511") AS "0511", 
              sum("0513") AS "0513", 
              sum("0514") AS "0514"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_dip_paso2013, "../../data/02.PBA/pba_dip_paso2013.csv")

```

-
##### CATAMARCA 

```{sql catamarca_dip_paso2013, connection=Arg13P,  output.var="catamarca_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0038",	
"0501",	
"0508",	
"0509")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0508"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0509"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0501") AS "0501", 
              sum("0508") AS "0508",
              sum("0509") AS "0509"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarca_dip_paso2013, "../../data/03.CATAMARCA/catamarca_dip_paso2013.csv")

```

-
##### CORDOBA 

```{sql cordoba_dip_paso2013, connection=Arg13P,  output.var="cordoba_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0047",	
"0063",	
"0191",	
"0217",	 	
"0234",			
"0501",		
"0503",	
"0505",	
"0512",	
"0514")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0191"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0217"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0234"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0512"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0047") AS "0047", 
              sum("0063") AS "0063", 
              sum("0191") AS "0191",
              sum("0217") AS "0217", 
              sum("0234") AS "0234",
              sum("0501") AS "0501", 
              sum("0503") AS "0503", 
              sum("0505") AS "0505", 
              sum("0512") AS "0512",
              sum("0514") AS "0514"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordoba_dip_paso2013, "../../data/04.CORDOBA/cordoba_dip_paso2013.csv")

```

-
##### CORRIENTES 

```{sql Corrientes_dip_paso2013, connection=Arg13P,  output.var="Corrientes_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0063",		
"0501",	
"0515",	
"0516",	
"0517")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0515"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0516"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0063") AS "0063", 
              sum("0501") AS "0501", 
              sum("0515") AS "0515", 
              sum("0516") AS "0516",
              sum("0517") AS "0517"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(Corrientes_dip_paso2013, "../../data/05.CORRIENTES/corrientes_dip_paso2013.csv")

```


-
##### CHACO 

```{sql chaco_dip_paso2013, connection=Arg13P,  output.var="chaco_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0060",	
"0179",	
"0182",	
"0501",	 	
"0518",			
"0519")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0179"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0182"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0518"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0519"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0060") AS "0060", 
              sum("0179") AS "0179", 
              sum("0182") AS "0182",
              sum("0501") AS "0501", 
              sum("0518") AS "0518",
              sum("0519") AS "0519"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chaco_dip_paso2013, "../../data/06.CHACO/chaco_dip_paso2013.csv")

```

-
##### CHUBUT 

```{sql chubut_dip_paso2013, connection=Arg13P,  output.var="chubut_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0038",	
"0047",	
"0060",	
"0151",	 	
"0152",			
"0157",		
"0501")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0151"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0152"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0157"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0038") AS "0038", 
              sum("0047") AS "0047", 
              sum("0060") AS "0060",
              sum("0151") AS "0151", 
              sum("0152") AS "0152",
              sum("0157") AS "0157", 
              sum("0501") AS "0501"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubut_dip_paso2013, "../../data/07.CHUBUT/chubut_dip_paso2013.csv")

```

-
##### ENTRE RIOS 

```{sql erios_dip_paso2013, connection=Arg13P,  output.var="erios_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0068",	
"0501",	
"0545",	
"0546")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0068") AS "0068", 
              sum("0501") AS "0501", 
              sum("0545") AS "0545",
              sum("0546") AS "0546"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(erios_dip_paso2013, "../../data/08.ENTRE_RIOS/erios_dip_paso2013.csv")

```

-
##### FORMOSA 

```{sql formosa_dip_paso2013, connection=Arg13P,  output.var="formosa_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0501",	
"0520",	
"0521")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0520"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0521"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '09'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0501") AS "0501", 
              sum("0520") AS "0520", 
              sum("0521") AS "0521"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_dip_paso2013, "../../data/09.FORMOSA/formosa_dip_paso2013.csv")

```

-
##### JUJUY 

```{sql jujuy_dip_paso2013, connection=Arg13P,  output.var="jujuy_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0063",		
"0068",	
"0208",	
"0501",	
"0505",	 	
"0522",			
"0523",		
"0524")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0208"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0523"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0524"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0063") AS "0063", 
              sum("0068") AS "0068", 
              sum("0208") AS "0208", 
              sum("0501") AS "0501",
              sum("0505") AS "0505", 
              sum("0522") AS "0522",
              sum("0523") AS "0523", 
              sum("0524") AS "0524"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_dip_paso2013, "../../data/10.JUJUY/jujuy_dip_paso2013.csv")

```

-
##### LA PAMPA 

```{sql pampa_dip_paso2013, connection=Arg13P,  output.var="pampa_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0022",	
"0184",	
"0190",	
"0525",	 	
"0526")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0184"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0190"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0525"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0526"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0022") AS "0022", 
              sum("0184") AS "0184", 
              sum("0190") AS "0190",
              sum("0525") AS "0525", 
              sum("0526") AS "0526"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampa_dip_paso2013, "../../data/11.LA_PAMPA/pampa_dip_paso2013.csv")

```


-
##### LA RIOJA 

```{sql rioja_dip_paso2013, connection=Arg13P,  output.var="rioja_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0164",	
"0501",	
"0504",	
"0548",	 	
"0549")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0164"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0548"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0549"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '12'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0164") AS "0164", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0548") AS "0548", 
              sum("0549") AS "0549"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_dip_paso2013, "../../data/12.LA_RIOJA/rioja_dip_paso2013.csv")

```

-
##### MENDOZA 

```{sql mendoza_dip_paso2013, connection=Arg13P,  output.var="mendoza_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0008",	
"0038",	
"0501",	
"0504",	 	
"0505",			
"0527",		
"0528")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0527"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0528"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0008") AS "0008", 
              sum("0038") AS "0038", 
              sum("0501") AS "0501",
              sum("0504") AS "0504", 
              sum("0505") AS "0505",
              sum("0527") AS "0527", 
              sum("0528") AS "0528"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendoza_dip_paso2013, "../../data/13.MENDOZA/mendoza_dip_paso2013.csv")

```

-
##### MISIONES 

```{sql misiones_dip_paso2013, connection=Arg13P,  output.var="misiones_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0050",	
"0501",	
"0529",	
"0531")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0529"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0531"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '14'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0050") AS "0050", 
              sum("0501") AS "0501", 
              sum("0529") AS "0529",
              sum("0531") AS "0531"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_dip_paso2013, "../../data/14.MISIONES/misiones_dip_paso2013.csv")

```

-
##### NEUQUEN 

```{sql neuquen_dip_paso2013, connection=Arg13P,  output.var="neuquen_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0040",	
"0153",	
"0166",	
"0183",	 	
"0501",			
"0505",		
"0532",	
"0533")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0166"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0183"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0532"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0533"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0040") AS "0040", 
              sum("0153") AS "0153", 
              sum("0166") AS "0166",
              sum("0183") AS "0183", 
              sum("0501") AS "0501",
              sum("0505") AS "0505", 
              sum("0532") AS "0532", 
              sum("0533") AS "0533"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquen_dip_paso2013, "../../data/15.NEUQUEN/neuquen_dip_paso2013.csv")

```


-
##### RIO NEGRO 

```{sql rnegro_dip_paso2013, connection=Arg13P,  output.var="rnegro_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0154",	
"0501",	
"0534")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0534"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0154") AS "0154", 
              sum("0501") AS "0501",
              sum("0534") AS "0534"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegro_dip_paso2013, "../../data/16.RIO_NEGRO/rnegro_dip_paso2013.csv")

```

-
##### SALTA 

```{sql salta_dip_paso2013, connection=Arg13P,  output.var="salta_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0038",	
"0054",	
"0060",	 	
"0155",			
"0200",		
"0203",	
"0216",	
"0535",	
"0536")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0054"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0155"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0200"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0203"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0216"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0535"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0536"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0054") AS "0054",
              sum("0060") AS "0060", 
              sum("0155") AS "0155",
              sum("0200") AS "0200", 
              sum("0203") AS "0203", 
              sum("0216") AS "0216", 
              sum("0535") AS "0535",
              sum("0536") AS "0536"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(salta_dip_paso2013, "../../data/17.SALTA/salta_dip_paso2013.csv")

```

-
##### SAN JUAN 

```{sql sjuan_dip_paso2013, connection=Arg13P,  output.var="sjuan_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0061",	
"0156",	
"0168",	
"0501",	 	
"0504",			
"0537")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0156"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0168"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0537"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0061") AS "0061", 
              sum("0156") AS "0156", 
              sum("0168") AS "0168",
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0537") AS "0537"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_dip_paso2013, "../../data/18.SAN_JUAN/sjuan_dip_paso2013.csv")

```

-
##### SAN LUIS 

```{sql sluis_dip_paso2013, connection=Arg13P,  output.var="sluis_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0150",		
"0501",	
"0504",	
"0514")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0150"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0150") AS "0150", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504", 
              sum("0514") AS "0514"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_dip_paso2013, "../../data/19.SAN_LUIS/sluis_dip_paso2013.csv")

```



-
##### SANTA CRUZ 

```{sql scruz_dip_paso2013, connection=Arg13P,  output.var="scruz_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0014",	
"0038",	
"0501",	
"0538")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0538"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0501") AS "0501",
              sum("0538") AS "0538"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_dip_paso2013, "../../data/20.SANTA_CRUZ/scruz_dip_paso2013.csv")

```

-
##### SANTA FE 

```{sql sfe_dip_paso2013, connection=Arg13P,  output.var="sfe_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0068",		
"0180",	
"0501",	
"0504",	
"0505",	 	
"0514",			
"0539",		
"0547")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0180"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0539"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0547"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0068") AS "0068", 
              sum("0180") AS "0180", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0505") AS "0505", 
              sum("0514") AS "0514",
              sum("0539") AS "0539", 
              sum("0547") AS "0547"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe_dip_paso2013, "../../data/21.SANTA_FE//sfe_dip_paso2013.csv")

```
-
##### SANTIAGO DEL ESTERO  

```{sql santiago_dip_paso2013, connection=Arg13P,  output.var="santiago_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0324",	
"0501",	
"0514",	
"0541",	 	
"0550")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0324"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0541"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0550"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0324") AS "0324", 
              sum("0501") AS "0501", 
              sum("0514") AS "0514",
              sum("0541") AS "0541", 
              sum("0550") AS "0550"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(santiago_dip_paso2013, "../../data/22.SANTIAGO_DEL_ESTERO/santiago_dip_paso2013.csv")

```

-
##### TUCUMAN 

```{sql tucuman_dip_paso2013, connection=Arg13P,  output.var="tucuman_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0060",		
"0064",	
"0181",	
"0185",	
"0186",	 	
"0188",			
"0501",		
"0505",	
"0542",	
"0543")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0064"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0181"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0185"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0542"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0543"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0060") AS "0060", 
              sum("0064") AS "0064", 
              sum("0181") AS "0181", 
              sum("0185") AS "0185",
              sum("0186") AS "0186", 
              sum("0188") AS "0188",
              sum("0501") AS "0501", 
              sum("0505") AS "0505", 
              sum("0542") AS "0542", 
              sum("0543") AS "0543"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucuman_dip_paso2013, "../../data/23.TUCUMAN/tucuman_dip_paso2013.csv")

```

-
##### TIERRA DEL FUEGO 

```{sql tdf_dip_paso2013, connection=Arg13P,  output.var="tdf_dip_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0069",	
"0158",	
"0174",	 	
"0199",			
"0201",		
"0501",	
"0544")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0069"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0158"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0199"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0201"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0544"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0069") AS "0069", 
              sum("0158") AS "0158",
              sum("0174") AS "0174", 
              sum("0199") AS "0199",
              sum("0201") AS "0201", 
              sum("0501") AS "0501", 
              sum("0544") AS "0544"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdf_dip_paso2013, "../../data/24.TIERRA_DEL_FUEGO/tdf_dip_paso2013.csv")

```



#### GENERAL

##### CABA 

```{sql caba_dip_gral2013, connection=Arg13G,  output.var="caba_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0187",		
"0501",	
"0502",	
"0503",	
"0505",	 	
"0506")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0506"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0187") AS "0187", 
              sum("0501") AS "0501", 
              sum("0502") AS "0502", 
              sum("0503") AS "0503",
              sum("0505") AS "0505", 
              sum("0506") AS "0506"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(caba_dip_gral2013, "../../data/01.CABA/caba_dip_gral2013.csv")

```

-
##### PBA 

```{sql pba_dip_gral2013, connection=Arg13G,  output.var="pba_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0501",		
"0505",	
"0507",	
"0510",	
"0513",	 	
"0514")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0513"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0501") AS "0501"
              , 
              sum("0505") AS "0505"
              , 
              sum("0507") AS "0507"
              , 
              sum("0510") AS "0510"
              ,
              sum("0513") AS "0513"
              , 
              sum("0514") AS "0514"
              
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_dip_gral2013, "../../data/02.PBA/pba_dip_gral2013.csv")

```

-
##### CATAMARCA 

```{sql catamarca_dip_gral2013, connection=Arg13G,  output.var="catamarca_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0501",	
"0508",	
"0509")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0508"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0509"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0501") AS "0501", 
              sum("0508") AS "0508", 
              sum("0509") AS "0509"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarca_dip_gral2013, "../../data/03.CATAMARCA/catamarca_dip_gral2013.csv")

```

-
##### CORDOBA 

```{sql cordoba_dip_gral2013, connection=Arg13G,  output.var="cordoba_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0047",	
"0191",	
"0217",	
"0501",	 	
"0503",			
"0505",		
"0512",	
"0514")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0191"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0217"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0512"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0047") AS "0047", 
              sum("0191") AS "0191", 
              sum("0217") AS "0217",
              sum("0501") AS "0501", 
              sum("0503") AS "0503",
              sum("0505") AS "0505", 
              sum("0512") AS "0512", 
              sum("0514") AS "0514"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordoba_dip_gral2013, "../../data/04.CORDOBA/cordoba_dip_gral2013.csv")

```

-
##### CORRIENTES 

```{sql Corrientes_dip_gral2013, connection=Arg13G,  output.var="Corrientes_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0501",		
"0516",	
"0517")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0516"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0501") AS "0501", 
              sum("0516") AS "0516", 
              sum("0517") AS "0517"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(Corrientes_dip_gral2013, "../../data/05.CORRIENTES/corrientes_dip_gral2013.csv")

```


-
##### CHACO 

```{sql chaco_dip_gral2013, connection=Arg13G,  output.var="chaco_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0501",	
"0519")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0519"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0501") AS "0501", 
              sum("0519") AS "0519"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chaco_dip_gral2013, "../../data/06.CHACO/chaco_dip_gral2013.csv")

```

-
##### CHUBUT 

```{sql chubut_dip_gral2013, connection=Arg13G,  output.var="chubut_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0038",	
"0047",	
"0152",	
"0157",	 	
"0501")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0152"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0157"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0038") AS "0038", 
              sum("0047") AS "0047", 
              sum("0152") AS "0152",
              sum("0157") AS "0157", 
              sum("0501") AS "0501"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubut_dip_gral2013, "../../data/07.CHUBUT/chubut_dip_gral2013.csv")

```

-
##### ENTRE RIOS 

```{sql erios_dip_gral2013, connection=Arg13G,  output.var="erios_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0068",	
"0501",	
"0545",	
"0546")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0068") AS "0068", 
              sum("0501") AS "0501", 
              sum("0545") AS "0545",
              sum("0546") AS "0546"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(erios_dip_gral2013, "../../data/08.ENTRE_RIOS/erios_dip_gral2013.csv")

```

-
##### FORMOSA 

```{sql formosa_dip_gral2013, connection=Arg13G,  output.var="formosa_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0501",	
"0521")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0521"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '09'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0501") AS "0501", 
              sum("0521") AS "0521"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_dip_gral2013, "../../data/09.FORMOSA/formosa_dip_gral2013.csv")

```

-
##### JUJUY 

```{sql jujuy_dip_gral2013, connection=Arg13G,  output.var="jujuy_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0068",		
"0208",	
"0501",	
"0505",	
"0522",	 	
"0523",			
"0524")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0208"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0523"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0524"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0068") AS "0068", 
              sum("0208") AS "0208", 
              sum("0501") AS "0501", 
              sum("0505") AS "0505",
              sum("0522") AS "0522", 
              sum("0523") AS "0523",
              sum("0524") AS "0524"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_dip_gral2013, "../../data/10.JUJUY/jujuy_dip_gral2013.csv")

```

-
##### LA PAMPA 

```{sql pampa_dip_gral2013, connection=Arg13G,  output.var="pampa_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0022",	
"0184",	
"0190",	
"0525",	 	
"0526")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0184"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0190"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0525"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0526"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0022") AS "0022", 
              sum("0184") AS "0184", 
              sum("0190") AS "0190",
              sum("0525") AS "0525", 
              sum("0526") AS "0526"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampa_dip_gral2013, "../../data/11.LA_PAMPA/pampa_dip_gral2013.csv")

```


-
##### LA RIOJA 

```{sql rioja_dip_gral2013, connection=Arg13G,  output.var="rioja_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0501",	
"0504",	
"0548",	
"0549")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0548"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0549"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '12'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504", 
              sum("0548") AS "0548",
              sum("0549") AS "0549"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_dip_gral2013, "../../data/12.LA_RIOJA/rioja_dip_gral2013.csv")

```

-
##### MENDOZA 

```{sql mendoza_dip_gral2013, connection=Arg13G,  output.var="mendoza_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0501",	
"0504",	
"0505",	
"0527",	 	
"0528")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0527"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0528"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504", 
              sum("0505") AS "0505",
              sum("0527") AS "0527", 
              sum("0528") AS "0528"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendoza_dip_gral2013, "../../data/13.MENDOZA/mendoza_dip_gral2013.csv")

```

-
##### MISIONES 

```{sql misiones_dip_gral2013, connection=Arg13G,  output.var="misiones_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0050",	
"0501",	
"0529",	
"0531")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0529"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0531"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '14'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0050") AS "0050", 
              sum("0501") AS "0501", 
              sum("0529") AS "0529",
              sum("0531") AS "0531"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_dip_gral2013, "../../data/14.MISIONES/misiones_dip_gral2013.csv")

```

-
##### NEUQUEN 

```{sql neuquen_dip_gral2013, connection=Arg13G,  output.var="neuquen_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0040",	
"0153",	
"0166",	
"0501",	 	
"0505",			
"0532",		
"0533")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0166"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0532"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0533"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0040") AS "0040", 
              sum("0153") AS "0153", 
              sum("0166") AS "0166",
              sum("0501") AS "0501", 
              sum("0505") AS "0505",
              sum("0532") AS "0532", 
              sum("0533") AS "0533"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquen_dip_gral2013, "../../data/15.NEUQUEN/neuquen_dip_gral2013.csv")

```


-
##### RIO NEGRO 

```{sql rnegro_dip_gral2013, connection=Arg13G,  output.var="rnegro_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0501",	
"0534")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0534"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0501") AS "0501", 
              sum("0534") AS "0534"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegro_dip_gral2013, "../../data/16.RIO_NEGRO/rnegro_dip_gral2013.csv")

```

-
##### SALTA 

```{sql salta_dip_gral2013, connection=Arg13G,  output.var="salta_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0014",	
"0038",	
"0054",	
"0060",	 	
"0155",			
"0200",		
"0203",	
"0216",	
"0535")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0054"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0155"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0200"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0203"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0216"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0535"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0054") AS "0054",
              sum("0060") AS "0060", 
              sum("0155") AS "0155",
              sum("0200") AS "0200", 
              sum("0203") AS "0203", 
              sum("0216") AS "0216", 
              sum("0535") AS "0535"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(salta_dip_gral2013, "../../data/17.SALTA/salta_dip_gral2013.csv")

```

-
##### SAN JUAN 

```{sql sjuan_dip_gral2013, connection=Arg13G,  output.var="sjuan_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0061",	
"0156",	
"0168",	
"0501",	 	
"0504",			
"0537")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0156"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0168"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0537"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0061") AS "0061", 
              sum("0156") AS "0156", 
              sum("0168") AS "0168",
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0537") AS "0537"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_dip_gral2013, "../../data/18.SAN_JUAN/sjuan_dip_gral2013.csv")

```

-
##### SAN LUIS 

```{sql sluis_dip_gral2013, connection=Arg13G,  output.var="sluis_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0150",		
"0501",	
"0504",	
"0514")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0150"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0150") AS "0150", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504", 
              sum("0514") AS "0514"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_dip_gral2013, "../../data/19.SAN_LUIS/sluis_dip_gral2013.csv")

```



-
##### SANTA CRUZ 

```{sql scruz_dip_gral2013, connection=Arg13G,  output.var="scruz_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0014",	
"0038",	
"0501",	
"0538")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0538"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0501") AS "0501",
              sum("0538") AS "0538"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_dip_gral2013, "../../data/20.SANTA_CRUZ/scruz_dip_gral2013.csv")

```

-
##### SANTA FE 

```{sql sfe_dip_gral2013, connection=Arg13G,  output.var="sfe_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0068",		
"0180",	
"0501",	
"0505",	
"0514",	 	
"0539",			
"0547")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0180"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0539"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0547"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0068") AS "0068", 
              sum("0180") AS "0180", 
              sum("0501") AS "0501", 
              sum("0505") AS "0505",
              sum("0514") AS "0514", 
              sum("0539") AS "0539",
              sum("0547") AS "0547"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe_dip_gral2013, "../../data/21.SANTA_FE//sfe_dip_gral2013.csv")

```
-
##### SANTIAGO DEL ESTERO  

```{sql santiago_dip_gral2013, connection=Arg13G,  output.var="santiago_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0324",	
"0501",	
"0514",	
"0541")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0324"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0541"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0324") AS "0324", 
              sum("0501") AS "0501", 
              sum("0514") AS "0514",
              sum("0541") AS "0541"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(santiago_dip_gral2013, "../../data/22.SANTIAGO_DEL_ESTERO/santiago_dip_gral2013.csv")

```

-
##### TUCUMAN 

```{sql tucuman_dip_gral2013, connection=Arg13G,  output.var="tucuman_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0064",		
"0181",	
"0186",	
"0501",	
"0505",	 	
"0542",			
"0543")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0064"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0181"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0542"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0543"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0064") AS "0064", 
              sum("0181") AS "0181", 
              sum("0186") AS "0186", 
              sum("0501") AS "0501",
              sum("0505") AS "0505", 
              sum("0542") AS "0542",
              sum("0543") AS "0543"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucuman_dip_gral2013, "../../data/23.TUCUMAN/tucuman_dip_gral2013.csv")

```

-
##### TIERRA DEL FUEGO 

```{sql tdf_dip_gral2013, connection=Arg13G,  output.var="tdf_dip_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0069",	
"0158",	
"0174",	 	
"0199",			
"0201",		
"0501",	
"0544")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0069"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0158"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0199"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0201"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0544"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0069") AS "0069", 
              sum("0158") AS "0158",
              sum("0174") AS "0174", 
              sum("0199") AS "0199",
              sum("0201") AS "0201", 
              sum("0501") AS "0501", 
              sum("0544") AS "0544"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdf_dip_gral2013, "../../data/24.TIERRA_DEL_FUEGO/tdf_dip_gral2013.csv")

```




### 2015


#### PASO

##### CABA 

```{sql caba_dip_paso2015, connection=Arg15P,  output.var="caba_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0013",		
"0038",	
"0072",	
"0076",	
"0186",	 	
"0302",			
"0333",		
"0501",	
"0507",	 	
"0503",
"0502",	
"0504",	
"0506")	 	
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0013"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0076"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0302"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0333"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0506"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '01'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0013") AS "0013", 
              sum("0038") AS "0038", 
              sum("0072") AS "0072", 
              sum("0076") AS "0076",
              sum("0186") AS "0186", 
              sum("0302") AS "0302",
              sum("0333") AS "0333", 
              sum("0501") AS "0501", 
              sum("0507") AS "0507", 
              sum("0503") AS "0503",
              sum("0502") AS "0502", 
              sum("0504") AS "0504", 
              sum("0506") AS "0506"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(caba_dip_paso2015, "../../data/01.CABA/caba_dip_paso2015.csv")

```

-
##### PBA 

```{sql pba_dip_paso2015, connection=Arg15P,  output.var="pba_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0013",		
"0038",	
"0131",	
"0132",	
"0133",	 	
"0135",			
"0136",		
"0137",	
"0138",	
"0180",	
"0268",	 	
"0298",	
"0301",	 	
"0302")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0013"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0180"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0268"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0298"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0301"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0302"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0013") AS "0013", 
              sum("0038") AS "0038", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0133") AS "0133", 
              sum("0135") AS "0135",
              sum("0136") AS "0136", 
              sum("0137") AS "0137", 
              sum("0138") AS "0138", 
              sum("0180") AS "0180",
              sum("0268") AS "0268", 
              sum("0298") AS "0298",
              sum("0301") AS "0301", 
              sum("0302") AS "0302"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_dip_paso2015, "../../data/02.PBA/pba_dip_paso2015.csv")

```

-
##### CATAMARCA 

```{sql catamarca_dip_paso2015, connection=Arg15P,  output.var="catamarca_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0131",	
"0161",	
"0521",	
"0524",	 	
"0528")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0161"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0521"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0524"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0528"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0131") AS "0131", 
              sum("0161") AS "0161", 
              sum("0521") AS "0521",
              sum("0524") AS "0524", 
              sum("0528") AS "0528"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarca_dip_paso2015, "../../data/03.CATAMARCA/catamarca_dip_paso2015.csv")

```

-
##### CORDOBA 

```{sql cordoba_dip_paso2015, connection=Arg15P,  output.var="cordoba_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0013",		
"0038",	
"0063",	
"0065",	
"0131",	 	
"0132",			
"0135",		
"0137",	
"0510")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0013"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0065"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0013") AS "0013", 
              sum("0038") AS "0038", 
              sum("0063") AS "0063", 
              sum("0065") AS "0065",
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0135") AS "0135", 
              sum("0137") AS "0137", 
              sum("0510") AS "0510"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordoba_dip_paso2015, "../../data/04.CORDOBA/cordoba_dip_paso2015.csv")

```

-
##### CORRIENTES 

```{sql Corrientes_dip_paso2015, connection=Arg15P,  output.var="Corrientes_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0063",		
"0072",	
"0131",	
"0132",	
"0134",	 	
"0138",			
"0519")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0519"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0063") AS "0063", 
              sum("0072") AS "0072", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0134") AS "0134", 
              sum("0138") AS "0138",
              sum("0519") AS "0519"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(Corrientes_dip_paso2015, "../../data/05.CORRIENTES/corrientes_dip_paso2015.csv")

```


-
##### CHACO 

```{sql chaco_dip_paso2015, connection=Arg15P,  output.var="chaco_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0060",		
"0071",	
"0189",	
"0190",	
"0501",	 	
"0502",			
"0506",		
"0507")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0189"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0190"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0506"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0060") AS "0060", 
              sum("0071") AS "0071", 
              sum("0189") AS "0189", 
              sum("0190") AS "0190",
              sum("0501") AS "0501", 
              sum("0502") AS "0502",
              sum("0506") AS "0506", 
              sum("0507") AS "0507"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chaco_dip_paso2015, "../../data/06.CHACO/chaco_dip_paso2015.csv")

```

-
##### CHUBUT 

```{sql chubut_dip_paso2015, connection=Arg15P,  output.var="chubut_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0060",	
"0074",	
"0152",	
"0157",	 	
"0501",			
"0530",		
"0531")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0074"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0152"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0157"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0530"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0531"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0060") AS "0060", 
              sum("0074") AS "0074", 
              sum("0152") AS "0152",
              sum("0157") AS "0157", 
              sum("0501") AS "0501",
              sum("0530") AS "0530", 
              sum("0531") AS "0531"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubut_dip_paso2015, "../../data/07.CHUBUT/chubut_dip_paso2015.csv")

```

-
##### ENTRE RIOS 

```{sql erios_dip_paso2015, connection=Arg15P,  output.var="erios_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0050",		
"0068",	
"0069",	
"0501",	
"0502",	 	
"0507")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0069"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0050") AS "0050", 
              sum("0068") AS "0068", 
              sum("0069") AS "0069", 
              sum("0501") AS "0501",
              sum("0502") AS "0502", 
              sum("0507") AS "0507"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(erios_dip_paso2015, "../../data/08.ENTRE_RIOS/erios_dip_paso2015.csv")

```

-
##### FORMOSA 

```{sql formosa_dip_paso2015, connection=Arg15P,  output.var="formosa_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0060",		
"0071",	
"0212",	
"0501",	
"0520")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0212"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0520"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '09'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0060") AS "0060", 
              sum("0071") AS "0071", 
              sum("0212") AS "0212", 
              sum("0501") AS "0501",
              sum("0520") AS "0520"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_dip_paso2015, "../../data/09.FORMOSA/formosa_dip_paso2015.csv")

```

-
##### JUJUY 

```{sql jujuy_dip_paso2015, connection=Arg15P,  output.var="jujuy_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0038",	
"0072",	
"0131",	
"0137",	 	
"0179",			
"0208")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0179"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0208"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0038") AS "0038", 
              sum("0072") AS "0072", 
              sum("0131") AS "0131",
              sum("0137") AS "0137", 
              sum("0179") AS "0179",
              sum("0208") AS "0208"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_dip_paso2015, "../../data/10.JUJUY/jujuy_dip_paso2015.csv")

```

-
##### LA PAMPA 

```{sql pampa_dip_paso2015, connection=Arg15P,  output.var="pampa_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0030",		
"0131",	
"0132",	
"0135",	
"0137",	 	
"0138")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0030") AS "0030", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0135") AS "0135",
              sum("0137") AS "0137", 
              sum("0138") AS "0138"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampa_dip_paso2015, "../../data/11.LA_PAMPA/pampa_dip_paso2015.csv")

```


-
##### LA RIOJA 

```{sql rioja_dip_paso2015, connection=Arg15P,  output.var="rioja_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0012",		
"0013",	
"0063",	
"0068",	
"0501",	 	
"0504",			
"0522")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0013"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '12'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0012") AS "0012", 
              sum("0013") AS "0013", 
              sum("0063") AS "0063", 
              sum("0068") AS "0068",
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0522") AS "0522"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_dip_paso2015, "../../data/12.LA_RIOJA/rioja_dip_paso2015.csv")

```

-
##### MENDOZA 

```{sql mendoza_dip_paso2015, connection=Arg15P,  output.var="mendoza_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0063",	
"0501",	
"0504",	
"0506",	 	
"0514",			
"0527")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0506"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0527"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0063") AS "0063", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0506") AS "0506", 
              sum("0514") AS "0514",
              sum("0527") AS "0527"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendoza_dip_paso2015, "../../data/13.MENDOZA/mendoza_dip_paso2015.csv")

```

-
##### MISIONES 

```{sql misiones_dip_paso2015, connection=Arg15P,  output.var="misiones_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0050",	
"0060",	
"0071",	
"0072",	 	
"0165",			
"0169",		
"0501",	
"0522",	
"0529")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0165"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0169"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0529"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '14'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0050") AS "0050", 
              sum("0060") AS "0060", 
              sum("0071") AS "0071",
              sum("0072") AS "0072", 
              sum("0165") AS "0165",
              sum("0169") AS "0169", 
              sum("0501") AS "0501", 
              sum("0522") AS "0522", 
              sum("0529") AS "0529"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_dip_paso2015, "../../data/14.MISIONES/misiones_dip_paso2015.csv")

```

-
##### NEUQUEN 

```{sql neuquen_dip_paso2015, connection=Arg15P,  output.var="neuquen_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0013",		
"0131",	
"0132",	
"0134",	
"0135",	 	
"0136",			
"0137",		
"0138",	
"0151")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0013"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0151"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0013") AS "0013", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0136") AS "0136",
              sum("0137") AS "0137", 
              sum("0138") AS "0138", 
              sum("0151") AS "0151"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquen_dip_paso2015, "../../data/15.NEUQUEN/neuquen_dip_paso2015.csv")

```


-
##### RIO NEGRO 

```{sql rnegro_dip_paso2015, connection=Arg15P,  output.var="rnegro_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0013",		
"0038",	
"0050",	
"0161",	
"0501",	 	
"0523")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0013"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0161"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0523"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0013") AS "0013", 
              sum("0038") AS "0038", 
              sum("0050") AS "0050", 
              sum("0161") AS "0161",
              sum("0501") AS "0501", 
              sum("0523") AS "0523"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegro_dip_paso2015, "../../data/16.RIO_NEGRO/rnegro_dip_paso2015.csv")

```

-
##### SALTA 

```{sql salta_dip_paso2015, connection=Arg15P,  output.var="salta_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0060",		
"0070",	
"0071",	
"0131",	
"0132",	 	
"0134",			
"0135",		
"0136",	
"0138")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0070"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0060") AS "0060", 
              sum("0070") AS "0070", 
              sum("0071") AS "0071", 
              sum("0131") AS "0131",
              sum("0132") AS "0132", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0136") AS "0136", 
              sum("0138") AS "0138"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(salta_dip_paso2015, "../../data/17.SALTA/salta_dip_paso2015.csv")

```

-
##### SAN JUAN 

```{sql sjuan_dip_paso2015, connection=Arg15P,  output.var="sjuan_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0068",	
"0153",	
"0501",	
"0502",	 	
"0518",			
"0526")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0518"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0526"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0068") AS "0068", 
              sum("0153") AS "0153", 
              sum("0501") AS "0501",
              sum("0502") AS "0502", 
              sum("0518") AS "0518",
              sum("0526") AS "0526"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_dip_paso2015, "../../data/18.SAN_JUAN/sjuan_dip_paso2015.csv")

```

-
##### SAN LUIS 

```{sql sluis_dip_paso2015, connection=Arg15P,  output.var="sluis_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0040",		
"0057",	
"0131",	
"0133",	
"0134",	 	
"0135",			
"0198")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0057"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0198"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0040") AS "0040", 
              sum("0057") AS "0057", 
              sum("0131") AS "0131", 
              sum("0133") AS "0133",
              sum("0134") AS "0134", 
              sum("0135") AS "0135",
              sum("0198") AS "0198"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_dip_paso2015, "../../data/19.SAN_LUIS/sluis_dip_paso2015.csv")

```



-
##### SANTA CRUZ 

```{sql scruz_dip_paso2015, connection=Arg15P,  output.var="scruz_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0013",		
"0038",	
"0501",	
"0504",	
"0509")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0013"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0509"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0013") AS "0013", 
              sum("0038") AS "0038", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0509") AS "0509"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_dip_paso2015, "../../data/20.SANTA_CRUZ/scruz_dip_paso2015.csv")

```

-
##### SANTA FE 

```{sql sfe_dip_paso2015, connection=Arg15P,  output.var="sfe_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0081",		
"0131",	
"0133",	
"0134",	
"0135",	 	
"0136",			
"0137",		
"0138",	
"0180",	
"0188",	
"0525")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0081"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0180"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0525"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0081") AS "0081", 
              sum("0131") AS "0131", 
              sum("0133") AS "0133", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0136") AS "0136",
              sum("0137") AS "0137", 
              sum("0138") AS "0138", 
              sum("0180") AS "0180", 
              sum("0188") AS "0188",
              sum("0525") AS "0525"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe_dip_paso2015, "../../data/21.SANTA_FE/sfe_dip_paso2015.csv")

```
-
##### SANTIAGO DEL ESTERO  

```{sql santiago_dip_paso2015, connection=Arg15P,  output.var="santiago_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0040",	
"0061",	
"0507",	
"0522",	 	
"0531")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0531"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0040") AS "0040", 
              sum("0061") AS "0061", 
              sum("0507") AS "0507",
              sum("0522") AS "0522", 
              sum("0531") AS "0531"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(santiago_dip_paso2015, "../../data/22.SANTIAGO_DEL_ESTERO/santiago_dip_paso2015.csv")

```

-
##### TUCUMAN 

```{sql tucuman_dip_paso2015, connection=Arg15P,  output.var="tucuman_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0060",	
"0136",	
"0137",	
"0177",	 	
"0501",			
"0522")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0177"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0060") AS "0060", 
              sum("0136") AS "0136", 
              sum("0137") AS "0137",
              sum("0177") AS "0177", 
              sum("0501") AS "0501",
              sum("0522") AS "0522"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucuman_dip_paso2015, "../../data/23.TUCUMAN/tucuman_dip_paso2015.csv")

```

-
##### TIERRA DEL FUEGO 

```{sql tdf_dip_paso2015, connection=Arg15P,  output.var="tdf_dip_paso2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0072",		
"0076",	
"0081",	
"0154",	
"0161",	 	
"0187",			
"0202",		
"0501",	
"0517")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0076"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0081"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0161"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0202"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0072") AS "0072", 
              sum("0076") AS "0076", 
              sum("0081") AS "0081", 
              sum("0154") AS "0154",
              sum("0161") AS "0161", 
              sum("0187") AS "0187",
              sum("0202") AS "0202", 
              sum("0501") AS "0501", 
              sum("0517") AS "0517"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdf_dip_paso2015, "../../data/24.TIERRA_DEL_FUEGO/tdf_dip_paso2015.csv")

```



#### GENERAL

##### CABA 

```{sql caba_dip_gral2015, connection=Arg15G,  output.var="caba_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0132",	
"0135",	
"0137",	
"0138",	 	
"0186")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '01'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0135") AS "0135", 
              sum("0137") AS "0137",
              sum("0138") AS "0138", 
              sum("0186") AS "0186"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(caba_dip_gral2015, "../../data/01.CABA/caba_dip_gral2015.csv")

```

-
##### PBA 

```{sql pba_dip_gral2015, connection=Arg15G,  output.var="pba_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0132",	
"0137",	
"0138",	
"0145")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0145"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0137") AS "0137", 
              sum("0138") AS "0138",
              sum("0145") AS "0145"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_dip_gral2015, "../../data/02.PBA/pba_dip_gral2015.csv")

```

-
##### CATAMARCA 

```{sql catamarca_dip_gral2015, connection=Arg15G,  output.var="catamarca_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0524",	
"0528")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0524"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0528"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0524") AS "0524", 
              sum("0528") AS "0528"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarca_dip_gral2015, "../../data/03.CATAMARCA/catamarca_dip_gral2015.csv")

```

-
##### CORDOBA 

```{sql cordoba_dip_gral2015, connection=Arg15G,  output.var="cordoba_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0063",		
"0131",	
"0132",	
"0135",	
"0137",	 	
"0510")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0063") AS "0063", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0135") AS "0135",
              sum("0137") AS "0137", 
              sum("0510") AS "0510"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordoba_dip_gral2015, "../../data/04.CORDOBA/cordoba_dip_gral2015.csv")

```

-
##### CORRIENTES 

```{sql Corrientes_dip_gral2015, connection=Arg15G,  output.var="Corrientes_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0138",	
"0519")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0519"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0138") AS "0138", 
              sum("0519") AS "0519"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(Corrientes_dip_gral2015, "../../data/05.CORRIENTES/corrientes_dip_gral2015.csv")

```


-
##### CHACO 

```{sql chaco_dip_gral2015, connection=Arg15G,  output.var="chaco_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0071",		
"0189",	
"0501",	
"0502",	
"0506",	 	
"0507")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0189"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0506"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0071") AS "0071", 
              sum("0189") AS "0189", 
              sum("0501") AS "0501", 
              sum("0502") AS "0502",
              sum("0506") AS "0506", 
              sum("0507") AS "0507"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chaco_dip_gral2015, "../../data/06.CHACO/chaco_dip_gral2015.csv")

```

-
##### CHUBUT 

```{sql chubut_dip_gral2015, connection=Arg15G,  output.var="chubut_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0152",	
"0530",	
"0531")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0152"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0530"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0531"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0152") AS "0152", 
              sum("0530") AS "0530", 
              sum("0531") AS "0531"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubut_dip_gral2015, "../../data/07.CHUBUT/chubut_dip_gral2015.csv")

```

-
##### ENTRE RIOS 

```{sql erios_dip_gral2015, connection=Arg15G,  output.var="erios_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0135",	
"0138")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0135") AS "0135", 
              sum("0138") AS "0138"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(erios_dip_gral2015, "../../data/08.ENTRE_RIOS/erios_dip_gral2015.csv")

```

-
##### FORMOSA 

```{sql formosa_dip_gral2015, connection=Arg15G,  output.var="formosa_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0501",		
"0520")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0520"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '09'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0501") AS "0501", 
              sum("0520") AS "0520"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_dip_gral2015, "../../data/09.FORMOSA/formosa_dip_gral2015.csv")

```

-
##### JUJUY 

```{sql jujuy_dip_gral2015, connection=Arg15G,  output.var="jujuy_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0137",	
"0179")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0179"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0137") AS "0137", 
              sum("0179") AS "0179"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_dip_gral2015, "../../data/10.JUJUY/jujuy_dip_gral2015.csv")

```

-
##### LA PAMPA 

```{sql pampa_dip_gral2015, connection=Arg15G,  output.var="pampa_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0069",		
"0131",	
"0184",	
"0534")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0069"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0184"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0534"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0069") AS "0069", 
              sum("0131") AS "0131", 
              sum("0184") AS "0184", 
              sum("0534") AS "0534"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampa_dip_gral2015, "../../data/11.LA_PAMPA/pampa_dip_gral2015.csv")

```


-
##### LA RIOJA 

```{sql rioja_dip_gral2015, connection=Arg15G,  output.var="rioja_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0012",		
"0063",	
"0501",	
"0502")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '12'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0012") AS "0012", 
              sum("0063") AS "0063", 
              sum("0501") AS "0501", 
              sum("0502") AS "0502"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_dip_gral2015, "../../data/12.LA_RIOJA/rioja_dip_gral2015.csv")

```

-
##### MENDOZA 

```{sql mendoza_dip_gral2015, connection=Arg15G,  output.var="mendoza_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0063",		
"0131",	
"0135",	
"0137",	
"0527")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0527"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0063") AS "0063", 
              sum("0131") AS "0131", 
              sum("0135") AS "0135", 
              sum("0137") AS "0137",
              sum("0527") AS "0527"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendoza_dip_gral2015, "../../data/13.MENDOZA/mendoza_dip_gral2015.csv")

```

-
##### MISIONES 

```{sql misiones_dip_gral2015, connection=Arg15G,  output.var="misiones_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0165",	
"0169",	
"0501",	
"0522",	 	
"0529")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0165"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0169"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0529"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '14'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0165") AS "0165", 
              sum("0169") AS "0169", 
              sum("0501") AS "0501",
              sum("0522") AS "0522", 
              sum("0529") AS "0529"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_dip_gral2015, "../../data/14.MISIONES/misiones_dip_gral2015.csv")

```

-
##### NEUQUEN 

```{sql neuquen_dip_gral2015, connection=Arg15G,  output.var="neuquen_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0131",	
"0132",	
"0135",	
"0137",	 	
"0151")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0151"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0135") AS "0135",
              sum("0137") AS "0137", 
              sum("0151") AS "0151"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquen_dip_gral2015, "../../data/15.NEUQUEN/neuquen_dip_gral2015.csv")

```


-
##### RIO NEGRO 

```{sql rnegro_dip_gral2015, connection=Arg15G,  output.var="rnegro_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0050",		
"0131",	
"0161",	
"0523")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0161"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0523"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0050") AS "0050", 
              sum("0131") AS "0131", 
              sum("0161") AS "0161", 
              sum("0523") AS "0523"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegro_dip_gral2015, "../../data/16.RIO_NEGRO/rnegro_dip_gral2015.csv")

```

-
##### SALTA 

```{sql salta_dip_gral2015, connection=Arg15G,  output.var="salta_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0138",	
"0146",	
"0161")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0146"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0161"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0138") AS "0138", 
              sum("0146") AS "0146", 
              sum("0161") AS "0161"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(salta_dip_gral2015, "../../data/17.SALTA/salta_dip_gral2015.csv")

```

-
##### SAN JUAN 

```{sql sjuan_dip_gral2015, connection=Arg15G,  output.var="sjuan_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0135",	
"0153",	
"0518")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0518"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0135") AS "0135", 
              sum("0153") AS "0153", 
              sum("0518") AS "0518"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_dip_gral2015, "../../data/18.SAN_JUAN/sjuan_dip_gral2015.csv")

```

-
##### SAN LUIS 

```{sql sluis_dip_gral2015, connection=Arg15G,  output.var="sluis_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0133",	
"0135")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0133") AS "0133", 
              sum("0135") AS "0135"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_dip_gral2015, "../../data/19.SAN_LUIS/sluis_dip_gral2015.csv")

```



-
##### SANTA CRUZ 

```{sql scruz_dip_gral2015, connection=Arg15G,  output.var="scruz_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0137",	
"0701")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0701"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0137") AS "0137", 
              sum("0701") AS "0701"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_dip_gral2015, "../../data/20.SANTA_CRUZ/scruz_dip_gral2015.csv")

```

-
##### SANTA FE 

```{sql sfe_dip_gral2015, connection=Arg15G,  output.var="sfe_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0133",	
"0135",	
"0137",	
"0138",	 	
"0525")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0525"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0133") AS "0133", 
              sum("0135") AS "0135", 
              sum("0137") AS "0137",
              sum("0138") AS "0138", 
              sum("0525") AS "0525"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe_dip_gral2015, "../../data/21.SANTA_FE//sfe_dip_gral2015.csv")

```
-
##### SANTIAGO DEL ESTERO  

```{sql santiago_dip_gral2015, connection=Arg15G,  output.var="santiago_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0135",		
"0138",	
"0533")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0533"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0135") AS "0135", 
              sum("0138") AS "0138", 
              sum("0533") AS "0533"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(santiago_dip_gral2015, "../../data/22.SANTIAGO_DEL_ESTERO/santiago_dip_gral2015.csv")

```

-
##### TUCUMAN 

```{sql tucuman_dip_gral2015, connection=Arg15G,  output.var="tucuman_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0135",	
"0137",	
"0177")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0177"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0135") AS "0135", 
              sum("0137") AS "0137", 
              sum("0177") AS "0177"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucuman_dip_gral2015, "../../data/23.TUCUMAN/tucuman_dip_gral2015.csv")

```

-
##### TIERRA DEL FUEGO 

```{sql tdf_dip_gral2015, connection=Arg15G,  output.var="tdf_dip_gral2015"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0076",		
"0131",	
"0154",	
"0161",	
"0187",	 	
"0202",			
"0517")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0076"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0161"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0202"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0076") AS "0076", 
              sum("0131") AS "0131", 
              sum("0154") AS "0154", 
              sum("0161") AS "0161",
              sum("0187") AS "0187", 
              sum("0202") AS "0202",
              sum("0517") AS "0517"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdf_dip_gral2015, "../../data/24.TIERRA_DEL_FUEGO/tdf_dip_gral2015.csv")

```
















### 2017


#### PASO

##### CABA 

```{sql caba_dip_paso2017, connection=Arg17P,  output.var="caba_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0022",	
"0079",	
"0083",	
"0178",	 	
"0185",			
"0187",		
"0262",	
"0327",	
"0503",	
"0515",	 	
"0525",	
"0531",	
"0567",	
"0576",	 	
"0580")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0079"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0083"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0178"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0185"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0262"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0327"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0515"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0525"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0531"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0576"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0580"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '01'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0022") AS "0022", 
              sum("0079") AS "0079", 
              sum("0083") AS "0083",
              sum("0178") AS "0178", 
              sum("0185") AS "0185",
              sum("0187") AS "0187", 
              sum("0262") AS "0262", 
              sum("0327") AS "0327", 
              sum("0503") AS "0503",
              sum("0515") AS "0515", 
              sum("0525") AS "0525", 
              sum("0531") AS "0531", 
              sum("0567") AS "0567",
              sum("0576") AS "0576", 
              sum("0580") AS "0580"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(caba_dip_paso2017, "../../data/01.CABA/caba_dip_paso2017.csv")

```

-
##### PBA 

```{sql pba_dip_paso2017, connection=Arg17P,  output.var="pba_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0022",	
"0259",	 	
"0268",	
"0298",	
"0301",	 	
"0309",			
"0503",	
"0511",		
"0518",	
"0526",	
"0527",	
"0546",	 	
"0552",		
"0561",	
"0567",	
"0574")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0259"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0268"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0298"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0301"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0309"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0511"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0518"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0526"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0527"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0552"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0561"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0574"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0022") AS "0022", 
              sum("0259") AS "0259", 
              sum("0268") AS "0268",
              sum("0298") AS "0298", 
              sum("0301") AS "0301",
              sum("0309") AS "0309", 
              sum("0503") AS "0503", 
              sum("0511") AS "0511", 
              sum("0518") AS "0518",
              sum("0526") AS "0526", 
              sum("0527") AS "0527", 
              sum("0546") AS "0546", 
              sum("0552") AS "0552", 
              sum("0561") AS "0561",
              sum("0567") AS "0567", 
              sum("0574") AS "0574"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_dip_paso2017, "../../data/02.PBA/pba_dip_paso2017.csv")

```

-
##### CATAMARCA 

```{sql catamarca_dip_paso2017, connection=Arg17P,  output.var="catamarca_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0033",		
"0194",	
"0215",	
"0216",	
"0542",	 	
"0544",			
"0547")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0215"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0216"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0542"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0544"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0547"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0033") AS "0033", 
              sum("0194") AS "0194", 
              sum("0215") AS "0215", 
              sum("0216") AS "0216",
              sum("0542") AS "0542", 
              sum("0544") AS "0544",
              sum("0547") AS "0547"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarca_dip_paso2017, "../../data/03.CATAMARCA/catamarca_dip_paso2017.csv")

```

-
##### CORDOBA 

```{sql cordoba_dip_paso2017, connection=Arg17P,  output.var="cordoba_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0022",		
"0069",	
"0201",	
"0217",	
"0231",	 	
"0502",			
"0503",		
"0543",	
"0567",	
"0570",	
"0578")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0069"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0201"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0217"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0231"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0543"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0570"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0578"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0022") AS "0022", 
              sum("0069") AS "0069", 
              sum("0201") AS "0201", 
              sum("0217") AS "0217",
              sum("0231") AS "0231", 
              sum("0502") AS "0502",
              sum("0503") AS "0503", 
              sum("0543") AS "0543", 
              sum("0567") AS "0567", 
              sum("0570") AS "0570",
              sum("0578") AS "0578"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordoba_dip_paso2017, "../../data/04.CORDOBA/cordoba_dip_paso2017.csv")

```

-
##### CORRIENTES 

```{sql Corrientes_dip_paso2017, connection=Arg17P,  output.var="Corrientes_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0072",	
"0082",	
"0528",	
"0557",	 	
"0568",			
"0571")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0082"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0528"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0557"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0568"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0571"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0072") AS "0072", 
              sum("0082") AS "0082", 
              sum("0528") AS "0528",
              sum("0557") AS "0557", 
              sum("0568") AS "0568",
              sum("0571") AS "0571"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(Corrientes_dip_paso2017, "../../data/05.CORRIENTES/corrientes_dip_paso2017.csv")

```


-
##### CHACO 

```{sql chaco_dip_paso2017, connection=Arg17P,  output.var="chaco_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0033",		
"0071",	
"0082",	
"0083",	
"0185",	 	
"0179",			
"0502",		
"0537",	
"0572",	
"0574")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0082"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0083"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0185"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0179"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0537"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0572"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0574"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0033") AS "0033", 
              sum("0071") AS "0071", 
              sum("0082") AS "0082", 
              sum("0083") AS "0083",
              sum("0185") AS "0185", 
              sum("0179") AS "0179",
              sum("0502") AS "0502", 
              sum("0537") AS "0537", 
              sum("0572") AS "0572", 
              sum("0574") AS "0574"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chaco_dip_paso2017, "../../data/06.CHACO/chaco_dip_paso2017.csv")

```

-
##### CHUBUT 

```{sql chubut_dip_paso2017, connection=Arg17P,  output.var="chubut_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0071",	
"0074",	
"0153",	
"0501",	 	
"0519",			
"0538")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0074"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0519"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0538"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0071") AS "0071", 
              sum("0074") AS "0074", 
              sum("0153") AS "0153",
              sum("0501") AS "0501", 
              sum("0519") AS "0519",
              sum("0538") AS "0538"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubut_dip_paso2017, "../../data/07.CHUBUT/chubut_dip_paso2017.csv")

```

-
##### ENTRE RIOS 

```{sql erios_dip_paso2017, connection=Arg17P,  output.var="erios_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0050",		
"0186",	
"0502",	
"0550")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0550"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0050") AS "0050", 
              sum("0186") AS "0186", 
              sum("0502") AS "0502", 
              sum("0550") AS "0550"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(erios_dip_paso2017, "../../data/08.ENTRE_RIOS/erios_dip_paso2017.csv")

```

-
##### FORMOSA 

```{sql formosa_dip_paso2017, connection=Arg17P,  output.var="formosa_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0050",	
"0194",	
"0211",	
"0212",	 	
"0505",			
"0532")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0211"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0212"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0532"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '09'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0050") AS "0050", 
              sum("0194") AS "0194", 
              sum("0211") AS "0211",
              sum("0212") AS "0212", 
              sum("0505") AS "0505",
              sum("0532") AS "0532"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_dip_paso2017, "../../data/09.FORMOSA/formosa_dip_paso2017.csv")

```

-
##### JUJUY 

```{sql jujuy_dip_paso2017, connection=Arg17P,  output.var="jujuy_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0033",		
"0038",	
"0082",	
"0210",	
"0503",	 	
"0545",			
"0546",		
"0558")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0082"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0210"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0558"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0033") AS "0033", 
              sum("0038") AS "0038", 
              sum("0082") AS "0082", 
              sum("0210") AS "0210",
              sum("0503") AS "0503", 
              sum("0545") AS "0545",
              sum("0546") AS "0546", 
              sum("0558") AS "0558"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_dip_paso2017, "../../data/10.JUJUY/jujuy_dip_paso2017.csv")

```

-
##### LA PAMPA 

```{sql pampa_dip_paso2017, connection=Arg17P,  output.var="pampa_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0022",	
"0190",	
"0536",	
"0555",	 	
"0567")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0190"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0536"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0555"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0022") AS "0022", 
              sum("0190") AS "0190", 
              sum("0536") AS "0536",
              sum("0555") AS "0555", 
              sum("0567") AS "0567"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampa_dip_paso2017, "../../data/11.LA_PAMPA/pampa_dip_paso2017.csv")

```


-
##### LA RIOJA 

```{sql rioja_dip_paso2017, connection=Arg17P,  output.var="rioja_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0159",		
"0503",	
"0514",	
"0517",	
"0549",	 	
"0567",			
"0573")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0159"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0549"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0573"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '12'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0159") AS "0159", 
              sum("0503") AS "0503", 
              sum("0514") AS "0514", 
              sum("0517") AS "0517",
              sum("0549") AS "0549", 
              sum("0567") AS "0567",
              sum("0573") AS "0573"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_dip_paso2017, "../../data/12.LA_RIOJA/rioja_dip_paso2017.csv")

```

-
##### MENDOZA 

```{sql mendoza_dip_paso2017, connection=Arg17P,  output.var="mendoza_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0006",		
"0074",	
"0181",	
"0221",	
"0502",	 	
"0503",			
"0529",		
"0562")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0074"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0181"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0221"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0529"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0562"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0006") AS "0006", 
              sum("0074") AS "0074", 
              sum("0181") AS "0181", 
              sum("0221") AS "0221",
              sum("0502") AS "0502", 
              sum("0503") AS "0503",
              sum("0529") AS "0529", 
              sum("0562") AS "0562"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendoza_dip_paso2017, "../../data/13.MENDOZA/mendoza_dip_paso2017.csv")

```

-
##### MISIONES 

```{sql misiones_dip_paso2017, connection=Arg17P,  output.var="misiones_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0071",	
"0072",	
"0082",	
"0165",	 	
"0184",			
"0534",		
"0535",	
"0559")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0082"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0165"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0184"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0534"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0535"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0559"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '14'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0071") AS "0071", 
              sum("0072") AS "0072", 
              sum("0082") AS "0082",
              sum("0165") AS "0165", 
              sum("0184") AS "0184",
              sum("0534") AS "0534", 
              sum("0535") AS "0535", 
              sum("0559") AS "0559"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_dip_paso2017, "../../data/14.MISIONES/misiones_dip_paso2017.csv")

```

-
##### NEUQUEN 

```{sql neuquen_dip_paso2017, connection=Arg17P,  output.var="neuquen_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0040",		
"0151",	
"0186",	
"0502",	
"0503",	 	
"0513",			
"0551",		
"0575")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0151"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0513"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0551"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0575"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0040") AS "0040", 
              sum("0151") AS "0151", 
              sum("0186") AS "0186", 
              sum("0502") AS "0502",
              sum("0503") AS "0503", 
              sum("0513") AS "0513",
              sum("0551") AS "0551", 
              sum("0575") AS "0575"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquen_dip_paso2017, "../../data/15.NEUQUEN/neuquen_dip_paso2017.csv")

```


-
##### RIO NEGRO 

```{sql rnegro_dip_paso2017, connection=Arg17P,  output.var="rnegro_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0047",		
"0050",	
"0501",	
"0503",	
"0523",	 	
"0567",			
"0569")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0523"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0569"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0047") AS "0047", 
              sum("0050") AS "0050", 
              sum("0501") AS "0501", 
              sum("0503") AS "0503",
              sum("0523") AS "0523", 
              sum("0567") AS "0567",
              sum("0569") AS "0569"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegro_dip_paso2017, "../../data/16.RIO_NEGRO/rnegro_dip_paso2017.csv")

```

-
##### SALTA 

```{sql salta_dip_paso2017, connection=Arg17P,  output.var="salta_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0082",	
"0203",	
"0503",	
"0520",	 	
"0539",			
"0553",		
"0566")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0082"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0203"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0520"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0539"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0553"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0566"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0082") AS "0082", 
              sum("0203") AS "0203", 
              sum("0503") AS "0503",
              sum("0520") AS "0520", 
              sum("0539") AS "0539",
              sum("0553") AS "0553", 
              sum("0566") AS "0566"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(salta_dip_paso2017, "../../data/17.SALTA/salta_dip_paso2017.csv")

```

-
##### SAN JUAN 

```{sql sjuan_dip_paso2017, connection=Arg17P,  output.var="sjuan_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0168",	
"0172",	
"0182",	
"0186",	 	
"0512",			
"0522",		
"0556",	
"0564")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0168"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0172"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0182"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0512"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0556"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0564"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0168") AS "0168", 
              sum("0172") AS "0172", 
              sum("0182") AS "0182",
              sum("0186") AS "0186", 
              sum("0512") AS "0512",
              sum("0522") AS "0522", 
              sum("0556") AS "0556", 
              sum("0564") AS "0564"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_dip_paso2017, "../../data/18.SAN_JUAN/sjuan_dip_paso2017.csv")

```

-
##### SAN LUIS 

```{sql sluis_dip_paso2017, connection=Arg17P,  output.var="sluis_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0069",	
"0070",	
"0516",	
"0565")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0069"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0070"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0516"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0565"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0069") AS "0069", 
              sum("0070") AS "0070", 
              sum("0516") AS "0516",
              sum("0565") AS "0565"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_dip_paso2017, "../../data/19.SAN_LUIS/sluis_dip_paso2017.csv")

```



-
##### SANTA CRUZ 

```{sql scruz_dip_paso2017, connection=Arg17P,  output.var="scruz_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0083",		
"0176",	
"0501",	
"0504",	
"0567",	 	
"0577")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0083"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0176"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0577"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0083") AS "0083", 
              sum("0176") AS "0176", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0567") AS "0567", 
              sum("0577") AS "0577"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_dip_paso2017, "../../data/20.SANTA_CRUZ/scruz_dip_paso2017.csv")

```

-
##### SANTA FE 

```{sql sfe_dip_paso2017, connection=Arg17P,  output.var="sfe_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0033",	
"0065",	
"0171",	
"0174",	 	
"0188",			
"0202",		
"0211",	
"0259",	
"0502",	
"0503",	 	
"0510",		
"0530",	
"0546",	
"0554",	
"0560",	 	
"0580")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0065"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0171"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0202"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0211"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0259"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0530"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0554"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0560"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0580"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0033") AS "0033", 
              sum("0065") AS "0065", 
              sum("0171") AS "0171",
              sum("0174") AS "0174", 
              sum("0188") AS "0188",
              sum("0202") AS "0202", 
              sum("0211") AS "0211", 
              sum("0259") AS "0259", 
              sum("0502") AS "0502",
              sum("0503") AS "0503", 
              sum("0510") AS "0510", 
              sum("0530") AS "0530", 
              sum("0546") AS "0546", 
              sum("0554") AS "0554",
              sum("0560") AS "0560", 
              sum("0580") AS "0580"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe_dip_paso2017, "../../data/21.SANTA_FE/sfe_dip_paso2017.csv")

```
-
##### SANTIAGO DEL ESTERO  

```{sql santiago_dip_paso2017, connection=Arg17P,  output.var="santiago_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0174",	
"0502",	
"0541",	
"0558")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0541"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0558"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0174") AS "0174", 
              sum("0502") AS "0502", 
              sum("0541") AS "0541",
              sum("0558") AS "0558"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(santiago_dip_paso2017, "../../data/22.SANTIAGO_DEL_ESTERO/santiago_dip_paso2017.csv")

```

-
##### TUCUMAN 

```{sql tucuman_dip_paso2017, connection=Arg17P,  output.var="tucuman_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0170",	
"0180",	
"0503",	
"0521",	 	
"0533",			
"0548")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0170"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0180"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0521"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0533"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0548"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0170") AS "0170", 
              sum("0180") AS "0180", 
              sum("0503") AS "0503",
              sum("0521") AS "0521", 
              sum("0533") AS "0533",
              sum("0548") AS "0548"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucuman_dip_paso2017, "../../data/23.TUCUMAN/tucuman_dip_paso2017.csv")

```

-
##### TIERRA DEL FUEGO 

```{sql tdf_dip_paso2017, connection=Arg17P,  output.var="tdf_dip_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0072",		
"0076",	
"0083",	
"0167",	
"0174",	 	
"0194",			
"0207",		
"0524",	
"0540",	
"0563",	
"0579")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0076"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0083"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0167"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0207"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0524"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0540"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0563"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0579"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0072") AS "0072", 
              sum("0076") AS "0076", 
              sum("0083") AS "0083", 
              sum("0167") AS "0167",
              sum("0174") AS "0174", 
              sum("0194") AS "0194",
              sum("0207") AS "0207", 
              sum("0524") AS "0524", 
              sum("0540") AS "0540", 
              sum("0563") AS "0563",
              sum("0579") AS "0579"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdf_dip_paso2017, "../../data/24.TIERRA_DEL_FUEGO/tdf_dip_paso2017.csv")

```



#### GENERAL

##### CABA 

```{sql caba_dip_gral2017, connection=Arg17G,  output.var="caba_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0187",		
"0503",	
"0515",	
"0531",	
"0576",	 	
"0580")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0515"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0531"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0576"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0580"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '01'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0187") AS "0187", 
              sum("0503") AS "0503", 
              sum("0515") AS "0515", 
              sum("0531") AS "0531",
              sum("0576") AS "0576", 
              sum("0580") AS "0580"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(caba_dip_gral2017, "../../data/01.CABA/caba_dip_gral2017.csv")

```

-
##### PBA 

```{sql pba_dip_gral2017, connection=Arg17G,  output.var="pba_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0503",		
"0511",	
"0518",	
"0546",	
"0574")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0511"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0518"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0574"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '02'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0503") AS "0503", 
              sum("0511") AS "0511", 
              sum("0518") AS "0518", 
              sum("0546") AS "0546",
              sum("0574") AS "0574"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_dip_gral2017, "../../data/02.PBA/pba_dip_gral2017.csv")

```

-
##### CATAMARCA 

```{sql catamarca_dip_gral2017, connection=Arg17G,  output.var="catamarca_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0194",		
"0542",	
"0544",	
"0547")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0542"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0544"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0547"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '03'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0194") AS "0194", 
              sum("0542") AS "0542", 
              sum("0544") AS "0544", 
              sum("0547") AS "0547"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(catamarca_dip_gral2017, "../../data/03.CATAMARCA/catamarca_dip_gral2017.csv")

```

-
##### CORDOBA 

```{sql cordoba_dip_gral2017, connection=Arg17G,  output.var="cordoba_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0201",		
"0217",	
"0502",	
"0503",	
"0543",	 	
"0567",			
"0578")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0201"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0217"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0543"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0578"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '04'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0201") AS "0201", 
              sum("0217") AS "0217", 
              sum("0502") AS "0502", 
              sum("0503") AS "0503",
              sum("0543") AS "0543", 
              sum("0567") AS "0567",
              sum("0578") AS "0578"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordoba_dip_gral2017, "../../data/04.CORDOBA/cordoba_dip_gral2017.csv")

```

-
##### CORRIENTES 

```{sql Corrientes_dip_gral2017, connection=Arg17G,  output.var="Corrientes_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0528",		
"0557",	
"0568",	
"0571")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0528"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0557"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0568"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0571"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '05'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0528") AS "0528", 
              sum("0557") AS "0557", 
              sum("0568") AS "0568", 
              sum("0571") AS "0571"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(Corrientes_dip_gral2017, "../../data/05.CORRIENTES/corrientes_dip_gral2017.csv")

```


-
##### CHACO 

```{sql chaco_dip_gral2017, connection=Arg17G,  output.var="chaco_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0071",		
"0502",	
"0537",	
"0572",	
"0574")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0537"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0572"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0574"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '06'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0071") AS "0071", 
              sum("0502") AS "0502", 
              sum("0537") AS "0537", 
              sum("0572") AS "0572",
              sum("0574") AS "0574"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chaco_dip_gral2017, "../../data/06.CHACO/chaco_dip_gral2017.csv")

```

-
##### CHUBUT 

```{sql chubut_dip_gral2017, connection=Arg17G,  output.var="chubut_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0071",	
"0074",	
"0153",	
"0501",	 	
"0519",			
"0538")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0074"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0519"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0538"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '07'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0071") AS "0071", 
              sum("0074") AS "0074", 
              sum("0153") AS "0153",
              sum("0501") AS "0501", 
              sum("0519") AS "0519",
              sum("0538") AS "0538"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubut_dip_gral2017, "../../data/07.CHUBUT/chubut_dip_gral2017.csv")

```

-
##### ENTRE RIOS 

```{sql erios_dip_gral2017, connection=Arg17G,  output.var="erios_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0050",		
"0186",	
"0502",	
"0550")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0550"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '08'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0050") AS "0050", 
              sum("0186") AS "0186", 
              sum("0502") AS "0502", 
              sum("0550") AS "0550"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(erios_dip_gral2017, "../../data/08.ENTRE_RIOS/erios_dip_gral2017.csv")

```

-
##### FORMOSA 

```{sql formosa_dip_gral2017, connection=Arg17G,  output.var="formosa_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0194",		
"0212",	
"0505",	
"0532")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0212"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0532"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '09'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0194") AS "0194", 
              sum("0212") AS "0212", 
              sum("0505") AS "0505", 
              sum("0532") AS "0532"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_dip_gral2017, "../../data/09.FORMOSA/formosa_dip_gral2017.csv")

```

-
##### JUJUY 

```{sql jujuy_dip_gral2017, connection=Arg17G,  output.var="jujuy_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0210",	
"0503",	
"0545",	
"0546",	 	
"0558")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0210"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0558"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '10'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0210") AS "0210", 
              sum("0503") AS "0503", 
              sum("0545") AS "0545",
              sum("0546") AS "0546", 
              sum("0558") AS "0558"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_dip_gral2017, "../../data/10.JUJUY/jujuy_dip_gral2017.csv")

```

-
##### LA PAMPA 

```{sql pampa_dip_gral2017, connection=Arg17G,  output.var="pampa_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0022",	
"0190",	
"0536",	
"0555",	 	
"0567")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0190"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0536"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0555"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '11'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0022") AS "0022", 
              sum("0190") AS "0190", 
              sum("0536") AS "0536",
              sum("0555") AS "0555", 
              sum("0567") AS "0567"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pampa_dip_gral2017, "../../data/11.LA_PAMPA/pampa_dip_gral2017.csv")

```


-
##### LA RIOJA 

```{sql rioja_dip_gral2017, connection=Arg17G,  output.var="rioja_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0159",		
"0503",	
"0514",	
"0517",	
"0549",	 	
"0567",			
"0573")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0159"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0549"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0573"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '12'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0159") AS "0159", 
              sum("0503") AS "0503", 
              sum("0514") AS "0514", 
              sum("0517") AS "0517",
              sum("0549") AS "0549", 
              sum("0567") AS "0567",
              sum("0573") AS "0573"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_dip_gral2017, "../../data/12.LA_RIOJA/rioja_dip_gral2017.csv")

```

-
##### MENDOZA 

```{sql mendoza_dip_gral2017, connection=Arg17G,  output.var="mendoza_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0006",		
"0502",	
"0503",	
"0562")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0562"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '13'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0006") AS "0006", 
              sum("0502") AS "0502", 
              sum("0503") AS "0503", 
              sum("0562") AS "0562"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendoza_dip_gral2017, "../../data/13.MENDOZA/mendoza_dip_gral2017.csv")

```

-
##### MISIONES 

```{sql misiones_dip_gral2017, connection=Arg17G,  output.var="misiones_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0071",	
"0072",	
"0165",	
"0184",	 	
"0534",			
"0535",		
"0559")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0165"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0184"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0534"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0535"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0559"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '14'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0071") AS "0071", 
              sum("0072") AS "0072", 
              sum("0165") AS "0165",
              sum("0184") AS "0184", 
              sum("0534") AS "0534",
              sum("0535") AS "0535", 
              sum("0559") AS "0559"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_dip_gral2017, "../../data/14.MISIONES/misiones_dip_gral2017.csv")

```

-
##### NEUQUEN 

```{sql neuquen_dip_gral2017, connection=Arg17G,  output.var="neuquen_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0040",		
"0151",	
"0186",	
"0502",	
"0503",	 	
"0513",			
"0551",		
"0575")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0151"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0513"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0551"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0575"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '15'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0040") AS "0040", 
              sum("0151") AS "0151", 
              sum("0186") AS "0186", 
              sum("0502") AS "0502",
              sum("0503") AS "0503", 
              sum("0513") AS "0513",
              sum("0551") AS "0551", 
              sum("0575") AS "0575"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquen_dip_gral2017, "../../data/15.NEUQUEN/neuquen_dip_gral2017.csv")

```


-
##### RIO NEGRO 

```{sql rnegro_dip_gral2017, connection=Arg17G,  output.var="rnegro_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0047",		
"0050",	
"0501",	
"0503",	
"0523",	 	
"0567")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0523"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '16'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0047") AS "0047", 
              sum("0050") AS "0050", 
              sum("0501") AS "0501", 
              sum("0503") AS "0503",
              sum("0523") AS "0523", 
              sum("0567") AS "0567"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegro_dip_gral2017, "../../data/16.RIO_NEGRO/rnegro_dip_gral2017.csv")

```

-
##### SALTA 

```{sql salta_dip_gral2017, connection=Arg17G,  output.var="salta_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0203",	
"0503",	
"0520",	
"0539",	 	
"0553",			
"0566")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0203"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0520"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0539"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0553"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0566"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '17'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0203") AS "0203", 
              sum("0503") AS "0503", 
              sum("0520") AS "0520",
              sum("0539") AS "0539", 
              sum("0553") AS "0553",
              sum("0566") AS "0566"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(salta_dip_gral2017, "../../data/17.SALTA/salta_dip_gral2017.csv")

```

-
##### SAN JUAN 

```{sql sjuan_dip_gral2017, connection=Arg17G,  output.var="sjuan_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0172",		
"0182",	
"0186",	
"0512",	
"0522",	 	
"0556",			
"0564")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0172"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0182"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0186"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0512"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0556"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0564"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '18'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0172") AS "0172", 
              sum("0182") AS "0182", 
              sum("0186") AS "0186", 
              sum("0512") AS "0512",
              sum("0522") AS "0522", 
              sum("0556") AS "0556",
              sum("0564") AS "0564"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_dip_gral2017, "../../data/18.SAN_JUAN/sjuan_dip_gral2017.csv")

```

-
##### SAN LUIS 

```{sql sluis_dip_gral2017, connection=Arg17G,  output.var="sluis_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0070",		
"0516",	
"0565")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0070"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0516"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0565"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '19'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0070") AS "0070", 
              sum("0516") AS "0516", 
              sum("0565") AS "0565"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_dip_gral2017, "../../data/19.SAN_LUIS/sluis_dip_gral2017.csv")

```



-
##### SANTA CRUZ 

```{sql scruz_dip_gral2017, connection=Arg17G,  output.var="scruz_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0083",		
"0176",	
"0501",	
"0504",	
"0567",	 	
"0577")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0083"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0176"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0577"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '20'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0083") AS "0083", 
              sum("0176") AS "0176", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0567") AS "0567", 
              sum("0577") AS "0577"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_dip_gral2017, "../../data/20.SANTA_CRUZ/scruz_dip_gral2017.csv")

```

-
##### SANTA FE 

```{sql sfe_dip_gral2017, connection=Arg17G,  output.var="sfe_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0174",		
"0188",	
"0202",	
"0502",	
"0503",	 	
"0510",			
"0530",		
"0546",	
"0554",	
"0560")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0202"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0530"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0554"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0560"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '21'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0174") AS "0174", 
              sum("0188") AS "0188", 
              sum("0202") AS "0202", 
              sum("0502") AS "0502",
              sum("0503") AS "0503", 
              sum("0510") AS "0510",
              sum("0530") AS "0530", 
              sum("0546") AS "0546", 
              sum("0554") AS "0554", 
              sum("0560") AS "0560"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe_dip_gral2017, "../../data/21.SANTA_FE/sfe_dip_gral2017.csv")

```
-
##### SANTIAGO DEL ESTERO  

```{sql santiago_dip_gral2017, connection=Arg17G,  output.var="santiago_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0174",	
"0502",	
"0541",	
"0558")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0502"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0541"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0558"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '22'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0174") AS "0174", 
              sum("0502") AS "0502", 
              sum("0541") AS "0541",
              sum("0558") AS "0558"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(santiago_dip_gral2017, "../../data/22.SANTIAGO_DEL_ESTERO/santiago_dip_gral2017.csv")

```

-
##### TUCUMAN 

```{sql tucuman_dip_gral2017, connection=Arg17G,  output.var="tucuman_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0180",		
"0503",	
"0521",	
"0548")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0180"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0521"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0548"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '23'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0180") AS "0180", 
              sum("0503") AS "0503", 
              sum("0521") AS "0521", 
              sum("0548") AS "0548"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucuman_dip_gral2017, "../../data/23.TUCUMAN/tucuman_dip_gral2017.csv")

```

-
##### TIERRA DEL FUEGO 

```{sql tdf_dip_gral2017, connection=Arg17G,  output.var="tdf_dip_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0072",		
"0167",	
"0194",	
"0207",	
"0524",	 	
"0540",			
"0563")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0167"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0207"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0524"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0540"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0563"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaDNacionales
        WHERE
        vot_proCodigoProvincia = '24'
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0072") AS "0072", 
              sum("0167") AS "0167", 
              sum("0194") AS "0194", 
              sum("0207") AS "0207",
              sum("0524") AS "0524", 
              sum("0540") AS "0540",
              sum("0563") AS "0563"
        FROM
        votos
           INNER JOIN MesasDNacionales ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdf_dip_gral2017, "../../data/24.TIERRA_DEL_FUEGO/tdf_dip_gral2017.csv")

```














