---
title: "Resultados Senadores Nacionales"
output: html_notebook
---


## GRUPOS DE PROVINCIAS


```{r librerias, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
```



```{sql Deptos_Provincias, connection=Arg07,output.var = "Deptos_Provincias"}
SELECT DISTINCT
depCodigoDepartamento,
dep_proCodigoProvincia,
depNombre
FROM
Departamento
```




Grupos de provincia que eligen alternadamente Senadores Nacionales cada dos a√±os. 

```{r grupos_codprov}


grupo1 <-  c("03", "04", "05", "07", "11", "13", "21", "23")

grupo2 <- c("02", "09", "10", "12", "14", "18", "19", "20")


grupo3 <- c("01",  "06", "08", "15", "16", "17", "22", "24")


```





# GRUPO 1 

## 2009 

### CATAMARCA

```{sql Votos_Generales2009_Catamarca, connection=Arg09,  output.var="catamarca2009G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0036",	
"0501",	
"0504",	 	
"0523",			
"0537")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0523"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0537"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '03' --CATAMARCA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0036") AS "0036", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0523") AS "0523", 
              sum("0537") AS "0537"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```

```{r}

write_csv(catamarca2009G, "../3.CATAMARCA/catamarca_sen_gral2009.csv")

```


### CORDOBA

```{sql Votos_Generales2009_Cordoba, connection=Arg09,  output.var="cordoba2009G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0003",	
"0014",	
"0038",	 	
"0128",			
"0144",			
"0145",			
"0148",			
"0507",			
"0564",			
"0565",			
"0566",			
"0567")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0128"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0144"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0145"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0148"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0564"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0565"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0566"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '04' --CORDOBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038",
              sum("0128") AS "0128", 
              sum("0144") AS "0144",
              sum("0145") AS "0145", 
              sum("0148") AS "0148", 
              sum("0507") AS "0507", 
              sum("0564") AS "0564",
              sum("0565") AS "0565", 
              sum("0566") AS "0566", 
              sum("0566") AS "0567"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordoba2009G, "../4.CORDOBA/corodba_sen_gral2009.csv")

```



### CORRIENTES


```{sql Votos_Generales2009_Corrientes, connection=Arg09,  output.var="corrientes2009G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0002",	
"0003",	
"0005",	 	
"0006",			
"0008",			
"0009",			
"0012",			
"0019",			
"0020",			
"0033",			
"0036",
"0040",		
"0044",	
"0047",	
"0048",	 	
"0050",			
"0056",			
"0120",			
"0289",			
"0290",			
"0291",			
"0292",
"0293",		
"0543",	
"0543",	
"0586",	
"0587")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0006"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0008"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0009"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0019"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0033"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0040"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0120"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0289"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0290"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0291"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0292"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0293"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0543"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0543"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0586"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0587"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '05' --CORDOBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0005") AS "0005",
              sum("0006") AS "0006", 
              sum("0008") AS "0008",
              sum("0009") AS "0009", 
              sum("0012") AS "0012", 
              sum("0019") AS "0019", 
              sum("0020") AS "0020",
              sum("0033") AS "0033", 
              sum("0036") AS "0036",
              sum("0040") AS "0040", 
              sum("0044") AS "0044", 
              sum("0047") AS "0047", 
              sum("0048") AS "0048",
              sum("0050") AS "0050", 
              sum("0056") AS "0056",
              sum("0120") AS "0120", 
              sum("0289") AS "0289", 
              sum("0290") AS "0290", 
              sum("0291") AS "0291",
              sum("0292") AS "0292", 
              sum("0293") AS "0293",
              sum("0543") AS "0543", 
              sum("0543") AS "0543", 
              sum("0586") AS "0586", 
              sum("0586") AS "0587"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(corrientes2009G, "../5.CORRIENTES/corrientes_sen_gral2009.csv")

```


### CHUBUT


```{sql Votos_Generales2009_Chubut, connection=Arg09,  output.var="chubut2009G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0038",	
"0047",	
"0105",	 	
"0109",			
"0513",
"0529")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0105"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0109"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0513"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0529"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '07' --CHUBUT
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0038") AS "0038", 
              sum("0047") AS "0047", 
              sum("0105") AS "0105",
              sum("0109") AS "0109", 
              sum("0513") AS "0513", 
              sum("0529") AS "0529"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubut2009G, "../7.CHUBUT/chubut_sen_gral2009.csv")

```



### LA PAMPA

```{sql Votos_Generales2009_Pampa, connection=Arg09,  output.var="pampa2009G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0101",	
"0126",	
"0135",	 	
"0507",			
"0521",
"0538")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0101"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0126"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0507"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0521"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0538"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '11' --PAMPA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0101") AS "0101", 
              sum("0126") AS "0126", 
              sum("0135") AS "0135",
              sum("0507") AS "0507", 
              sum("0521") AS "0521", 
              sum("0538") AS "0538"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```



```{r}

write_csv(pampa2009G, "../11.LA_PAMPA/pampa_sen_gral2009.csv")

```



### MENDOZA

```{sql Votos_Generales2009_Mendoza, connection=Arg09,  output.var="mendoza2009G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0038",	
"0045",	
"0050",	 	
"0165",			
"0167",			
"0168",			
"0169",			
"0501",			
"0572",			
"0573",			
"0574")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0165"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0167"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0168"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0169"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0572"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0573"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0574"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '13' --MENDOZA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0045") AS "0045", 
              sum("0050") AS "0050",
              sum("0165") AS "0165", 
              sum("0167") AS "0167",
              sum("0168") AS "0168", 
              sum("0169") AS "0169", 
              sum("0501") AS "0501", 
              sum("0572") AS "0572",
              sum("0573") AS "0573", 
              sum("0574") AS "0574"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendoza2009G, "../13.MENDOZA/mendoza_sen_gral2009.csv")

```



### SANTA FE



```{sql Votos_Generales2009_Sfe, connection=Arg09,  output.var="sfe2009G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0030",	
"0033",	
"0036",	 	
"0037",			
"0038",			
"0042",			
"0045",			
"0122",			
"0123",			
"0127",			
"0512",		
"0524",	
"0534")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0030"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0033"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0037"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0042"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0122"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0123"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0127"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0512"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0524"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0534"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '21' --MENDOZA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0030") AS "0030", 
              sum("0033") AS "0033", 
              sum("0036") AS "0036",
              sum("0037") AS "0037", 
              sum("0038") AS "0038",
              sum("0042") AS "0042", 
              sum("0045") AS "0045", 
              sum("0122") AS "0122", 
              sum("0123") AS "0123",
              sum("0127") AS "0127", 
              sum("0512") AS "0512", 
              sum("0524") AS "0524", 
              sum("0534") AS "0534"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe2009G, "../21.SANTA_FE/sfe_sen_gral2009.csv")

```




### TUCUMAN

```{sql Votos_Generales2009_Tucuman, connection=Arg09,  output.var="tucuman2009G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0014",	
"0022",	
"0040",	
"0045",	 	
"0112",			
"0119",			
"0124",			
"0130",			
"0160",			
"0501",			
"0527",			
"0536",		
"0563")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0540"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0045"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0112"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0119"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0124"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0130"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0160"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0527"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0536"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0563"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '23' --MENDOZA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0014") AS "0014", 
              sum("0022") AS "0022", 
              sum("0540") AS "0540",
              sum("0045") AS "0045", 
              sum("0112") AS "0112",
              sum("0119") AS "0119", 
              sum("0124") AS "0124", 
              sum("0130") AS "0130", 
              sum("0160") AS "0160",
              sum("0501") AS "0501", 
              sum("0527") AS "0527", 
              sum("0536") AS "0536", 
              sum("0563") AS "0563"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia 
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucuman2009G, "../23.TUCUMAN/tucuman_sen_gral2009.csv")

```






## 2015 



## PASO 


### CATAMARCA

```{sql Votos_Paso201_Catamarca, connection=Arg15P,  output.var="catamarca2015P"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0131",	
"0161",	
"0521",	 	
"0524",			
"0528")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0161"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0521"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0524"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0528"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '03' --CATAMARCA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0131") AS "0131", 
              sum("0161") AS "0161", 
              sum("0521") AS "0521",
              sum("0524") AS "0524", 
              sum("0528") AS "0528"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia -- cambio base y tablas
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```

```{r}

write_csv(catamarca2015P, "../3.CATAMARCA/catamarca_sen_paso2015.csv")

```


### CORDOBA

```{sql Votos_PASO2015_Cordoba, connection=Arg15P,  output.var="cordoba2015P"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0013",		
"0038",	
"0063",	
"0065",	 	
"0131",			
"0132",			
"0135",			
"0137",			
"0510")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0013"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0065"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0131"			 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0132"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '04' --CORDOBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0013") AS "0013", 
              sum("0038") AS "0038", 
              sum("0063") AS "0063", 
              sum("0065") AS "0065",
              sum("0131") AS "0131",
              sum("0131") AS "0132", 
              sum("0135") AS "0135",
              sum("0137") AS "0137", 
              sum("0510") AS "0510"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordoba2015P, "../4.CORDOBA/corodba_sen_paso2015.csv")

```



### CORRIENTES


```{sql Votos_PASO2015_Corrientes, connection=Arg15P,  output.var="corrientes2015P"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0063",		
"0072",	
"0131",	
"0132",	 	
"0134",			
"0138",			
"0519")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0063"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0519"		 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '05' --CORRIENTES
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0063") AS "0063", 
              sum("0072") AS "0072", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0134") AS "0134", 
              sum("0138") AS "0138",
              sum("0519") AS "0519"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(corrientes2015P, "../5.CORRIENTES/corrientes_sen_paso2015.csv")

```


### CHUBUT


```{sql Votos_Paso2015_Chubut, connection=Arg15P,  output.var="chubut2015P"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0060",	
"0074",	
"0152",	 	
"0157",			
"0501",
"0530",
"0531")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0074"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0152"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0157"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0530"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0531"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '07' --CHUBUT
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0060") AS "0060", 
              sum("0074") AS "0074", 
              sum("0152") AS "0152",
              sum("0157") AS "0157", 
              sum("0501") AS "0501", 
              sum("0530") AS "0530", 
              sum("0531") AS "0531"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubut2015P, "../7.CHUBUT/chubut_sen_paso2015.csv")

```



### LA PAMPA

```{sql Votos_paso2015_Pampa, connection=Arg15P,  output.var="pampa2015P"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0030",		
"0131",	
"0132",	
"0135",	 	
"0137",			
"0138")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0030"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '11' --PAMPA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0030") AS "0030", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0135") AS "0135",
              sum("0137") AS "0137", 
              sum("0138") AS "0138"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```



```{r}

write_csv(pampa2015P, "../11.LA_PAMPA/pampa_sen_paso2015.csv")

```



### MENDOZA

```{sql Votos_paso2015_Mendoza, connection=Arg15P,  output.var="mendoza2015P"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0063",	
"0501",	
"0504",	 	
"0506",			
"0514",			
"0527")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0506"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0527"		 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '13' --MENDOZA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0063") AS "0063", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0506") AS "0506", 
              sum("0514") AS "0514",
              sum("0527") AS "0527"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe2015P, "../13.MENDOZA/mendoza_sen_paso2015.csv")

```



### SANTA FE



```{sql Votos_paso2015_Sfe, connection=Arg15P,  output.var="sfe2015P"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0081",		
"0131",	
"0133",	
"0134",	 	
"0135",			
"0136",			
"0137",			
"0138",			
"0180",			
"0188",			
"0525")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0081"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0180"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0525"			 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '21' --MENDOZA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0081") AS "0081", 
              sum("0131") AS "0131", 
              sum("0133") AS "0133", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0136") AS "0136",
              sum("0137") AS "0137", 
              sum("0138") AS "0138", 
              sum("0180") AS "0180", 
              sum("0188") AS "0188",
              sum("0525") AS "0525"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe2015P, "../21.SANTA_FE/sfe_sen_paso2015.csv")

```




### TUCUMAN

```{sql Votos_paso2015_Tucuman, connection=Arg15G,  output.var="tucuman2015P"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0060",	
"0136",	
"0137",	
"0177",	 	
"0501",			
"0522")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0177"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0522"		 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '23' --MENDOZA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0060") AS "0060", 
              sum("0136") AS "0136", 
              sum("0137") AS "0137",
              sum("0177") AS "0177", 
              sum("0501") AS "0501",
              sum("0522") AS "0522"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucuman2015P, "../23.TUCUMAN/tucuman_sen_paso2015.csv")

```










## GRAL

### CATAMARCA

```{sql Votos_Gral2015_Catamarca, connection=Arg15G,  output.var="catamarca2015G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",	
"0524",			
"0528")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0524"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0528"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '03' --CATAMARCA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0524") AS "0524", 
              sum("0528") AS "0528"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia -- cambio base y tablas
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```

```{r}

write_csv(catamarca2015G, "../3.CATAMARCA/catamarca_sen_gral2015.csv")

```


### CORDOBA

```{sql Votos_GRAL2015_Cordoba, connection=Arg15G,  output.var="cordoba2015G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0063",	
"0131",			
"0132",			
"0135",			
"0137",			
"0510")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"			 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0132"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '04' --CORDOBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0063") AS "0063", 
              sum("0131") AS "0131",
              sum("0131") AS "0132", 
              sum("0135") AS "0135",
              sum("0137") AS "0137", 
              sum("0510") AS "0510"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(cordoba2015G, "../4.CORDOBA/corodba_sen_gral2015.csv")

```



### CORRIENTES


```{sql Votos_GRAL2015_Corrientes, connection=Arg15G,  output.var="corrientes2015G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",	
"0138",			
"0519")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0519"		 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '05' --CORRIENTES
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0138") AS "0138",
              sum("0519") AS "0519"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(corrientes2015G, "../5.CORRIENTES/corrientes_sen_gral2015.csv")

```


### CHUBUT

(Entre PASO y GENERAL FPV cambi√≥ de 0501 a 0131)

```{sql Votos_GRAL2015_Chubut, connection=Arg15G,  output.var="chubut2015G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",	 
"0152",	 	
"0530",
"0531")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0152"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0530"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0531"	 	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '07' --CHUBUT
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0152") AS "0152", 
              sum("0530") AS "0530", 
              sum("0531") AS "0531"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chubut2015G, "../07.CHUBUT/chubut_sen_gral2015.csv")

```



### LA PAMPA

No hay coincidencias entre numeros de listas y frentes entre PASO y GENERAL. 
Chequeados en Andy Tow y tambien hay problemas. 


```{sql Votos_GRAL2015_Pampa, connection=Arg15G,  output.var="pampa2015G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0069",		
"0131",	
"0184",	
"0534")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0069"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0184"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0534"	 	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '11' --PAMPA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0069") AS "0069",  
              sum("0131") AS "0131",  
              sum("0184") AS "0184",  
              sum("0534") AS "0534"  
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```



```{r}

write_csv(pampa2015G, "../11.LA_PAMPA/pampa_sen_gral2015.csv")

```



### MENDOZA

Cambio de numeracion listas FPV, Cambiemos y FIT entre PASO y Generales

```{sql Votos_GRAL2015_Mendoza, connection=Arg15G,  output.var="mendoza2015G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0063",	
"0131",	
"0135",	 	
"0137",			
"0527")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0063"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0527"			 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '13' --MENDOZA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0063") AS "0063", 
              sum("0131") AS "0131", 
              sum("0135") AS "0135", 
              sum("0137") AS "0137",
              sum("0527") AS "0527"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(mendoza2015G, "../13.MENDOZA/mendoza_sen_gral2015.csv")

```



### SANTA FE



```{sql Votos_GRAL2015_Sfe, connection=Arg15G,  output.var="sfe2015G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",	
"0133",	
"0135",			
"0137",			
"0138",			
"0525")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0525"			 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '21' --MENDOZA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0133") AS "0133", 
              sum("0135") AS "0135", 
              sum("0137") AS "0137", 
              sum("0138") AS "0138", 
              sum("0525") AS "0525"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sfe2015G, "../21.SANTA_FE/sfe_sen_gral2015.csv")

```




### TUCUMAN

```{sql Votos_GRAL2015_Tucuman, connection=Arg15G,  output.var="tucuman2015G"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0131",		
"0135",	
"0137",	
"0177")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0131"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0177"	 	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '23' --MENDOZA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0131") AS "0131", 
              sum("0135") AS "0135", 
              sum("0137") AS "0137", 
              sum("0177") AS "0177"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tucuman2015G, "../23.TUCUMAN/tucuman_sen_gral2015.csv")

```




# GRUPO 2
## 2005
## GRAL



### PBA


```{sql Votos_General2005_pba, connection=Arg05,  output.var="pba_gral2005"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003", 
"0014", 
"0022", 
"0038", 
"0047", 
"0051", 
"0101", 
"0102", 
"0104", 
"0126", 
"0127", 
"0135", 
"0181", 
"0298", 
"0299", 
"0313", 
"0314" )
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
            max(CASE WHEN vot_parCodigo = "0003" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0014" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0022" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0038" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0047" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0051" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0101" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0102" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0104" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0126" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0127" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0135" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0181" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0298" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0299" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0313" THEN votVotosPartido END),
            max(CASE WHEN vot_parCodigo = "0314" THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '02' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
            sum("0003") AS "0003",      
            sum("0014") AS "0014",   
            sum("0022") AS "0022",   
            sum("0038") AS "0038",   
            sum("0047") AS "0047",   
            sum("0051") AS "0051",   
            sum("0101") AS "0101",   
            sum("0102") AS "0102",   
            sum("0104") AS "0104",   
            sum("0126") AS "0126",   
            sum("0127") AS "0127",   
            sum("0135") AS "0135",   
            sum("0181") AS "0181",   
            sum("0298") AS "0298",   
            sum("0299") AS "0299",   
            sum("0313") AS "0313",   
            sum("0314") AS "0314"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_gral2005, "../../data/02.PBA/ /2.PBA/pba_sen_gral2005.csv")

```




### FORMOSA
cambio de cod partido de paso a generales  
Fortaleza (de 0193 a 0183)
FPV (de 0501 a 0603)

```{sql Votos_General2005_formosa, connection=Arg05,  output.var="formosa_gral2005"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",	
"0003",			
"0047",
"0054",	
"0101",			
"0187",
"0198")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0054"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0101"			 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0198"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '09' --FORMOSA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0003") AS "0003", 
              sum("0047") AS "0047",
              sum("0054") AS "0054", 
              sum("0101") AS "0101", 
              sum("0187") AS "0187",
              sum("0198") AS "0198"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia -- cambio base y tablas
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_gral2005, "../../data/09.FORMOSA/formosa_sen_gral2005.csv")

```



### JUJUY



```{sql Votos_General2005_jujuy, connection=Arg05,  output.var="jujuy_gral2005"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0022",	
"0038",	
"0045",
"0101",		
"0111",	
"0281",		
"0505",	
"0506",		
"0507")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0101"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0111"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0281"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0506"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0507"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '10' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0022") AS "0022", 
              sum("0038") AS "0038", 
              sum("0045") AS "0045",
              sum("0101") AS "0101", 
              sum("0111") AS "0111", 
              sum("0281") AS "0281",
              sum("0505") AS "0505", 
              sum("0506") AS "0506", 
              sum("0507") AS "0507"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_gral2005, "../../data/10.JUJUY/jujuy_sen_gral2005.csv")

```




### LA RIOJA



```{sql Votos_General2005_rioja, connection=Arg05,  output.var="rioja_gral2005"}

WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",	
"0003",			
"0022",
"0054",	
"0304")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0054"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0304"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '12' --RIOJA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0022") AS "0022",
              sum("0054") AS "0054", 
              sum("0304") AS "0304"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia -- cambio base y tablas
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;

```



```{r}

write_csv(rioja_gral2005, "../../data/12.LA_RIOJA/rioja_sen_gral2005.csv")

```




### MISIONES



```{sql Votos_General2005_misiones, connection=Arg05,  output.var="misiones_gral2005"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0041",	
"0047",	
"0050",
"0111",		
"0219",	
"0269",	
"0270",
"0271",		
"0272")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0041"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0111"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0219"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0269"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0270"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0271"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0272"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '14' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0041") AS "0041", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050",
              sum("0111") AS "0111", 
              sum("0219") AS "0219", 
              sum("0269") AS "0269", 
              sum("0270") AS "0270",
              sum("0271") AS "0271", 
              sum("0272") AS "0272"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_gral2005, "../../data/14.MISIONES/misiones_sen_gral2005.csv")

```


### SAN JUAN



```{sql Votos_General2005_sanJuan, connection=Arg05,  output.var="sjuan_gral2005"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0047",	
"0052",	
"0101",
"0161",		
"0169",	
"0170",
"0171",		
"0172")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0052"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0101"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0161"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0169"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0170"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0171"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0172"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales 
        WHERE
        vot_proCodigoProvincia = '18' --san juan 
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0047") AS "0047", 
              sum("0052") AS "0052", 
              sum("0101") AS "0101",
              sum("0161") AS "0161", 
              sum("0169") AS "0169", 
              sum("0170") AS "0170",
              sum("0171") AS "0171", 
              sum("0172") AS "0172"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_gral2005, "../../data/18.SAN_JUAN/sjuan_sen_gral2005.csv")

```



### SAN LUIS


```{sql Votos_General2005_sluis, connection=Arg05,  output.var="sluis_gral2005"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0037",	
"0050",
"0101",		
"0174",	
"0175",
"0176",
"0177",		
"0178",	
"0297")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0101"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0174"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0175"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0176"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0177"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0178"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0297"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '19' --SAN LUIS
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0037") AS "0037", 
              sum("0050") AS "0050",
              sum("0101") AS "0101", 
              sum("0174") AS "0174", 
              sum("0175") AS "0175",
              sum("0176") AS "0176", 
              sum("0177") AS "0177", 
              sum("0178") AS "0178",
              sum("0297") AS "0297"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_gral2005, "../../data/19.SAN_LUIS/sluis_sen_gral2005.csv")

```



### SANTA CRUZ



```{sql Votos_Gral2005_santacruz, connection=Arg05,  output.var="scruz_gral2005"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0050",	
"0101",	
"0154")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0101"	THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0154"	THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '20' --SANTA CRUZ
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0050") AS "0050", 
              sum("0101") AS "0101", 
              sum("0154") AS "0154"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_gral2005, "../../data/20.SANTA_CRUZ/scruz_sen_gral2005.csv")

```









## 2011


## PASO 


### PBA


```{sql Votos_paso2011_pba, connection=Arg11P,  output.var="pba_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0037",		
"0047",	
"0131",	
"0132",
"0133",		
"0134",	
"0135",	
"0136",
"0137",		
"0267",	
"0272",	
"0276")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0037"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0136"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0137"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0267"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0272"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0276"	 	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '02' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0037") AS "0037", 
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0133") AS "0133", 
              sum("0134") AS "0134", 
              sum("0135") AS "0135", 
              sum("0136") AS "0136",
              sum("0137") AS "0137", 
              sum("0267") AS "0267", 
              sum("0272") AS "0272", 
              sum("0276") AS "0276"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_paso2011, "../2.PBA/pba_sen_paso2011.csv")

```




### FORMOSA


```{sql Votos_paso2011_formosa, connection=Arg11P,  output.var="formosa_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0036",	
"0167",
"0181",		
"0193",	
"0501")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0167"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0181"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0193"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '09' --FORMOSA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0036") AS "0036", 
              sum("0167") AS "0167",
              sum("0181") AS "0181", 
              sum("0193") AS "0193", 
              sum("0501") AS "0501"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_paso2011, "../9.FORMOSA/formosa_sen_paso2011.csv")

```





### JUJUY


```{sql Votos_paso2011_jujuy, connection=Arg11P,  output.var="jujuy_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0063",	
"0068",	
"0501",
"0504",		
"0510",	
"0517",	
"0525")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0504"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0510"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0517"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0525"	 	 THEN votVotosPartido END)
        FROM      
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '10' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0063") AS "0063", 
              sum("0068") AS "0068", 
              sum("0501") AS "0501",
              sum("0504") AS "0504", 
              sum("0510") AS "0510", 
              sum("0517") AS "0517", 
              sum("0525") AS "0525"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_paso2011, "../10.JUJUY/jujuy_sen_paso2011.csv")

```





### LA RIOJA


```{sql Votos_PASO2011_rioja, connection=Arg11P,  output.var="rioja_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0037",		
"0047",	
"0131",	
"0132",
"0133",		
"0134",	
"0135")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0037"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '12' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0037") AS "0037", 
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0133") AS "0133", 
              sum("0134") AS "0134", 
              sum("0135") AS "0135"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_paso2011, "../12.LA_RIOJA/rioja_sen_paso2011.csv")

```



### MISIONES



```{sql Votos_PASO2011_misiones, connection=Arg11P,  output.var="misiones_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0050",	
"0166",	
"0501",
"0509",		
"0526",	
"0530",	
"0533")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0166"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0509"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0526"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0530"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0533"	 	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '14' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0050") AS "0050", 
              sum("0166") AS "0166", 
              sum("0501") AS "0501",
              sum("0509") AS "0509", 
              sum("0526") AS "0526", 
              sum("0530") AS "0530", 
              sum("0533") AS "0533"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_paso2011, "../14.MISIONES/misiones_sen_paso2011.csv")

```



### SAN JUAN



```{sql Votos_paso2011_sanjuan, connection=Arg11P,  output.var="sjuan_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0061",	
"0131",	
"0132",
"0133",		
"0153",	
"0168")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0168"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '18' --SAN JUAN
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0061") AS "0061", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0133") AS "0133", 
              sum("0153") AS "0153", 
              sum("0168") AS "0168"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_paso2011, "../18.SAN_JUAN/sjuan_sen_paso2011.csv")

```





### SAN LUIS

```{sql Votos_paso2011_sluis, connection=Arg11P,  output.var="sluis_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0038",	
"0050",	
"0183",
"0501",		
"0509")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0183"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0509"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '19' --SAN LUIS
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0038") AS "0038", 
              sum("0050") AS "0050", 
              sum("0183") AS "0183",
              sum("0501") AS "0501", 
              sum("0509") AS "0509"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_paso2011, "../19.SAN_LUIS/sluis_sen_paso2011.csv")

```




### SANTA CRUZ



```{sql Votos_paso2011_santacruz, connection=Arg11P,  output.var="scruz_paso2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0047",	
"0050",
"0522")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0061"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '20' --SANTA CRUZ
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0061") AS "0061", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0133") AS "0133"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_paso2011, "../../data/20.SANTA_CRUZ/scruz_sen_paso2011.csv")

```


## GRAL



### PBA


```{sql Votos_General2011_pba, connection=Arg11G,  output.var="pba_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0047",	
"0131",	
"0132",
"0133",		
"0134",	
"0135",	
"0137")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '02' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0133") AS "0133", 
              sum("0134") AS "0134", 
              sum("0135") AS "0135", 
              sum("0137") AS "0137"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_gral2011, "../2.PBA/pba_sen_gral2011.csv")

```




### FORMOSA
cambio de cod partido de paso a generales  
Fortaleza (de 0193 a 0183)
FPV (de 0501 a 0603)

```{sql Votos_General2011_formosa, connection=Arg11G,  output.var="formosa_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0181",		
"0183",	
"0603")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0181"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0183"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0603"	 	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '09' --FORMOSA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0181") AS "0181", 
              sum("0183") AS "0183", 
              sum("0603") AS "0603"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_gral2011, "../09.FORMOSA/formosa_sen_gral2011.csv")

```





### JUJUY



```{sql Votos_General2011_jujuy, connection=Arg11G,  output.var="jujuy_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0063",	
"0131",	
"0134",
"0135",		
"0137",	
"0614")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0063"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0135"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0137"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0614"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '10' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0063") AS "0063", 
              sum("0131") AS "0131", 
              sum("0134") AS "0134",
              sum("0135") AS "0135", 
              sum("0137") AS "0137", 
              sum("0614") AS "0614"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_gral2011, "../10.JUJUY/jujuy_sen_gral2011.csv")

```




### LA RIOJA



```{sql Votos_General2011_rioja, connection=Arg11G,  output.var="rioja_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0055",	
"0605",	
"0613")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0055"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0605"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0613"	 	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '12' --RIOJA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0055") AS "0055", 
              sum("0605") AS "0605", 
              sum("0613") AS "0613"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_gral2011, "../12.LA_RIOJA/rioja_sen_gral2011.csv")

```




### MISIONES



```{sql Votos_General2011_misiones, connection=Arg11G,  output.var="misiones_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0050",	
"0603",	
"0615",
"0620",		
"0621")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0603"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0615"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0620"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0621"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '14' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0050") AS "0050", 
              sum("0603") AS "0603", 
              sum("0615") AS "0615",
              sum("0620") AS "0620", 
              sum("0621") AS "0621"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_gral2011, "../14.MISIONES/misiones_sen_gral2011.csv")

```


### SAN JUAN



```{sql Votos_General2011_sanJuan, connection=Arg11G,  output.var="sjuan_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0037",		
"0047",	
"0131",	
"0132",
"0133",		
"0134")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0037"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0133"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '18' --san juan
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0037") AS "0037", 
              sum("0047") AS "0047", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132",
              sum("0133") AS "0133", 
              sum("0134") AS "0134"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_gral2011, "../18.SAN_JUAN/sjuan_sen_gral2011.csv")

```



### SAN LUIS


```{sql Votos_General2011_sluis, connection=Arg11G,  output.var="sluis_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0131",	
"0133")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '19' --SAN LUIS
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0131") AS "0131", 
              sum("0133") AS "0133"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_gral2011, "../19.SAN_LUIS/sluis_sen_gral2011.csv")

```



### SANTA CRUZ



```{sql Votos_Gral2011_santacruz, connection=Arg11G,  output.var="scruz_gral2011"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0047",	
"0050",
"0131",
"0612")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0131"		 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0612"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '20' --SANTA CRUZ
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0047") AS "0047", 
              sum("0050") AS "0050",
              sum("0131") AS "0131",
              sum("0612") AS "0612"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_gral2011, "../20.SANTA_CRUZ/scruz_sen_gral2011.csv")

```





## 2017

## PASO


### PBA



```{sql Votos_paso2017_pba, connection=Arg17P,  output.var="pba_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0022",	
"0259",	
"0268",
"0298",		
"0309",	
"0503",	
"0511",
"0518",		
"0526",	
"0546",	
"0552",	
"0561",	
"0567",	
"0574")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0259"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0268"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0298"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0309"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0511"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0518"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0526"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0552"	 	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0561"	 	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0574"	 	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '02' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0022") AS "0022", 
              sum("0259") AS "0259", 
              sum("0268") AS "0268",
              sum("0298") AS "0298", 
              sum("0309") AS "0309", 
              sum("0503") AS "0503", 
              sum("0511") AS "0511",
              sum("0518") AS "0518", 
              sum("0526") AS "0526", 
              sum("0546") AS "0546", 
              sum("0552") AS "0552", 
              sum("0561") AS "0561", 
              sum("0567") AS "0567", 
              sum("0574") AS "0574"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_paso2017, "../2.PBA/pba_sen_paso2017.csv")

```






### FORMOSA



```{sql Votos_paso2017_formosa, connection=Arg17P,  output.var="formosa_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0050",	
"0194",	
"0211",
"0212",		
"0505",	
"0532")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0050"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0211"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0212"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0532"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '09' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0050") AS "0050", 
              sum("0194") AS "0194", 
              sum("0211") AS "0211",
              sum("0212") AS "0212", 
              sum("0505") AS "0505", 
              sum("0532") AS "0532"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_paso2017, "../9.FORMOSA/jujuy_sen_paso2017.csv")

```




### JUJUY



```{sql Votos_paso2017_jujuy, connection=Arg17P,  output.var="jujuy_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0033",		
"0038",	
"0082",	
"0210",
"0503",		
"0545",	
"0546",	
"0558")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0033"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0082"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0210"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0503"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0558"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '10' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0033") AS "0033", 
              sum("0038") AS "0038", 
              sum("0082") AS "0082", 
              sum("0210") AS "0210",
              sum("0503") AS "0503", 
              sum("0545") AS "0545", 
              sum("0546") AS "0546", 
              sum("0558") AS "0558"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_paso2017, "../10.JUJUY/jujuy_sen_paso2017.csv")

```



### LA RIOJA



```{sql Votos_paso2017_rioja, connection=Arg17P,  output.var="rioja_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0159",		
"0503",	
"0514",	
"0517",
"0549",		
"0567",	
"0573")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0159"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0517"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0549"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0567"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0573"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '12' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0159") AS "0159", 
              sum("0503") AS "0503", 
              sum("0514") AS "0514", 
              sum("0517") AS "0517",
              sum("0549") AS "0549", 
              sum("0567") AS "0567", 
              sum("0573") AS "0573"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_paso2017, "../12.LA_RIOJA/rioja_sen_paso2017.csv")

```


### MISIONES




```{sql Votos_paso2017_misiones, connection=Arg17P,  output.var="misiones_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0071",	
"0072",	
"0082",
"0165",		
"0184",	
"0534",	
"0535",	
"0559")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0082"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0165"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0184"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0534"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0535"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0559"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '14' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0071") AS "0071", 
              sum("0072") AS "0072", 
              sum("0082") AS "0082",
              sum("0165") AS "0165", 
              sum("0184") AS "0184", 
              sum("0534") AS "0534", 
              sum("0535") AS "0535", 
              sum("0559") AS "0559"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_paso2017, "../14.MISIONES/misiones_sen_paso2017.csv")

```




### SAN JUAN




```{sql Votos_paso2017_sjuan, connection=Arg17P,  output.var="sjuan_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0168",	
"0182",	
"0186",
"0512",		
"0522",	
"0556",	
"0564")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0168"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0182"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0186"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0512"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0556"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0564"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '18' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0168") AS "0168", 
              sum("0182") AS "0182", 
              sum("0186") AS "0186",
              sum("0512") AS "0512", 
              sum("0522") AS "0522", 
              sum("0556") AS "0556", 
              sum("0564") AS "0564"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_paso2017, "../18.SAN_JUAN/sjuan_sen_paso2017.csv")

```




### SAN LUIS



```{sql Votos_paso2017_sluis, connection=Arg17P,  output.var="sluis_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",		
"0069",	
"0070",	
"0516",
"0565")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0069"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0070"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0516"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0565"		 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '19' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0069") AS "0069", 
              sum("0070") AS "0070", 
              sum("0516") AS "0516",
              sum("0565") AS "0565"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_paso2017, "../19.SAN_LUIS/sluis_sen_paso2017.csv")

```





### SANTA CRUZ


```{sql Votos_paso2017_scruz, connection=Arg17P,  output.var="scruz_paso2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0083",		
"0176",	
"0501",	
"0504",
"0567",
"0577")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0083"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0176"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0567"		 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0577"		 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '20' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0083") AS "0083", 
              sum("0176") AS "0176", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0567") AS "0567",
              sum("0577") AS "0577"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_paso2017, "../20.SANTA_CRUZ/scruz_sen_paso2017.csv")

```





## GRAL


### PBA


```{sql Votos_gral2017_pba, connection=Arg17G,  output.var="pba_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0503",	
"0511",
"0518",		
"0546",	
"0574")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0511"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0518"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0574"	 	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '02' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0503") AS "0503", 
              sum("0511") AS "0511",
              sum("0518") AS "0518", 
              sum("0546") AS "0546", 
              sum("0574") AS "0574"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(pba_gral2017, "../2.PBA/pba_sen_gral2017.csv")

```






### FORMOSA



```{sql Votos_gral2017_formosa, connection=Arg17G,  output.var="formosa_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0194",	
"0505",	
"0532")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0194"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0532"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '09' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0194") AS "0194", 
              sum("0505") AS "0505", 
              sum("0532") AS "0532"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(formosa_gral2017, "../../data/09.FORMOSA/formosa_sen_gral2017.csv")

```




### JUJUY



```{sql Votos_gral2017_jujuy, connection=Arg17G,  output.var="jujuy_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0038",	
"0210",
"0503",		
"0545",	
"0546",	
"0558")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0210"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0503"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0546"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0558"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '10' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0038") AS "0038", 
              sum("0210") AS "0210",
              sum("0503") AS "0503", 
              sum("0545") AS "0545", 
              sum("0546") AS "0546", 
              sum("0558") AS "0558"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(jujuy_gral2017, "../10.JUJUY/jujuy_sen_gral2017.csv")

```



### LA RIOJA



```{sql Votos_gral2017_rioja, connection=Arg17G,  output.var="rioja_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0159",		
"0503",	
"0514",	
"0517",
"0549",		
"0573")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0159"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0517"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0549"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0573"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '12' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0159") AS "0159", 
              sum("0503") AS "0503", 
              sum("0514") AS "0514", 
              sum("0517") AS "0517",
              sum("0549") AS "0549", 
              sum("0573") AS "0573"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rioja_gral2017, "../12.LA_RIOJA/rioja_sen_gral2017.csv")

```


### MISIONES




```{sql Votos_gral2017_misiones, connection=Arg17G,  output.var="misiones_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0071",	
"0072",	
"0165",		
"0184",	
"0534",	
"0535",	
"0559")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0071"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0072"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0165"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0184"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0534"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0535"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0559"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '14' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0071") AS "0071", 
              sum("0072") AS "0072", 
              sum("0165") AS "0165", 
              sum("0184") AS "0184", 
              sum("0534") AS "0534", 
              sum("0535") AS "0535", 
              sum("0559") AS "0559"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(misiones_gral2017, "../14.MISIONES/misiones_sen_gral2017.csv")

```




### SAN JUAN




```{sql Votos_gral2017_sjuan, connection=Arg17G,  output.var="sjuan_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0182",	
"0186",
"0512",		
"0522",	
"0556",	
"0564")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0182"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0186"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0512"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0522"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0556"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0564"	 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '18' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0182") AS "0182", 
              sum("0186") AS "0186",
              sum("0512") AS "0512", 
              sum("0522") AS "0522", 
              sum("0556") AS "0556", 
              sum("0564") AS "0564"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sjuan_gral2017, "../18.SAN_JUAN/sjuan_sen_gral2017.csv")

```




### SAN LUIS



```{sql Votos_gral2017_sluis, connection=Arg17G,  output.var="sluis_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0070",	
"0516",
"0565")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0070"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0516"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0565"		 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '19' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0070") AS "0070", 
              sum("0516") AS "0516",
              sum("0565") AS "0565"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sluis_gral2017, "../19.SAN_LUIS/sluis_sen_gral2017.csv")

```





### SANTA CRUZ


```{sql Votos_gral2017_scruz, connection=Arg17G,  output.var="scruz_gral2017"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0083",		
"0176",	
"0501",	
"0504",
"0567",
"0577")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0083"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0176"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0567"		 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0577"		 THEN votVotosPartido END)
        FROM
        MesasCandidaturaSNacionales
        WHERE
        vot_proCodigoProvincia = '20' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0083") AS "0083", 
              sum("0176") AS "0176", 
              sum("0501") AS "0501", 
              sum("0504") AS "0504",
              sum("0567") AS "0567",
              sum("0577") AS "0577"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN NomAmbitos ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(scruz_gral2017, "../20.SANTA_CRUZ/scruz_sen_gral2017.csv")

```







# GRUPO 3

## 2007


### CABA




```{sql Votos_gral2007_caba, connection=Arg07,  output.var="caba_gral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",	
"0005",
"0009",		
"0014",	
"0020",	
"0023",
"0036",	
"0037",
"0038",		
"0051",	
"0060",	
"0131",
"0134",	
"0135",
"0136",		
"0138",	
"0139",	
"0140",
"0141",	
"0142",
"0143",		
"0145",	
"0146",
"0147",	
"0188",
"0252",		
"0332")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0009"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0020"	 	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0023"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0036"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0037"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0038"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0051"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0135"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0136"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0138"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0139"	 	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0140"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0141"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0142"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0143"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0145"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0146"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0147"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0188"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0252"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0332"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '01' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0005") AS "0005",
              sum("0009") AS "0009", 
              sum("0014") AS "0014", 
              sum("0020") AS "0020", 
              sum("0023") AS "0023",
              sum("0036") AS "0036", 
              sum("0037") AS "0037",
              sum("0038") AS "0038", 
              sum("0051") AS "0051", 
              sum("0060") AS "0060", 
              sum("0131") AS "0131",
              sum("0134") AS "0134", 
              sum("0135") AS "0135",
              sum("0136") AS "0136", 
              sum("0138") AS "0138", 
              sum("0139") AS "0139", 
              sum("0140") AS "0140",
              sum("0141") AS "0141", 
              sum("0142") AS "0142",
              sum("0143") AS "0143", 
              sum("0145") AS "0145", 
              sum("0146") AS "0146",
              sum("0147") AS "0147", 
              sum("0188") AS "0188",
              sum("0252") AS "0252", 
              sum("0332") AS "0332"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(caba_gral2007, "../1.CABA/caba_sen_gral2007.csv")

```









### CHACO



```{sql Votos_gral2007_chaco, connection=Arg07,  output.var="chaco_gral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0047",		
"0060",
"0163",		
"0168",		
"0169",
"0170",		
"0171")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0163"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0168"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0169"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0170"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0171"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '06' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0047") AS "0047", 
              sum("0060") AS "0060",
              sum("0163") AS "0163", 
              sum("0168") AS "0168", 
              sum("0169") AS "0169",
              sum("0170") AS "0170", 
              sum("0171") AS "0171"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chaco_gral2007, "../6.CHACO/chaco_sen_gral2007.csv")

```



### ENTRE RIOS



```{sql Votos_gral2007_erios, connection=Arg07,  output.var="erios_gral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0038",	
"0044",	
"0048",
"0051",
"0059",		
"0131",	
"0132",	
"0133",
"0134",
"0154",		
"0309")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0044"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0051"		 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0059"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0131"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0133"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0134"		 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0154"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0309"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '08' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0038") AS "0038", 
              sum("0044") AS "0044", 
              sum("0048") AS "0048",
              sum("0051") AS "0051",
              sum("0059") AS "0059", 
              sum("0131") AS "0131", 
              sum("0132") AS "0132", 
              sum("0133") AS "0133",
              sum("0134") AS "0134",
              sum("0154") AS "0154", 
              sum("0309") AS "0309"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(erios_gral2007, "../8.ENTRE_RIOS/erios_sen_gral2007.csv")

```






### NEUQUEN



```{sql Votos_gral2007_neuquen, connection=Arg07,  output.var="neuquen_gral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0006",	
"0045",	
"0048",
"0178",	
"0179",	
"0180",
"0181",	
"0187",	
"0440",
"0441")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0006"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0045"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0048"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0178"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0179"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0180"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0181"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0440"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0441"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '15' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0006") AS "0006", 
              sum("0045") AS "0045", 
              sum("0048") AS "0048",
              sum("0178") AS "0178", 
              sum("0179") AS "0179", 
              sum("0180") AS "0180",
              sum("0181") AS "0181", 
              sum("0187") AS "0187", 
              sum("0440") AS "0440",
              sum("0441") AS "0441"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquen_gral2007, "../15.NEUQUEN/neuquen_sen_gral2007.csv")

```





### RIO NEGRO



```{sql Votos_gral2007_rnegro, connection=Arg07,  output.var="rnegro_gral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0276",		
"0277",	
"0278",
"0279",
"0280",		
"0281",	
"0282",
"0283")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0276"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0277"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0278"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0279"		 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0280"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0281"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0282"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0283"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '16' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0276") AS "0276", 
              sum("0277") AS "0277", 
              sum("0278") AS "0278",
              sum("0279") AS "0279",
              sum("0280") AS "0280", 
              sum("0281") AS "0281", 
              sum("0282") AS "0282",
              sum("0283") AS "0283"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegro_gral2007, "../16.RIO_NEGRO/rnegro_sen_gral2007.csv")

```





### SALTA



```{sql Votos_gral2007_salta, connection=Arg07,  output.var="salta_gral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0005",		
"0014",	
"0038",
"0048",		
"0056",
"0060",		
"0132",	
"0302",
"0303",		
"0304",
"0305",		
"0306",	
"0307",
"0308",		
"0439")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0005"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0048"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0060"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0132"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0302"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0303"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0304"	 THEN votVotosPartido END) ,
              max(CASE WHEN vot_parCodigo = "0305"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0306"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0307"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0308"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0439"	 THEN votVotosPartido END)
        FROM              
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '17' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0005") AS "0005", 
              sum("0014") AS "0014", 
              sum("0038") AS "0038",
              sum("0048") AS "0048", 
              sum("0056") AS "0056",
              sum("0060") AS "0060", 
              sum("0132") AS "0132", 
              sum("0302") AS "0302",
              sum("0303") AS "0303", 
              sum("0304") AS "0304",
              sum("0305") AS "0305", 
              sum("0306") AS "0306", 
              sum("0307") AS "0307",
              sum("0308") AS "0308", 
              sum("0439") AS "0439"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(salta_gral2007, "../17.SALTA/salta_sen_gral2007.csv")

```






### SANTIAGO DEL ESTERO



```{sql Votos_gral2007_sestero, connection=Arg07,  output.var="sestero_gral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0001",		
"0005",	
"0012",	
"0014",
"0017",		
"0038",
"0050",		
"0056",	
"0060",	
"0175",
"0187",		
"0209",
"0210",		
"0211",	
"0212",	
"0213",
"0442")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0001"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0012"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0017"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0056"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0175"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0187"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0209"	 THEN votVotosPartido END) ,
              max(CASE WHEN vot_parCodigo = "0210"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0211"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0212"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0213"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0442"		 THEN votVotosPartido END) 
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '22' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0001") AS "0001", 
              sum("0005") AS "0005", 
              sum("0012") AS "0012", 
              sum("0014") AS "0014",
              sum("0017") AS "0017", 
              sum("0038") AS "0038",
              sum("0050") AS "0050", 
              sum("0056") AS "0056", 
              sum("0060") AS "0060", 
              sum("0175") AS "0175",
              sum("0187") AS "0187", 
              sum("0209") AS "0209",
              sum("0210") AS "0210", 
              sum("0211") AS "0211", 
              sum("0212") AS "0212", 
              sum("0213") AS "0213",
              sum("0442") AS "0442"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sestero_gral2007, "../22.SANTIAGO_DEL_ESTERO/santiago_sen_gral2007.csv")

```


### TIERRA DEL FUEGO


```{sql Votos_gral2007_tdfuego, connection=Arg07,  output.var="tdfuego_gral2007"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0005",	
"0022",	
"0047",
"0050",		
"0052",	
"0055",
"0187",		
"0245",	
"0249",	
"0250",
"0436",		
"0437",	
"0438")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0005"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0022"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0047"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0050"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0052"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0055"	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0187"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0245"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0249"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0250"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0436"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0437"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0438"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '24' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0005") AS "0005", 
              sum("0022") AS "0022", 
              sum("0047") AS "0047",
              sum("0050") AS "0050", 
              sum("0052") AS "0052", 
              sum("0055") AS "0055",
              sum("0187") AS "0187", 
              sum("0245") AS "0245", 
              sum("0249") AS "0249", 
              sum("0250") AS "0250",
              sum("0436") AS "0436", 
              sum("0437") AS "0437", 
              sum("0438") AS "0438"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = dep_proCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdfuego_gral2007, "../24.TIERRA_DEL_FUEGO/tdf_sen_gral2007.csv")

```





## 2013


## PASO 


### CABA



```{sql Votos_paso2013_caba, connection=Arg13P,  output.var="caba_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0008",		
"0068",	
"0187",	
"0234",
"0262",		
"0324",	
"0325",	
"0501",
"0502",		
"0503",	
"0504",	
"0505",	
"0506")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0008"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0234"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0262"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0324"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0325"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0502"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0504"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0506"	 	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '01' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0008") AS "0008", 
              sum("0068") AS "0068", 
              sum("0187") AS "0187", 
              sum("0234") AS "0234",
              sum("0262") AS "0262", 
              sum("0324") AS "0324", 
              sum("0325") AS "0325", 
              sum("0501") AS "0501",
              sum("0502") AS "0502", 
              sum("0503") AS "0503", 
              sum("0504") AS "0504", 
              sum("0505") AS "0505", 
              sum("0506") AS "0506"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(caba_paso2013, "../1.CABA/caba_sen_paso2013.csv")

```









### CHACO



```{sql Votos_paso2013_chaco, connection=Arg13P,  output.var="chaco_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0060",	
"0179",	
"0182",
"0501",		
"0518",	
"0519")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0060"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0179"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0182"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0518"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0519"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '06' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0060") AS "0060", 
              sum("0179") AS "0179", 
              sum("0182") AS "0182",
              sum("0501") AS "0501", 
              sum("0518") AS "0518", 
              sum("0519") AS "0519"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chaco_paso2013, "../6.CHACO/chaco_sen_paso2013.csv")

```



### ENTRE RIOS



```{sql Votos_paso2013_erios, connection=Arg13P,  output.var="erios_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0068",	
"0501",	
"0545",
"0546")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0546"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '08' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0068") AS "0068", 
              sum("0501") AS "0501", 
              sum("0545") AS "0545",
              sum("0546") AS "0546"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(erios_paso2013, "../8.ENTRE_RIOS/erios_sen_paso2013.csv")

```






### NEUQUEN



```{sql Votos_paso2013_neuquen, connection=Arg13P,  output.var="neuquen_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0040",	
"0153",	
"0166",
"0183",		
"0501",	
"0505",	
"0532",
"0533")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0166"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0183"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0532"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0533"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '15' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0040") AS "0040", 
              sum("0153") AS "0153", 
              sum("0166") AS "0166",
              sum("0183") AS "0183", 
              sum("0501") AS "0501", 
              sum("0505") AS "0505", 
              sum("0532") AS "0532",
              sum("0533") AS "0533"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquen_paso2013, "../15.NEUQUEN/neuquen_sen_paso2013.csv")

```





### RIO NEGRO



```{sql Votos_paso2013_rnegro, connection=Arg13P,  output.var="rnegro_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0154",	
"0501",
"0534")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0154"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0534"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '16' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0154") AS "0154", 
              sum("0501") AS "0501",
              sum("0534") AS "0534"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegro_paso2013, "../16.RIO_NEGRO/rnegro_sen_paso2013.csv")

```





### SALTA



```{sql Votos_paso2013_salta, connection=Arg13P,  output.var="salta_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0038",	
"0155",	
"0203",
"0501",		
"0535",	
"0536")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0038"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0155"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0203"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0535"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0536"	 THEN votVotosPartido END)
        FROM              
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '17' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0038") AS "0038", 
              sum("0155") AS "0155", 
              sum("0203") AS "0203",
              sum("0501") AS "0501", 
              sum("0535") AS "0535", 
              sum("0536") AS "0536"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(salta_paso2013, "../17.SALTA/salta_sen_paso2013.csv")

```






### SANTIAGO DEL ESTERO



```{sql Votos_paso2013_sestero, connection=Arg13P,  output.var="sestero_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0324",	
"0501",	
"0514",
"0540",		
"0541",	
"0550")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0324"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0540"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0541"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0550"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '22' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0324") AS "0324", 
              sum("0501") AS "0501", 
              sum("0514") AS "0514",
              sum("0540") AS "0540", 
              sum("0541") AS "0541", 
              sum("0550") AS "0550"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sestero_paso2013, "../22.SANTIAGO_DEL_ESTERO/santiago_sen_paso2013.csv")

```







### TIERRA DEL FUEGO



```{sql Votos_paso2013_tdfuego, connection=Arg13P,  output.var="tdfuego_paso2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0158",	
"0174",
"0199",		
"0501",	
"0544")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0158"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0174"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0199"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0544"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '24' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0158") AS "0158", 
              sum("0174") AS "0174",
              sum("0199") AS "0199", 
              sum("0501") AS "0501", 
              sum("0544") AS "0544"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdfuego_paso2013, "../24.TIERRA_DEL_FUEGO/tdf_sen_paso2013.csv")

```











## GRAL



### CABA



```{sql Votos_gral2013_caba, connection=Arg13G,  output.var="caba_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0187",	
"0501",
"0502",		
"0503",	
"0505",	
"0506")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0187"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0502"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0503"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0506"	 	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '01' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0187") AS "0187", 
              sum("0501") AS "0501",
              sum("0502") AS "0502", 
              sum("0503") AS "0503", 
              sum("0505") AS "0505", 
              sum("0506") AS "0506"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(caba_gral2013, "../1.CABA/caba_sen_gral2013.csv")

```









### CHACO



```{sql Votos_gral2013_chaco, connection=Arg13G,  output.var="chaco_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0501",		
"0519")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0519"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '06' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0501") AS "0501", 
              sum("0519") AS "0519"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(chaco_gral2013, "../6.CHACO/chaco_sen_gral2013.csv")

```



### ENTRE RIOS



```{sql Votos_gral2013_erios, connection=Arg13G,  output.var="erios_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0068",	
"0501",	
"0545",
"0546")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0068"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0545"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0546"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '08' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0068") AS "0068", 
              sum("0501") AS "0501", 
              sum("0545") AS "0545",
              sum("0546") AS "0546"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(erios_gral2013, "../8.ENTRE_RIOS/erios_sen_gral2013.csv")

```






### NEUQUEN



```{sql Votos_gral2013_neuquen, connection=Arg13G,  output.var="neuquen_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0023",		
"0040",	
"0153",	
"0166",
"0501",	
"0505",	
"0532",
"0533")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0023"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0040"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0153"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0166"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0505"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0532"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0533"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '15' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0023") AS "0023", 
              sum("0040") AS "0040", 
              sum("0153") AS "0153", 
              sum("0166") AS "0166",
              sum("0501") AS "0501", 
              sum("0505") AS "0505", 
              sum("0532") AS "0532",
              sum("0533") AS "0533"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(neuquen_gral2013, "../15.NEUQUEN/neuquen_sen_gral2013.csv")

```





### RIO NEGRO



```{sql Votos_gral2013_rnegro, connection=Arg13G,  output.var="rnegro_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0003",		
"0014",	
"0501",
"0534")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0003"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0014"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0534"		 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '16' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0003") AS "0003", 
              sum("0014") AS "0014", 
              sum("0501") AS "0501",
              sum("0534") AS "0534"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(rnegro_gral2013, "../16.RIO_NEGRO/rnegro_sen_gral2013.csv")

```





### SALTA



```{sql Votos_gral2013_salta, connection=Arg13G,  output.var="salta_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0014",		
"0155",	
"0203",
"0501",		
"0535")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0014"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0155"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0203"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0501"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0536"	 THEN votVotosPartido END)
        FROM              
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '17' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0014") AS "0014", 
              sum("0155") AS "0155", 
              sum("0203") AS "0203",
              sum("0501") AS "0501", 
              sum("0536") AS "0536"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(salta_gral2013, "../17.SALTA/salta_sen_gral2013.csv")

```






### SANTIAGO DEL ESTERO



```{sql Votos_gral2013_sestero, connection=Arg13G,  output.var="sestero_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0061",		
"0324",	
"0501",	
"0514",
"0540",		
"0541")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0061"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0324"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0514"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0540"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0541"	 THEN votVotosPartido END) 
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '22' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0061") AS "0061", 
              sum("0324") AS "0324", 
              sum("0501") AS "0501", 
              sum("0514") AS "0514",
              sum("0540") AS "0540", 
              sum("0541") AS "0541"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(sestero_gral2013, "../22.SANTIAGO_DEL_ESTERO/santiago_sen_gral2013.csv")

```







### TIERRA DEL FUEGO



```{sql Votos_gral2013_tdfuego, connection=Arg13G,  output.var="tdfuego_gral2013"}
WITH votos (vot_proCodigoProvincia, vot_depCodigoDepartamento, vot_mesCodigoCircuito, vot_mesCodigoMesa,
"0002",		
"0003",	
"0158",	
"0174",
"0199",		
"0501",	
"0544")
AS
(SELECT
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa,
              max(CASE WHEN vot_parCodigo = "0002"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0003"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0158"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0174"	 	 THEN votVotosPartido END),
              max(CASE WHEN vot_parCodigo = "0199"		 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0501"	 THEN votVotosPartido END), 
              max(CASE WHEN vot_parCodigo = "0544"	 THEN votVotosPartido END)
        FROM
        VotosCandidaturaMesasSNacionales
        WHERE
        vot_proCodigoProvincia = '24' --PBA
        --AND vot_depCodigoDepartamento = '020' --
        --AND vot_mesCodigoCircuito in ('0304 ') --
        GROUP BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa
        ORDER BY
        vot_proCodigoProvincia,
        vot_depCodigoDepartamento,
        vot_mesCodigoCircuito,
        vot_mesCodigoMesa)
SELECT
        vot_proCodigoProvincia AS codprov,
        depNombre AS depto,
        mes_depCodigoDepartamento AS coddepto,
         vot_mesCodigoCircuito AS circuito,
         vot_mesCodigoMesa AS mesa,
  --      sum(mesVotosValidos) AS validos,
        sum(mesElectores) AS electores,
        sum(mesVotosEnBlanco) AS blancos,
        sum(mesVotosNulos) AS nulos,
              sum("0002") AS "0002", 
              sum("0003") AS "0003", 
              sum("0158") AS "0158", 
              sum("0174") AS "0174",
              sum("0199") AS "0199", 
              sum("0501") AS "0501", 
              sum("0544") AS "0544"
        FROM
        votos
           INNER JOIN MesasSNacionales  ON vot_proCodigoProvincia = mes_proCodigoProvincia 
                                AND vot_depCodigoDepartamento = mes_depCodigoDepartamento
                                AND vot_mesCodigoCircuito = mesCodigoCircuito
                                AND vot_mesCodigoMesa = mesCodigoMesa
    INNER JOIN Departamento ON vot_proCodigoProvincia = depCodigoProvincia  
                         AND vot_depCodigoDepartamento = depCodigoDepartamento
     GROUP BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa
     ORDER BY
     vot_proCodigoProvincia,
     vot_depCodigoDepartamento,
     depNombre, 
     vot_mesCodigoCircuito,
     vot_mesCodigoMesa;
```


```{r}

write_csv(tdfuego_gral2013, "../24.TIERRA_DEL_FUEGO/tdf_sen_gral2013.csv")

```












